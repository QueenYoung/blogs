<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Yangkui's Blog]]></title><description><![CDATA[A starter blog template with gatsby]]></description><link>https://github.com/thoamsy/blogs.git</link><generator>RSS for Node</generator><lastBuildDate>Sat, 01 Dec 2018 11:07:31 GMT</lastBuildDate><item><title><![CDATA[Inside look at modern web browser（翻译）]]></title><description><![CDATA[原文系列:  https://developers.google.cn/web/updates/2018/09/inside-browser-part1 之前，我们提到了 Chrome 的多进程构架和 URL…]]></description><link>https://github.com/thoamsy/blogs.git/browser/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/browser/</guid><pubDate>Fri, 05 Oct 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;原文系列: &lt;a href=&quot;https://developers.google.cn/web/updates/2018/09/inside-browser-part1&quot;&gt;https://developers.google.cn/web/updates/2018/09/inside-browser-part1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;之前，我们提到了 Chrome 的多进程构架和 URL 导航的实现。在这片文章中，我们要一起去看看渲染进程到底做了什么&lt;/p&gt;
&lt;p&gt;渲染过程（Render Progress）和 Web 的性能息息相关。也因为在渲染过程中会发生很多事情，本文仅仅介绍它的冰山一角。如果你想深入的了解，&lt;a href=&quot;https://developers.google.cn/web/fundamentals/performance/why-performance-matters/&quot;&gt;Why Performance Matters&lt;/a&gt; 有更多的资源。&lt;/p&gt;
&lt;h2&gt;渲染过程处理 Web 内容&lt;/h2&gt;
&lt;p&gt;渲染过程负责在 Tab 中发生的一切事情。在一次渲染过程中，主线程会处理绝大部分你为用户准备的代码。如果还包含了 Web Worker 或者 Service Worker（PWA） 的代码，这部分会由 Worker 线程来处理。&lt;strong&gt;Compositor（合成）&lt;/strong&gt; 和 &lt;strong&gt;Raster（栅格）&lt;/strong&gt;也属于渲染进程的一部分，使页面渲染的更为高效和平滑。&lt;/p&gt;
&lt;p&gt;渲染进程的核心任务是将 HTML，CSS，JavaScript 转化成用户可以与之交互的 Web 网页。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/bdfa66a4ef1fbd2805797bc4cd90f8d8/3c337/renderer.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.601156069364166%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVQoz2WRyXLCQAxE/f9/w5EqDgQ4kIrBG3ghBuxiD2CzQ9jMY0QoV6UPY02P1GrJWpZlcRx/fum22+l0gjAMPc/zfZ9LW4Gr67q2bf8oWJY1m82out/vGp/RaOT5gem0PxTK5bJhGCTput5sNk3T5Fqr1RBCtNvtIvEqHgwGnoLjOJZtkxEEwfcfQgWCXq+HFyFxOp1O9/u9BoUl0qIoJu73+1kOyN9uNwnkvF6vBGmaJkminc9nqNPp9C7YbreHw0EmvFwuML8KURSt12vJ2e121GubzWaxWGCjUChUKhWEYJkNezwhj/p8Pl+tVsVi8e2LBs9iZk4U6vV6tVoliTe06LNcLo/HI1fIVqvF8MPhkO1OJhOqcKFhjIdSqcQPECHxiXPkxSdXfLIa1i5yr87sAyX08uuRJVMvWoA9NRoN/gWOSB6Px8/OqGb/QCqjYkqWLIz0FOa1MJbBh/HSHBgSYc48CfMOMMvrA+t4W7C5eyUwAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;renderer&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/bdfa66a4ef1fbd2805797bc4cd90f8d8/42603/renderer.png&quot;
        srcset=&quot;/blogs/static/bdfa66a4ef1fbd2805797bc4cd90f8d8/f931c/renderer.png 200w,
/blogs/static/bdfa66a4ef1fbd2805797bc4cd90f8d8/e8031/renderer.png 400w,
/blogs/static/bdfa66a4ef1fbd2805797bc4cd90f8d8/42603/renderer.png 800w,
/blogs/static/bdfa66a4ef1fbd2805797bc4cd90f8d8/3c337/renderer.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 1: 渲染进程包括了一个主线程，Worker 线程，一个 Compositor 线程 和一个 Raster 线程。&lt;/p&gt;
&lt;h2&gt;Parsing&lt;/h2&gt;
&lt;h3&gt;DOM 的创建过程&lt;/h3&gt;
&lt;p&gt;当渲染进程接收到来自 Navigation（详情看 Part2）的提交信息并开始接受 HTML 数据的时候，主线程开始将 HTML 中的字符串转化成 &lt;strong&gt;D&lt;/strong&gt;ocument &lt;strong&gt;O&lt;/strong&gt;bject &lt;strong&gt;M&lt;/strong&gt;odel（&lt;strong&gt;DOM&lt;/strong&gt;）&lt;/p&gt;
&lt;p&gt;DOM 即是浏览器内部呈现网页的方式，同时也是一种开发者可以通过 JavaScript 与之交互的数据结构和 API。
&lt;a href=&quot;https://html.spec.whatwg.org/&quot;&gt;HTML Standard&lt;/a&gt; 定义了将 HTML 转化成 DOM 的过程。你应该注意到过，浏览器从来不会在解析 HTML 的时候抛出一个错误。比如，少了 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;/p&amp;gt;&lt;/code&gt; 的标签是一个合法的 HTML。像 &lt;code class=&quot;language-text&quot;&gt;Hi! &amp;lt;b&amp;gt;I&amp;#39;m &amp;lt;i&amp;gt;Chrome&amp;lt;/b&amp;gt;!&amp;lt;/i&amp;gt;&lt;/code&gt; （b 标签在 i 之前就闭合了）这种错误的标记，会被浏览器看成 &lt;code class=&quot;language-text&quot;&gt;Hi!&amp;lt;b&amp;gt;I&amp;#39;m &amp;lt;i&amp;gt;Chrome&amp;lt;/i&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;i&amp;gt;!&amp;lt;/i&amp;gt;&lt;/code&gt; 来理解。这是因为 HTML 的标准就是特意设计成能够将错误优雅的处理掉。如果你好奇这内部的细节，可以阅读 HTML 标准中的 &lt;a href=&quot;https://html.spec.whatwg.org/multipage/parsing.html#an-introduction-to-error-handling-and-strange-cases-in-the-parser&quot;&gt;An introduction to error handling and strange cases in the parser&lt;/a&gt; 这一节。&lt;/p&gt;
&lt;h3&gt;子资源加载&lt;/h3&gt;
&lt;p&gt;一个网页通常还会有图片，CSS 和 JS 等这些外部资源。这些文件需要从网络或者缓存中被加载。主线会在解析 HTML 文件并构建 DOM 的过程中，一个一个的处理它们。但是为了提速，“（预加载扫描器）preload scanner” 会并行运行。如果存在 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;img&amp;gt; 和 &amp;lt;link&amp;gt;&lt;/code&gt; 在 HTML 中，预加载扫描器会默默地查看这些标记，并在浏览进程中向 network 线程发送请求。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/fa689d6a31b8687522c58774c8d9d064/3c337/dom.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.601156069364166%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABc0lEQVQoz22S2XKCUAyGef+namecYZi2FJFNAXfZioqK4lKgH8Txqrk45OTkXxJV2rZdLBbax6fp+YHvh2Hoed54PA6CwHEc13V936cyGo1++hgOh2magmqaRuGzXq8dzzNM6/3tGbqu0/TVx3cfg8HAsixY4Mqy7AkGic5kMrFtG3rU0ERfzldMp1OpzGazzWaTJMn5fFaAGYZhmiasqAG+XC5VVUFc1zUdXG+32+PxIN9ut5qmIV6W5W63U6je73fwsM7n8zzP6cAOxgDDSB2fIPf7fRzHqqoyFMpcFaqn0wllzPz2AUZWQoVZcAv4er1SZwXgj8fjcrnslOFASjYEGcqHw0EUQHKFl1l4avtgHE5sd8oQ8GEN0ENJN0OS88xEsideV6sV4qyWnB8Msx2YqcDThFUskAPGDvSciAPgjyAnQQNtyHRgPiyTVYFHFjWuAkYh74NuvJD8Y5sqxPIHIMQbb0VRyCkJuxBZ8iiKKP4Bs75RmkY8U9EAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;dom&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/fa689d6a31b8687522c58774c8d9d064/42603/dom.png&quot;
        srcset=&quot;/blogs/static/fa689d6a31b8687522c58774c8d9d064/f931c/dom.png 200w,
/blogs/static/fa689d6a31b8687522c58774c8d9d064/e8031/dom.png 400w,
/blogs/static/fa689d6a31b8687522c58774c8d9d064/42603/dom.png 800w,
/blogs/static/fa689d6a31b8687522c58774c8d9d064/3c337/dom.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 2: 主线程解析 HTML 文档并构建 DOM 树&lt;/p&gt;
&lt;h3&gt;JavaScript 会堵塞解析&lt;/h3&gt;
&lt;p&gt;当 HTML 解析器找到一个 &lt;code class=&quot;language-text&quot;&gt;script&lt;/code&gt; 标签的时候，它会暂停解析 HTML 文档，并开始下载，解析并执行 JS 代码。为什么？因为 JS 可以使用像 &lt;code class=&quot;language-text&quot;&gt;document.write()&lt;/code&gt; 这种改变了整个 DOM 结构的方法来改变文档的形状（shape of the document)。这就是为什么 HTML 解析器在它可以继续解析 HTML 文档之前，必须等待 Javascript 运行结束。如果你对 JS 的执行细节好奇的话，&lt;a href=&quot;https://mathiasbynens.be/notes/shapes-ics&quot;&gt;V8 团队有一篇关于它的博客介绍&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;暗示浏览器哪些资源是可以加载的&lt;/h2&gt;
&lt;p&gt;Web 开发者有很多种方式可以按时浏览器如何恰当地加载资源。如果你的 JS 不使用 &lt;code class=&quot;language-text&quot;&gt;document.write()&lt;/code&gt;，你可以给 &lt;code class=&quot;language-text&quot;&gt;script&lt;/code&gt; 标签添加 &lt;code class=&quot;language-text&quot;&gt;async&lt;/code&gt; 或者 &lt;code class=&quot;language-text&quot;&gt;defer&lt;/code&gt; attribute。这样浏览器就异步的加载和运行 JS 代码，而不会堵塞解析过程。你同时也可以在恰当的时候使用 &lt;a href=&quot;https://developers.google.cn/web/fundamentals/primers/modules&quot;&gt;JavaScript module&lt;/a&gt;。&lt;code class=&quot;language-text&quot;&gt;&amp;lt;link ref=&amp;quot;preload&amp;quot;&amp;gt;&lt;/code&gt; 也是一种通知浏览器，当前资源可以尽快下载的方式。可以通过阅读 &lt;a href=&quot;https://developers.google.cn/web/fundamentals/performance/resource-prioritization&quot;&gt;Resource Prioritization – Getting the Browser to Help You&lt;/a&gt; 了解更多。&lt;/p&gt;
&lt;h2&gt;Style calculation&lt;/h2&gt;
&lt;p&gt;因为 CSS 的存在，仅仅有一个 DOM 是不足以让浏览器了解整个网页会是怎么样的。主线程会解析 CS，并为每一个 DOM 节点计算出最终样式。这些信息会基于 CSS 选择器来呈现每一个元素被应用了哪些样式。你可以在通过开发者工具的 &lt;code class=&quot;language-text&quot;&gt;computed&lt;/code&gt; 来看到这些信息。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/fb7d195814a04c6ed98eab8dbda477c6/3c337/computedstyle.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.601156069364166%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVQoz1WRWY+CQBCE+f//xsRolBfXI2YDKiKKgujiiYrifUVlP2YS3e2Hoafpqq7qUeI49v2fb003bcd1HM/zuiIcx7Esq91uk3c6HdM0l8vlarVqNpuLxQLU6/VS+EwmE7vbM1rWF1EsFgqFRqNBk67r9XrdMAzOcrksiVzX/YDH47Ft21RbpgmAabKD6Pf78kTOcDj0RJBMp9P5fH46nRTkwQ3a931yTsn6EPF8Pu/3+/V6vd1u+/1+vV5Xq1UYj8cjuULHZrPhLi1FURSG4WAwqNVq6NQ0DTqK9MxmMwYCxlQQBBQVOEDSB5IcMefzmUo2m8VnJpMBjE7+giyVSsxAwmg0SsDw8ZsLK5V4KjjP5/OVSiWXy7EexCMQDKJiEbQlYMwcDoeeCFjkZFaYSqVUVU2n0/Bib7vd4vwNBpKAL5cLqnhGHgzxu92OCawUPLtll+QMD0Sg+R8YVgbih5N/PAwVdNKBVE6kyW0zRtY/soFhErfvrbDYUARXzuhPwEuRBpox8gsmH01pB0VyDQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;computedstyle&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/fb7d195814a04c6ed98eab8dbda477c6/42603/computedstyle.png&quot;
        srcset=&quot;/blogs/static/fb7d195814a04c6ed98eab8dbda477c6/f931c/computedstyle.png 200w,
/blogs/static/fb7d195814a04c6ed98eab8dbda477c6/e8031/computedstyle.png 400w,
/blogs/static/fb7d195814a04c6ed98eab8dbda477c6/42603/computedstyle.png 800w,
/blogs/static/fb7d195814a04c6ed98eab8dbda477c6/3c337/computedstyle.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 3: 主线程解析 CSS 得到计算过的样式&lt;/p&gt;
&lt;p&gt;即使你不提供任何 CSS，每一个 DOM 节点还是会有一个被计算过的样式。&lt;code class=&quot;language-text&quot;&gt;&amp;lt;h1&amp;gt;&lt;/code&gt; 标签看上去会比 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;h2&amp;gt;&lt;/code&gt; 更大，并且每一个元素的 margin 也是不一样的。这是因为浏览器维护了一个默认样式表。如果你想了解 Chrome 的默认样式，可以阅读&lt;a href=&quot;https://cs.chromium.org/chromium/src/third_party/blink/renderer/core/css/html.css&quot;&gt;源码&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Layout&lt;/h2&gt;
&lt;p&gt;现在渲染进程知道了 DOM 的结构和每一个节点的样式，但是这些信息还不足以去渲染一个页面。相信你在电话的另一头努力地给你的朋友描述一幅画。“有一个巨大的红色的圆和一个小一点的蓝色的正方形”是不足以让你的朋友想象出这幅画的样子的。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/0658494542e14f7db66b913c02c03202/3c337/tellgame.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.294797687861276%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB10lEQVQoz21Su47TQBQdim0QEgUUQLESP7D8AtI2iHYrOkRBS02zH4D4AUo6N2ELQrTtJqFIsnlY5GEltmfs8dqOTZLNy3b8iPfEXu1D2iv7auy555x7zwzhnHuel6ZpkiRBECyXy/V6PZ/PF4vFarXCZxiG2+0WBXEcp/eDMMYkSQIFkGCJwjD2/RTlqI2iTRjmFFEUVatVy7LGWWAfYsQwDNM0S6XSdDrFAizm5fxCY1TnoiTZlmXbNtgLhUKr1apUKr1er1gslstldERAAwxowM0oRX/ezx+ztwfu0WH7z+8w69b3fVEUkQeDAbpDFgSh0WgQWZYnk0maDc3ssf+v7e4//v9qjz4h/Q/vd7+zgTEdZJrNJpSHwyEgAJLRaASHcgPEkSwXhPPnjzqvn7Zf7n38/P3NSSAoO59klf7NQlGUWq2We0y63W6+gkkYGHnx5ZP7jKwPXrw7PiVf6bezMTb5hQmNTqeDNbLrujvwXeupqkZJEm8CX2xGmvJL2x63kto4TuMN1TQUoGHHcaBPKb0F5ycJZY0xzg1jOjMcZ2bqnsNdkzOm2baVgyGrqup12+mDsePK3uy5CUwLw/r9/vUluQ95OHCQ2IVavV7XdR2e57ftCp5ZSInelRfHAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;tellgame&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/0658494542e14f7db66b913c02c03202/42603/tellgame.png&quot;
        srcset=&quot;/blogs/static/0658494542e14f7db66b913c02c03202/f931c/tellgame.png 200w,
/blogs/static/0658494542e14f7db66b913c02c03202/e8031/tellgame.png 400w,
/blogs/static/0658494542e14f7db66b913c02c03202/42603/tellgame.png 800w,
/blogs/static/0658494542e14f7db66b913c02c03202/3c337/tellgame.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 4: A person standing in front of a painting, phone line connected to the other person&lt;/p&gt;
&lt;p&gt;Layout 是一个找到元素的几何信息的过程。主线程通过遍历 DOM，计算样式，并创建一个包换了 x y 坐标信息和边框大小的 layout 树。Layout 树可能和 DOM 树很相似，但是它仅仅包含了在能在页面中被看到的信息。比如 &lt;code class=&quot;language-text&quot;&gt;display: none&lt;/code&gt; 一旦被应用到每个元素上，这个元素就不是 layout 树的一部分。相似的，如果一个伪元素 &lt;code class=&quot;language-text&quot;&gt;p::before { content: &amp;quot;Hi!&amp;quot; }&lt;/code&gt;被应用饿了，它虽然不会出现在 DOM 树上，但是属于 layout 树。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/0c1de85206f0d177f93a70931a0f8272/3c337/layout.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.601156069364166%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVQoz1WS6Y6CQBCEef/30QR/aUTiZlmN3AoeCCqCovG+Vvyc2d1kO2bohqqumm6Vsiwnk8nHp2H5QRgGw+HQ9/1+vx+Goeu65EEQeJ5nWVae56vVqtfrLZdLWM/nU+GRxLHr+V3TbjQa9Tq/eqfTAfQloitC0zTbtulC0yzLfshJkvAKKduyTNN0HGcwGIQicPGXjEYjmYzH49lslqbp8XhUoNEYe3ygNwjZ9X6/Xy6XbxGPx4MT9Hq9brfbYA6HA1dQAPGgRh+3zWaTEv58PkftdrvJXpwwF4uFruuIoVwUhbLf7xkJN+SqrVarUqlAA3o+n7FDI/hgOJGhOzTKKIre5EQEfMhYUlWVz4ZhIIIyfJLNZkOvUoR0Af9N5mK73Y5N1Go1mNVqFTQ60+mUFaJAiWGgwKBxeU7yN/l0OsVxzDWYliGCwTAhSjlSZkEXJoQau2D52MTUdrtVWBrTZ+8gQJNLV2her1dyPDMFANL5P9upCAaDPf5DcoyyJIFJd16iU/wGOe04XwjcTY6e4hgvAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;layout&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/0c1de85206f0d177f93a70931a0f8272/42603/layout.png&quot;
        srcset=&quot;/blogs/static/0c1de85206f0d177f93a70931a0f8272/f931c/layout.png 200w,
/blogs/static/0c1de85206f0d177f93a70931a0f8272/e8031/layout.png 400w,
/blogs/static/0c1de85206f0d177f93a70931a0f8272/42603/layout.png 800w,
/blogs/static/0c1de85206f0d177f93a70931a0f8272/3c337/layout.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 5: 主线程遍历 DOM 树，通过已经计算的样式，得到 layout 树&lt;/p&gt;
&lt;p&gt;确定页面的布局是一项由挑战性的任务。即使是最简单的页面布局，如从上到下的 block flow，也必须考虑字体的大小以及在哪里划分它们，因为它们会影响段落的大小和形状，还会影响下一段所需的位置。&lt;/p&gt;
&lt;p&gt;&lt;a href=&apos;/blogs/layout-d79962918f183bf37afdfbbec0b45780.mp4&apos;&gt;layout.mp4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Figure 6: 因为一个断行的改变，layout 也跟着改变&lt;/p&gt;
&lt;p&gt;CSS 还能让元素浮动到一边，隐藏超出边界的部分，并修改写入方向。你可以想象到，layout 阶段其实是非常复杂的任务。在 Chrome 中，有专门一个团队的工程师致力于 layout 的工作。如果你想了解更多有关他们的工作细节，&lt;a href=&quot;https://www.youtube.com/watch?v=Y5Xa4H2wtVA&quot;&gt;few talks form BlinkOn Conference&lt;/a&gt; 记录了大量的有趣的内容。&lt;/p&gt;
&lt;h2&gt;Paint&lt;/h2&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/d8fe81b968531c8b3d4767006ea9725d/3c337/drawgame.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 37.45664739884393%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABL0lEQVQY05VPPU+DUBR9iZOrcTBODk6auDv4M5z7cxydjXFxMsbJ0YnNpBKIaYSQgnyWPngUXvkoUAh4oEtXz3bPveeec4jrOCzLqaFT16HrbLmkjEWmabquG8dxtAfHcZqm8X3/Z0RZliRIs1744Fen2c1Fr8pdP2A+n6dpWlXVZkSe513XQb8YgZUgCLIsk4Cvs8ktOyL05ODl7uk9GsS6YeAiSRJKqWVZQRBAzxhTFEXTNFVVPc8Lw5CwvGhen9dnh4vry+P74PxtEBvGL67rurZtG3d4AZJzruu6KIowRzQwBE3qvs++PpPZ94O6fZwV7baGA9wQGOa7CKiAL3iHRxglSUJ/slqtkjjGkm/KLo/bAisOEg35HsCCadsWaafTKboMzv1/ADdtxK7IHzccdTm16O1FAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;drawgame&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/d8fe81b968531c8b3d4767006ea9725d/42603/drawgame.png&quot;
        srcset=&quot;/blogs/static/d8fe81b968531c8b3d4767006ea9725d/f931c/drawgame.png 200w,
/blogs/static/d8fe81b968531c8b3d4767006ea9725d/e8031/drawgame.png 400w,
/blogs/static/d8fe81b968531c8b3d4767006ea9725d/42603/drawgame.png 800w,
/blogs/static/d8fe81b968531c8b3d4767006ea9725d/3c337/drawgame.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 7: 一个人拿着画笔站在画布前，想着应该先画圆还是先画正方形&lt;/p&gt;
&lt;p&gt;有了 DOM，style，layout 还不足于渲染一个页面。假设你正在努力画一幅画，你知道画的大小，形状，每一个元素所在的位置，但是你还是需要判断绘制它们的顺序。
比如，&lt;code class=&quot;language-text&quot;&gt;z-index&lt;/code&gt; 可能会被设置到当前元素上，在这种情况下，如果按 HTML 定义的顺序来绘制就会得到错误的结果。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/785924a8744dfda1428cc692e2c3f411/73363/zindex.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.44062153163153%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABa0lEQVQoz32S/W6CQBDE7/2fo3/1KUxM1JgQg5CqIKJyIigfIgpYRforV02bmG7iZW93bmdmUfR6vclkYhjGbDYzTdP3/SiK9vv9brcLw9BxHNd1pZQkm81msVhYlrVer5fLZZqmQtf14XA4GAw0Tev3+5wfbVAHCojT8zwIbNtmChwkx+Pxer2Ky+UCCYNpMBvcdDo1DQNCT0pegp7P50gbjUbookJ+u92aphHc6fEGPbCNx2NUUKSXhKGaKB9TsMMV/M9jqnir61r5oVQU5yiOA9+X729VnpPTbV6FiONYZeiHAZPb7ZbxnI5tIwGHcK5WK5D3+/3PYwwHQcAJDjNssiiKJEnYfHo4gEZOt9vtdDrsBdvUWYrSIvjVbZAwBf7PNsj5ZmVZslhaVMCUbTBdSfjeNhdKVVWBhhnx7A/ZyKHLerIse+05+xV5np8foXIY8Mz3xxFD1YKezkXzbyDqdDqR8Jd4unvGF3HhXceMYMsUAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;zindex&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/785924a8744dfda1428cc692e2c3f411/42603/zindex.png&quot;
        srcset=&quot;/blogs/static/785924a8744dfda1428cc692e2c3f411/f931c/zindex.png 200w,
/blogs/static/785924a8744dfda1428cc692e2c3f411/e8031/zindex.png 400w,
/blogs/static/785924a8744dfda1428cc692e2c3f411/42603/zindex.png 800w,
/blogs/static/785924a8744dfda1428cc692e2c3f411/5b8b9/zindex.png 1200w,
/blogs/static/785924a8744dfda1428cc692e2c3f411/c7ea5/zindex.png 1600w,
/blogs/static/785924a8744dfda1428cc692e2c3f411/73363/zindex.png 1802w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 8: 页面的元素按 HTML 元素中定义的元素，导致了错误的结果。因为 z-index 没有被考虑在内&lt;/p&gt;
&lt;p&gt;在绘制（Paint）阶段，主线程遍历 layout 树来创建绘制记录（Paint record)。绘制记录是一个绘画过程的注解，如“先背景，接着文本，然后矩形”。如果你使用过 &lt;code class=&quot;language-text&quot;&gt;canvas&lt;/code&gt;，那么这个过程对你来说应该很熟悉。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/a68fd128fc59b9b2bed3511fcf223c94/3c337/paint.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.601156069364166%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVQoz22R23KCQBBE+f+v0iq1jFFQQECBCOJdQfGKaCQHpqzkIfOwO9U7090zqxRFEYbBx2fXsF3PdX3fdxxnPB57nmdZFrnrurZtG4ax3W53u12/31+v13S9Xi+FazabWbaj6Wa9VqvXOWqqqg4Gg24V5JqmNRoN0zRhgeu3mU6RMg1D1/XhcCiyxGQy+foTIPgCnM/nq9XqcrkolCICaxAE5JywfleBwnK5XCwWaZoCns/nOI7b7TbikivP55MLvizLxExRRZ7nEKEWhiE6IJTB1Wq1GARkv98rFN3v99FoxD6ogAtNSTDJzKxqs9kIXa/Xw8jxeJxOp2WzCALhGZ9Qgsh6yUnAhVdMyYntsvnxeHDJGnGYVsGXnE4n7DSbzU6nA7UMT0EURXSyrSRJlOv1KrMB8bG80ckbpHgD4QllSjGPF1Z9u90oKJUpZVuMgRmK4MY8RExOG+bRl4X9Y1v+g03CTTPekipAoirQFzB+B20gh8PhB0XOU3hbyxq5AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;paint&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/a68fd128fc59b9b2bed3511fcf223c94/42603/paint.png&quot;
        srcset=&quot;/blogs/static/a68fd128fc59b9b2bed3511fcf223c94/f931c/paint.png 200w,
/blogs/static/a68fd128fc59b9b2bed3511fcf223c94/e8031/paint.png 400w,
/blogs/static/a68fd128fc59b9b2bed3511fcf223c94/42603/paint.png 800w,
/blogs/static/a68fd128fc59b9b2bed3511fcf223c94/3c337/paint.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 9: 主线程遍历 layout 树并生成绘制记录&lt;/p&gt;
&lt;h3&gt;Updating rendering pipeline is costly&lt;/h3&gt;
&lt;p&gt;&lt;a href=&apos;/blogs/trees-4fb0aeab900ba7deeab02d06057f464e.mp4&apos;&gt;trees.mp4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Figure 10: 有序的生成 DOM ，Style，Layout，Paint Trees&lt;/p&gt;
&lt;p&gt;想要理解渲染一条龙，最重要的一点是&lt;strong&gt;每一步中，都会使用上一个操作的结果作为新的数据。&lt;/strong&gt; 比如修改了 layout 树，那么 paint 树也需要重新生成。
如果你打算为某些元素加动画，浏览器必须在每一帧都重复这些过程。大多数显示器 1 秒刷新 60 次屏幕（60 fps）。当物体在屏幕中移动的时候，出现在每一帧中，人眼就会认为这段动画十分平滑。然后，如果动画在某段时间内丢帧了，页面就会看上去“卡顿”&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/fbcb48cd931be64c96ac87a3fa1ee177/6fdd2/pagejank1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 23.1%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQY02WN3U+CUADF+f/f3HrpoVecFNK81crNrbx0uwgCgYEwMK5XqN3SIR9SLinsKdd5ONvZOTs/7vuf6l8nhGia5vu+5/mGYWRZtq/q+u+SK4t8W5V5nldl8Vltsmz9tf1YLZdhOEvTdE7IevXexN2hmpfGuVbnBpj05GJ4DO6BHrXal6doCn22KfKyLI86V7zsuWzTcHaH2D35enDXhwovdLFu9fq3gniOjae22FMUjBDihTOoWYMh6oqi604lSZJlWVVVAADGmJtY1ktMtdGIRM8LOscP6I29TqxH0zQppfp4HM3CJF5ACJMkcRzHtu04joMgYIz9ACMYBWmHluTAAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;pagejank1&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/fbcb48cd931be64c96ac87a3fa1ee177/42603/pagejank1.png&quot;
        srcset=&quot;/blogs/static/fbcb48cd931be64c96ac87a3fa1ee177/f931c/pagejank1.png 200w,
/blogs/static/fbcb48cd931be64c96ac87a3fa1ee177/e8031/pagejank1.png 400w,
/blogs/static/fbcb48cd931be64c96ac87a3fa1ee177/42603/pagejank1.png 800w,
/blogs/static/fbcb48cd931be64c96ac87a3fa1ee177/6fdd2/pagejank1.png 1000w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 11：Animation frames on a timeline&lt;/p&gt;
&lt;p&gt;即使你的渲染操作能跟上屏幕的刷新，但是因为这些计算是发生在主线程上，这意味着当有其他的 JS 代码运行的时候，动画就会“掉帧”&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/6e35a283b1b93f266a18f739475db1ea/6fdd2/pagejank2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 23.1%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDElEQVQY02WOXU+CUACG+UOurZV/N7swi1auRutjkWVAxAkhDoi4QEAkOBZ1IfLlOeTW7KZn78V78bzbS9UbyKaUZTU0x+BFnbj+QNF0Y/Tf+YUqs7QsCkJwvkyrMq9xYo+VBL1FU/177nwhe5G4JI9JjnCVFdmyqiqMMVkPMKbanBkuVq7vHw2iNPVrdfeTbWTcVnjTtLrb6xB5Bz83aqU50i+PlXlarv4uUMwdz4vgoNPhVPOWZc+7bcuQTujWQ++qf39NH+5DVej3Lk7plqIqe/QZxwsASAzDiKJIGfB1FgQAAN91PM97EqX3+EPThxrUp0Eoy6oz8WZh/MgJURRZpgEhDILAtm2E0A9U1ABD8UOCoQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;pagejank2&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/6e35a283b1b93f266a18f739475db1ea/42603/pagejank2.png&quot;
        srcset=&quot;/blogs/static/6e35a283b1b93f266a18f739475db1ea/f931c/pagejank2.png 200w,
/blogs/static/6e35a283b1b93f266a18f739475db1ea/e8031/pagejank2.png 400w,
/blogs/static/6e35a283b1b93f266a18f739475db1ea/42603/pagejank2.png 800w,
/blogs/static/6e35a283b1b93f266a18f739475db1ea/6fdd2/pagejank2.png 1000w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 12: 在动画帧的时间线上，有一帧被 JS 堵塞了&lt;/p&gt;
&lt;p&gt;你可以使用 &lt;code class=&quot;language-text&quot;&gt;requestAnimationFrame&lt;/code&gt; 将 JS 操作拆分成一小片，它们会分散在每一帧中运行。关于这个话题更深入的部分，请看 &lt;a href=&quot;https://developers.google.cn/web/fundamentals/performance/rendering/optimize-javascript-execution&quot;&gt;Optimize JavaScript Execution&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/7b1959d9953869798ba89282c6533bd2/6fdd2/raf.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 23.1%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVQY01WPW0+DQBSE+f//wAejjZoWrLG6mGpUwFAot7JA1VibugWMraG7UOUi6oKo8cHvYWYyDydnGNHxo/n+Y2ALzpQ+s7doAa+vPpbHordaoB5+0qRxkIe7Uz8cumZNQN1Q0foHBjhLNOGFy544S3y4CRTX9e89eQO4ZHLXV0ROekjnbgtImoHCmbW1fsljQhBCGGPm7ORIUUftDjfSlXNB5dp7N964e9i/OAWDgdFhD2xDVYZwp7XtQch2eZ4HsiwDAFRVZT5pRWkVBEGa5eVbkSTr1zSNm+NxkucZIXiFcVFkGJOyfK//w/xa80MYhhBCTdN0XW/Utm3LskzTbELTG4YRRdH33j8opV87Zv9mDQAZNwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;raf&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/7b1959d9953869798ba89282c6533bd2/42603/raf.png&quot;
        srcset=&quot;/blogs/static/7b1959d9953869798ba89282c6533bd2/f931c/raf.png 200w,
/blogs/static/7b1959d9953869798ba89282c6533bd2/e8031/raf.png 400w,
/blogs/static/7b1959d9953869798ba89282c6533bd2/42603/raf.png 800w,
/blogs/static/7b1959d9953869798ba89282c6533bd2/6fdd2/raf.png 1000w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 13：在动画帧的时间线上，更小的 JS 块&lt;/p&gt;
&lt;h2&gt;Compositing&lt;/h2&gt;
&lt;h3&gt;你怎样 draw 一个页面&lt;/h3&gt;
&lt;p&gt;&lt;a href=&apos;/blogs/naive_rastering-a0634ba076324953ca7af0a80e55eb81.mp4&apos;&gt;naive_rastering.mp4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Figure 14: naive 的栅格化过程&lt;/p&gt;
&lt;p&gt;现在浏览器知道了文档结构，每一个元素的样式，页面的几何信息，和绘制顺序，接下来怎样 draw 出这个页面呢？将这些信息转化为像素并呈现在屏幕上的过程被称为&lt;strong&gt;栅格化&lt;/strong&gt;。
可能一个比较 naive 的处理这个方式是：仅仅栅格化视口的部分。如果用户滚动着页面，那么在移动帧的过程中，通过继续栅格化来填充缺失的部分。这也是 Chrome 刚发布的时候，采用的策略。然后现代浏览器会使用一种被称为合成（compositing）的更为牛逼（sophisticated）的方式。&lt;/p&gt;
&lt;h3&gt;什么是合成&lt;/h3&gt;
&lt;p&gt;&lt;a href=&apos;/blogs/composit-42e8d29f2a2648a18da3571f345453e0.mp4&apos;&gt;composit.mp4&lt;/a&gt;
Figure 15: 合成过程&lt;/p&gt;
&lt;p&gt;合成是一种用来将一个界面分为多个层，分别将它们栅格化，并在一个叫做合成器的线程中将它们重新合并成一个界面的技术。如果滚动发生了，因为每一个图层（Layer）都早已栅格化，现在说需要做的事情仅仅是合成一个新的帧。而动画也可以通过移动层并将它们组合成一个新的帧的方式来实现。
你可以使用开发者工具中的 Layers 面板来查看你的网页是被分成了哪些层。&lt;/p&gt;
&lt;h3&gt;深入 Layer&lt;/h3&gt;
&lt;p&gt;为了分清楚哪些元素会在哪些图层中出现，主线程需要遍历 layout 树并创建一个 layer 树（在 Performance 面板中，这一部分被称为 Update Layer Tree）。如果界面中那些本该成为单独的层（比如抽屉菜单）却没有成为，你可以使用 CSS 属性 &lt;code class=&quot;language-text&quot;&gt;will-change&lt;/code&gt; 来暗示浏览器，将它提升为一个单独的层。&lt;/p&gt;
&lt;p&gt;你可能会禁不住诱惑让每一个元素都成为一个图层，但是合成大量的层反而会导致这个过程比一帧一帧的栅格化还要慢，关键才是要测量你的渲染性能。关于这个部分的更多细节，请看 &lt;a href=&quot;https://developers.google.cn/web/fundamentals/performance/rendering/stick-to-compositor-only-properties-and-manage-layer-count&quot;&gt;Stick to Compositor-Only Properties and Manager Layer Count&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Raster and composite off of the main thread&lt;/h3&gt;
&lt;p&gt;一旦 Layer 树已经创建好，并且 Paint 的顺序是确定的，那么主线程就会将这些信息提交到合成器线程中。合成器线程会栅格化每一个 Layer。有些 Layer 可以和整个页面一样大，所以合成器线程会将它们分为多个图块，接着将每一个图块发送给栅格线程。栅格线程栅格化每一个图块，并将它们存在 GPU 的内存中。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/371b5fa654d59f0c8ccb2f4f0658c20a/3c337/raster.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.601156069364166%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0UlEQVQoz01Sy5KbMBDk//8ktxySVPaQKpulYnaNMWCe4ikQIDAE2+W3DU4b55A5iJFQd8/0SHg8HpQmH3PFcIhPSBiG7hiEENM0LctCbtu2YRh1Xa/Xa13Xq6oCahgGAR/GmON62sqcIkRxMpksl0tN0xRFUVUVOVZJkkDkeR7YwfIPnGUZuD3PtVbPsMcbkE3GCIIgiiIA4jj2fR9brJRSzvnhcBBw8+NzDhgQKMkjfj8MIIYOrl4ul7ZtT6fT+Xy+3+99399uN2h2XYdz4U9TRcSxlYltLMLVzNIUmkRFUYAIlUMELNABGBTDyIuA7GazEeqSpZHH3HnoGLvS5ywmrr3f70VRBPdut0OH2+0WOXxqmga/gEQOp4R2XenqfPH+MwmcX9++vH3/Gng2XBCnU5SdpulLHG5jCxcABiPoULlQ8zKLffX9x2oha7/fAsdo67LrNsfjsR/jer3CJLQAFwFAtaAD6RPMC9Y1nDqfEbEiU962vKmKYZzEqz3goYkRQB+asBazlGUZJ0JVZIwGoS75jh7oUp6QqmSP/wImoz3gMXaUjZeD1zCbzZ7goixZXuRZwvI8z2iaMc4r1NaNgQSGvdyG/0jQLVY8Nfz6CxoTRqDyXR/aAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;raster&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/371b5fa654d59f0c8ccb2f4f0658c20a/42603/raster.png&quot;
        srcset=&quot;/blogs/static/371b5fa654d59f0c8ccb2f4f0658c20a/f931c/raster.png 200w,
/blogs/static/371b5fa654d59f0c8ccb2f4f0658c20a/e8031/raster.png 400w,
/blogs/static/371b5fa654d59f0c8ccb2f4f0658c20a/42603/raster.png 800w,
/blogs/static/371b5fa654d59f0c8ccb2f4f0658c20a/3c337/raster.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 17: 栅格线程创建多个位图块，并发送给 GPU&lt;/p&gt;
&lt;p&gt;合成线程还可以根据优先级决定，以便视口（或附近）可以先被栅格化。图层还具有多个 tiliings 用于处理放大操作等。&lt;/p&gt;
&lt;p&gt;一旦图块被栅格化，合成器线程会有一个被称为&lt;strong&gt;draw quads（绘制四边形）&lt;/strong&gt;的过程来收集这些图块的信息，以创建一个 &lt;strong&gt;compositor frame（合成帧）&lt;/strong&gt;
Compositor frame 接着会由 IPC 提交到浏览器进程中。此时，可以从 UI 线程中添加其他的合成帧用于浏览器 UI 的改变或者渲染进程。最后这些合成帧会被发送到 GPU 以显示到屏幕上。如果有滚动事件发送，合成器线程会创建新的合成帧发送到 GPU。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/397d4949099dd6d1aaffcb55e8678e37/3c337/composit.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.601156069364166%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVQoz1WS127CQBRE9///hiceQIJgJHABI3fjgg0WHdGCKKHkyBsS5Uos17szc8ezFq/XK88zVTdsP4qjKEmSIAiGw2Ecx57n0UdR5Pu+bdur1Wq9Xg8Gg8ViAevxeAj+isnEC0LTcprN5kdZpmlaltXv92lAs7bbbcdx0EJ0uVzCej6foigK5jDEc13kwzBklFcWA13XZQWQpilrVFaWZVhgvuAMMZ6TNEVov9+DG41GTAZNA4D917twe7/fv8oS1+v1eDzebrfz+cwZPRzpSqJlA/RyuYCB/CskTqfTbrfDsGEYzNxsNmTGfLzM53MIEoeopmm9Xk/uSEUxHo+JoVqtVioVVVUJI02SPM8bjQYhoYtnmTOATqfzj4xJEBwTAN6YQFRIsK/rOvPlEQan0ylxHg6HPzI/nmu1GjcEwdB1pdXikjCp4aTb5YYkn3ep1+ukDYXMfu4ZVUVRmAMIwzTyJmazGdN4c+zgTl4eAHY4JR3BN0BahAQTC9vtlhSQg/D5LnoZJBgaLKAF8hvmbE0ktc1lqQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;composit&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/397d4949099dd6d1aaffcb55e8678e37/42603/composit.png&quot;
        srcset=&quot;/blogs/static/397d4949099dd6d1aaffcb55e8678e37/f931c/composit.png 200w,
/blogs/static/397d4949099dd6d1aaffcb55e8678e37/e8031/composit.png 400w,
/blogs/static/397d4949099dd6d1aaffcb55e8678e37/42603/composit.png 800w,
/blogs/static/397d4949099dd6d1aaffcb55e8678e37/3c337/composit.png 865w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Figure 18: 合成器线程创造合成帧的过程。帧先发送到浏览器线程然后发送到 GPU&lt;/p&gt;
&lt;p&gt;合成的优点就是它不依赖主线程。合成线程不需要等待样式的计算或者 JS 的执行。这也是为什么 &lt;a href=&quot;https://www.html5rocks.com/en/tutorials/speed/high-performance-animations/&quot;&gt;只改变那些会导致合成的属性&lt;/a&gt;被认为是创建平滑动画的最佳选择。如果 layout 或者 paint 需要被再次计算，则主线程又会忙碌起来。&lt;/p&gt;
&lt;h2&gt;总结&lt;/h2&gt;
&lt;p&gt;在这篇文章中，我们探索了渲染一条龙：从解析到合成。但愿你现在有能力去越多更多有关网页性能优化的文章。
在下一篇，也是本系列的最后一篇中，我们将会深入合成线程，一起看看当用户输入事件&lt;code class=&quot;language-text&quot;&gt;mousemove click&lt;/code&gt;的时候会发生什么。&lt;/p&gt;</content:encoded></item><item><title><![CDATA[The Junior Git]]></title><description><![CDATA[因为 Git 的操作实在太多，但是有些操作在很多时候又很重要，所以写一篇文章记录一下那些容易被忽略, 又较为常用的命令。 git 是饭桶的意思，因为 Linus 的自嘲 git init…]]></description><link>https://github.com/thoamsy/blogs.git/git/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/git/</guid><pubDate>Sun, 12 Aug 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;因为 Git 的操作实在太多，但是有些操作在很多时候又很重要，所以写一篇文章记录一下那些容易被忽略, 又较为常用的命令。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;git 是饭桶的意思，因为 Linus 的自嘲&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;git init&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git init [directory]&lt;/code&gt;：指定文件夹创建，这样就不需要先 &lt;code class=&quot;language-text&quot;&gt;cd&lt;/code&gt; 再 &lt;code class=&quot;language-text&quot;&gt;git init&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git init --bare&lt;/code&gt;: 创建一个只能做查看记录，拉代码，不能编辑的 git 工作区，一般用于发布分支，或者一个中心化的仓库。如果观察这个文件夹的结构的话，会发现，它们直接将 &lt;code class=&quot;language-text&quot;&gt;.git&lt;/code&gt; 文件夹的内容，&lt;strong&gt;平铺开来&lt;/strong&gt;，放置于根目录。&lt;/p&gt;
&lt;h2&gt;git clone&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git clone --depth=1 repo&lt;/code&gt; 可以指定 clone 下来的仓库的提交数。对于临时改一些代码，不关心历史提交的情况下，这个命令大大减少了 clone 的时间&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git clone --branch=foo repo&lt;/code&gt; 只拉取某一个分支。如果想学习开源项目，只关心 master 下的记录，这个命令是个不错的选择。&lt;/p&gt;
&lt;h2&gt;git config&lt;/h2&gt;
&lt;p&gt;这里需要关注的命令不多，有一个值得注意的概念：&lt;code class=&quot;language-text&quot;&gt;git config --global&lt;/code&gt; 会将配置存与 &lt;code class=&quot;language-text&quot;&gt;~/.gitconfig&lt;/code&gt; 路径下，而默认操作(—local) 将配置保存在 &lt;code class=&quot;language-text&quot;&gt;./.git/config&lt;/code&gt; 下&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git config --global alias.[xxx] yyy&lt;/code&gt; 这个命令可以通过输入 &lt;code class=&quot;language-text&quot;&gt;git xxx&lt;/code&gt; 来取代 &lt;code class=&quot;language-text&quot;&gt;git yyy&lt;/code&gt;。&lt;/p&gt;
&lt;h2&gt;git add&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git add --all&lt;/code&gt; 将所有的改动全部添加到缓存区， 包括没有被 tracked 的&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git add -i&lt;/code&gt; 一个交互式的添加操作，不是那么的常用。而且子命令太多了，完全搞不懂是干嘛的&lt;/p&gt;
&lt;h2&gt;git commit&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git commit --amend&lt;/code&gt;, 用于修改上一次的提交记录（类似于 &lt;code class=&quot;language-text&quot;&gt;git rebase -i&lt;/code&gt; 的子功能）。不过需要注意的是，因为这个会修改 commit 的 SHA.&lt;/p&gt;
&lt;p&gt;如果之前改动之前已经将 repo 推到了 remote repo，就必须要先 &lt;code class=&quot;language-text&quot;&gt;git pull&lt;/code&gt; 然后再 &lt;code class=&quot;language-text&quot;&gt;git push&lt;/code&gt;, 这样反而拜拜增加了两个没用的 commit log. 除非远程仓库没有开启&lt;em&gt;分支保护&lt;/em&gt;功能，这样就可以使用 &lt;code class=&quot;language-text&quot;&gt;git push -f&lt;/code&gt; 来覆盖远程分支。在使用 -f 的时候，请保证这个分支没有其他人同时在修改。&lt;/p&gt;
&lt;h2&gt;git stash&lt;/h2&gt;
&lt;p&gt;算是切分支神器。工作中我经常遇到手头在解决某个事情的时候，突然碰到突如其来的情况需要紧急处理，但是手头上的工作又不适合做一个 commit 的话，就可以用到这个它。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git stash apply&lt;/code&gt; 相比 &lt;code class=&quot;language-text&quot;&gt;git stash pop&lt;/code&gt; 的区别是，它再使用后仍然会存在于 &lt;code class=&quot;language-text&quot;&gt;stash list&lt;/code&gt; 中，可以用于其他的分支。就有点像 Stack 中，直接取 Stack Top 和 Pop 后取返回值的区别。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git stash&lt;/code&gt; 只会 stash 被 &lt;em&gt;tracked or added&lt;/em&gt; 的文件。可以使用 &lt;code class=&quot;language-text&quot;&gt;git stash -u&lt;/code&gt; 将未被 track 的文件。&lt;code class=&quot;language-text&quot;&gt;git stash -a&lt;/code&gt; 会添加当前被修改的所有的文件，包括在 ignore 下的。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git stash save [message]&lt;/code&gt; 和直接 stash 不同，如果直接使用 &lt;code class=&quot;language-text&quot;&gt;git stash&lt;/code&gt; ，这次 stash 的名字会直接以当前最新的提交的 title 来命名。这样可能会有些困惑，因为并没有描述清楚这个 stash 到底做了什么。这在一段时间后，可能就懵逼咯。所以可以使用这个命令添加描述性的标题&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git stash pop [index]&lt;/code&gt; 添加 index 就不需要按照 stack 的顺序来选择 stash。而 index 的值可以对应 &lt;code class=&quot;language-text&quot;&gt;git stash list&lt;/code&gt; 下的 &lt;em&gt;stash@{n}&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git shash show [-p] [index]&lt;/code&gt; 仅仅看到列表还不够，还需要看到某个 stash 到底改变了什么。就可以使用这个命令，其他添加 -p 选项，可以获得和 git diff 一样更为全面的信息。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git stash -p&lt;/code&gt; 这个命令和 &lt;code class=&quot;language-text&quot;&gt;git stash -p&lt;/code&gt; 很像，很针对每一个文件的每一个 chunk 来提问，是否需要被 stash。算是为完美主义者准备的工具吧，无聊的时候可以试一下，反正我是头晕。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/eb4e4ce53ad8ec1c9ced561cd3b1279e/43574/stash-p.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 44.09448818897638%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5klEQVQoz4VSyQqFQAyb//9BQVQc931fjpUUMojie4fQZdqYtpo4jiUIAvF9X4ZhkPM8Zd93xXEcDqzzPE+aptHctm0vmLZtpe976bpOLYoB5OnXda3AO/LTNGnzuq4vmHEcnQo0JUniyKqq0lye58I6KP8iU0KMyQBEIGDjHXhfluUvlJDzQxXUpGkqWZYpEIPs+YEvGOwFDSCEwrIsdVQAflEUbnzmYJEn7rEehSNzh1RIa63VPOzzYPBxUMZ6FC4aD1TAy1Idr/38nbhv+gZF+A0ASA7DUJVEUaREWPQ8zw4Q8AsXWLOoAmdlszMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;stash p&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/eb4e4ce53ad8ec1c9ced561cd3b1279e/42603/stash-p.png&quot;
        srcset=&quot;/blogs/static/eb4e4ce53ad8ec1c9ced561cd3b1279e/f931c/stash-p.png 200w,
/blogs/static/eb4e4ce53ad8ec1c9ced561cd3b1279e/e8031/stash-p.png 400w,
/blogs/static/eb4e4ce53ad8ec1c9ced561cd3b1279e/42603/stash-p.png 800w,
/blogs/static/eb4e4ce53ad8ec1c9ced561cd3b1279e/43574/stash-p.png 1016w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git stash branch &amp;lt;branch-name&amp;gt; [stash]&lt;/code&gt; 为了防止有些时候一旦 pop 了某个 stash，导致冲突的话，可以通过将这个 stash 应用在一个新的分支来缓解问题。&lt;/p&gt;
&lt;h2&gt;git log&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git log --stat&lt;/code&gt; 用于显示某次 commit，针对一个文件行数的增加和减少，文件名的修改情况。
&lt;code class=&quot;language-text&quot;&gt;git log -p&lt;/code&gt; 会显示某次 commit 的 diff 状态
&lt;code class=&quot;language-text&quot;&gt;git log --author=&amp;lt;name&amp;gt;&lt;/code&gt; 快速过滤某个 author 的提交次数
&lt;code class=&quot;language-text&quot;&gt;git log -n&amp;lt;count&amp;gt;&lt;/code&gt; 显示最近 count 个提交&lt;/p&gt;
&lt;h2&gt;git tag&lt;/h2&gt;
&lt;p&gt;Git 中有两种 tag：&lt;em&gt;annotated and lightweight tags&lt;/em&gt;
前者会包括一些注释信息，来进一步解释这个 tag 的作用，而后者就仅仅只是一个 tag 的名字。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git tag &amp;lt;name&amp;gt;&lt;/code&gt; 会创建一个 lightweight tag&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git tag -a &amp;lt;name&amp;gt;&lt;/code&gt; 则会创建一个 annotated tag，之后会弹出 git 默认的编辑器，用于描述注释&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git tag list -l &amp;lt;pattern&amp;gt;&lt;/code&gt; 通过 pattern 过滤 tag list&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git tag -d &amp;lt;tagname&amp;gt;&lt;/code&gt; 删除 tag&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git tag -f [other]&lt;/code&gt; replace 一个 tag 以其相关信息&lt;/p&gt;
&lt;p&gt;同时，还可以 checkout 某个 tag，但这其实相当于跳转到创建该 tag 的 commit 上，进入 &lt;em&gt;detached HEAD state&lt;/em&gt;。这个时候最好不要修改代码，或者先创建新分支&lt;/p&gt;</content:encoded></item><item><title><![CDATA[使用 VSCode 搭建一个很爽的前端环境]]></title><description><![CDATA[这篇文章主要是针对打算学习前端的小白，和想学点前端的后端大佬，为了提升你们的编码幸福感。 工欲善其功，必先利其器 简单介绍下背景，VSCode 是目前前端界最为流行的一款 编辑器 ，每月一次的更新，强大的插件生态和 TypeScript…]]></description><link>https://github.com/thoamsy/blogs.git/vscode/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/vscode/</guid><pubDate>Mon, 04 Jun 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;这篇文章主要是针对打算学习前端的小白，和想学点前端的后端大佬，为了提升你们的编码幸福感。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;工欲善其功，必先利其器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;简单介绍下背景，VSCode 是目前前端界最为流行的一款&lt;strong&gt;编辑器&lt;/strong&gt;，每月一次的更新，强大的插件生态和 TypeScript 的整合，让这款编辑器瞬间风靡世界。像之前的 Sublime 和 GitHub 的 Atom，都无法与它抗衡。比如 &lt;a href=&quot;https://vuejs.org&quot;&gt;Vue&lt;/a&gt; 的作者 Evan You 也是用它作为主力开发工具。&lt;/p&gt;
&lt;h2&gt;准备工作&lt;/h2&gt;
&lt;p&gt;第一步当然是下载 &lt;a href=&quot;https://code.visualstudio.com/&quot;&gt;VSCode&lt;/a&gt; 并安装。Window 用户印象中还需要下载一个 Git 的工具，无论你知不知道的 Git，以及 Git 和 GitHub 的区别，反正去&lt;a href=&quot;https://git-scm.com/&quot;&gt;官网&lt;/a&gt; 下载好这个并安装。如果你在终端（命令行）中输入&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; --version&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;会有一个版本号输出的话，就说明下载成功了。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/d3c11/DraggedImage.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 7.00218818380744%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAVklEQVQI1xXGKxKAIABAQQJDkWDzHDYZqA5SxOAYLX6iRcEbeO2npl1hTYMxBuscIQS87xj3xHw9DFumXy7imonb/f33ZEot8agpqwIpJVprlFIIIXgB9H8jk7lhonkAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/42603/DraggedImage.png&quot;
        srcset=&quot;/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/f931c/DraggedImage.png 200w,
/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/e8031/DraggedImage.png 400w,
/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/42603/DraggedImage.png 800w,
/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/5b8b9/DraggedImage.png 1200w,
/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/c7ea5/DraggedImage.png 1600w,
/blogs/static/0648f1f5a16dfb03dd0a812f5e030e05/d3c11/DraggedImage.png 1828w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
Mac 用户只要安装过 Xcode 或者开发者工具套件的话，就内置了 Git 的功能。之所以要安装 git 是因为 VS Code 的插件基于 Git 的支持。&lt;/p&gt;
&lt;p&gt;接着还需要安装，&lt;a href=&quot;nodejs.org&quot;&gt;node&lt;/a&gt;，&lt;a href=&quot;https://yarnpkg.com/lang/en/&quot;&gt;yarn&lt;/a&gt; 英文不好的同学也不要管那么多，看到 &lt;strong&gt;Install, Download&lt;/strong&gt; 这种单词就点，下版本最高的就行。Window 用户的 node 需要下载的是一个 &lt;code class=&quot;language-text&quot;&gt;.msi&lt;/code&gt; 文件不是 &lt;code class=&quot;language-text&quot;&gt;.exe&lt;/code&gt; 文件，&lt;code class=&quot;language-text&quot;&gt;msi&lt;/code&gt; 文件能给 Window 环境写入一个二进制文件，而 &lt;code class=&quot;language-text&quot;&gt;exe&lt;/code&gt; 仅仅是一个 node 的 REPL 环境。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;因为作者本人对 Window 不够熟悉，很多描述是靠之前碰到过的坑，如果碰到问题的话，还请自己使用搜索引擎解决&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;还是和之前一样，输入几个命令测试是否安装成功。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;node -v
yarn why&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;在这两个都确定安装好后，继续输入&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;yarn global add eslint&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Window 用户如果 Yarn 没有安装成功的话，就使用 npm 安装作为 B 计划&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -g eslint&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;安装好后，就会有打印出安装成功的 eslint 版本。&lt;a href=&quot;http://eslint.cn/&quot;&gt;eslint&lt;/a&gt; 是一个 JS 的静态分析器，它可以解决一些写 JS 经常遇到的问题：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;变量名写错了，但是没有报错。&lt;/li&gt;
&lt;li&gt;自己不想写分号，让它自动加&lt;/li&gt;
&lt;li&gt;强制要求格式的规范&lt;/li&gt;
&lt;li&gt;等等&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;还有 &lt;a href=&quot;https://www.typescriptlang.org/&quot;&gt;TypeScript&lt;/a&gt; 这是微软开发的一个 JS 超集，安装它的目的主要是它能够为 VS Code 赋予更强的能力，让开发更爽。设置里面会有很多功能性开关，需要安装了指定版本的 typescript 才可以，所以我们安装最新的就是了。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;yarn global add typescript
// or
&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -g typescript&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;和上面一样，如果 yarn 没安装成功的话就是用 npm。在本文写作的时候，typescript 的版本为 &lt;code class=&quot;language-text&quot;&gt;2.9.1&lt;/code&gt;
接下来就进入 VSCode 的流程。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;最基本的 VSCode 的侧边栏有五项
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/3acbbb2f132d7f0b2efc67f5e1a65f70/c29b3/DraggedImage-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 102px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 525.4901960784314%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAABpCAYAAAA6NQMSAAAACXBIWXMAABYlAAAWJQFJUiTwAAAID0lEQVRo3u1ZaU9UZxTmJzRp2qSmdR12kEV2EHBlU8R9AcUVFRVxx11UBBdEK/vqvmsVUHGppn7RWq2K2miqH0zT2JiYmCb9YNLm6fuc4eKdYe5wh5K2aSU5ucPc9z73vO855znLuPXq7Yvukt59/ODWPzAO3SEBwfHoZwmAW2hEIv6qhIQnIiwyGRb3ILgNCBuO7hAC93MPhFtIeAIcCRfxGhaZhPAoJW1XPqjd06+1AgY5BtQ/4OkTA3evKJF+HhHoHzS4A6hTQG1hcOgwBA4Ygn2lVTj71XmRy1euYFJ6Fnz8Y0Vzba1pDUePm46N+UXYuq0YWfOW4tGjB3j79jXiBo+Wl2maOgXkmz19olFeWYuHrfdx6sxZfH39Ou59fxfJI6fg+fNn+ObmTXj7xbZZuBMNefAWz0hcvNSCGbNy0OOLQAxPmgD+3bp9Cykj0/Hd3TvtmpkD9IrEufNNmJu9DB7e0UhMmYym5gt49ctPyFuzGc0XLpo/Qw3wfGMz5sxdqrY2EBFRyfjkMz9U1TSgcHsJGpuaFWCiq4BNmJe9HL4B8YiJSxXgQ4ePoaCwGFevXXNdQ2oxYfIcfNrDH16+MfjoY09UVNVhW9FubN6608APA42Ncu58o2ybGu35skJAWpXbLF6yBn0sYbJlDUwDtDjSMFRJQPAQpI2djr0KiGAle8vFwQkaNXCkzVb1V2+fUONIYYj1dQ9vlz5KGH6MIPvwbAf0DTWOFG5BSMFO7MFMAboq/2dAn27XMKxzQHuLGls5EZ7eIc4B9XnFyuBD2zOd6dCzB+OVFBYRnaKYOk1Iwj9wkA2o09Czzyv8XL//EJ4++0HJE9xUbJ2aNhV+ioVMpYD2mFYLqA2J9ts7tzF2/AwkKaKtqm7Ay5cvMHjYWGteMZOkeJMajJ80G89fPBNmIYXxDHv0DMKllsuort0vrKTxolNALVGtWp2P6zeuw907SrHMCETGpEieZha81NIieZrxbUJDK9uMGpOJx09aEa0oi0zD7z7vFaxecgPlFbXmNORNLuLD1Oj165/R2voA06YvwGjFkceOn8KPz59iYPwoBIUMNU4BemvRLcJVYqJ2b968Qk3dAdx/cA9Pnz6RrQ5PmmjjOk41DAoZhlj19kePH+Ldu18lr/TqFyoPRUQni0+S0R35YQdAbtVDGeP4idP44/ffMG7iLGXdgeLUfIh+yTUuFUt8+xjlc2nKIPZFkbNYNjxDfub59A8aZJPMO4t5p1Z2RABdBuwqH34AdE79eg8wum+qxnaWT1zuAsh9WnQEtTG3NackCLHqNe9UQz5AAli/cRtW5m1CTGyqAC/MyUP+lh0SkowoUxryhm//OAEiaMa0bGTOXKTq7ElYtnw9Bqg1bDVMb1kj1wmK/teu36qkAAnJE4UgWLCvXbdV1d5LHGpocWZl5pSjx05g+869kk88lcydvwxXrl4VBud52vOoYV6mltQgJ3e1FO/pU+erLDdOveCk1Nj2bqRVDh6eA4ytrLEOz/LkqTM4cvQEdhXva7e8Ixfy8gnvvBulgbjtAwePtDG61XUclcRePp0USzwXGqho+x407D8sPbMzZzfUUJ/seX7sRJn06Yd+gfHtTaPLgDzDiSpJsTeZNSdXOqsuA2pCA2RMmy++F95W1hm1FU4B9Q9QKxrHiDRMa6gtfD9OSei6UYx4zxnBWjy6nbED/ws5peOcK8G1yZKejhi3dBfWON5K+Jl+aLpYeq+VlWk48GF0kGhXr92iomWx1I1GbUUHo1hvWMGmqoq1rKIGmzZvx6ysXGQvXIktBbtQWV2vOoKZDgtOi331ZY3feAG7qpiZ1/ghY6R4Z53Iday76xsOSbnHCk0DFQ0tdhryzNgtlSvNZmctQWVVnbrmyuwhJTVdyJYPT06fi31lVe2NUUi4g16Pb/Dxj8P8BSuwbkOB9COpo6ehRvUjGzYVorqmAadOn8VsRRLMJzsVe4+boG09oWM3agWMlczGLc6cnSOzr+UrN8hEZIdi7cKiEiSNmCyANBINxmc0d7LplzVAgq3My5e0uUalzBMnT8u1rLxGrE1DLcxZhRWrNkkWtAH0tQOkn81UrrGlYCd69g0RLTiWYrZbtDgPVTX1mDQlS7oqniubSKYIDaPDiICHTD/j0IxWZCrl1nmuTAEjR2XI9qlx0Y49umTvYOagb3roZw2qpSX991Y9CgeRBORAiGUIjRMvU86hzmcOelD6W2lZNXaXlElyz1cOvndfpWhGsIDgwTaObThz0EDptDwCugbzCd2FZ8ZtaqOCDoneaOaggfJKbWlJit4AXZ452NCXK53Uh7ai+wDNNoz29eHfA6ifKDES6MS8Wv8fAn/l7PRLfqcHMwTUwo6MXFFZZ50OK2ZOV9VXcUkpqmsbZJZNKuOUyRp+TmcOihMVhTHU+NsJa+vDR45jamY2ausOYMmydVikCnnOuPnTiD5RGWpITiRTc5xCgMwZC+UFJNURqRkyyj946KjMcEwDkgNbLl9WpLpafldpbGxGU1MzineXynck3bSxma4DshQmhZH/zpw9J9TFapZMPmjoGBs+NK0hjcDm58LFi9ix60tJr2Rt9oEaY5s+w9ylazFdNY6s/lk5sCNg9XBNbXmUSrGdbllvZWrIwdmRo8dFM76E/zML8tcfMrqpM2SBPiVjniR4bq22bj+2FRZLoVRXf0C+Y0WRPGJK5374PlJU967KEhHVjLNE0X7n42eKqUj595PDhxTwAfAfAvwTKMDnbWBoVMQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 1&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/3acbbb2f132d7f0b2efc67f5e1a65f70/c29b3/DraggedImage-1.png&quot;
        srcset=&quot;/blogs/static/3acbbb2f132d7f0b2efc67f5e1a65f70/c29b3/DraggedImage-1.png 102w&quot;
        sizes=&quot;(max-width: 102px) 100vw, 102px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
其中第五个就是安装插件的一个 Tab，点开来，选择常用的拓展，就能看到根据安装量排序的拓展工具。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/f20afe910439f6f7b19ca45e9cc848c3/2e17d/DraggedImage-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 99.75550122249389%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAAErklEQVQ4y1VVaU9bRxT1j2iaD2Hzhnc/288GY7ywh12EsARCwpJQlERV2qrhS0BR2RKRQMCsNhgKBgwhbIHYmDWsbVqoKqWpqv6Z0ztDqdQPV3fGb955995zzlgiswlQKsxQqS1QKE2Qygz/iwSpgZ4bIVcIkMmNiE/QQ6/V0PriWYJUz7NUpqdzekjkUgEW0QlHaiYEUwquxajoJS0d0vHDMXEauOxuGIVkKBPpgwRaVSilfQo0ehf/UHyCjp8XjSpIFIkWCGb3f2EW02AQnFBpknmotXZIFRYUFlejp3cELa2daH3WjaeUn7Z0oL2zB96BMfjGg2hs+hYSpcqKVFcBnO5CHumZJbDZc6A1OHnoBTdkCisa7j9GZHMfo74pTAffYIwAfP4phBZWsX/4ER/PP6Hr1RABJpqRlp4Pl/s6dPokqDVWJKosiIvX8WDzufKlDJW36rGyGkG/14+h4QC8g2MYHApg8sd5RLYOsH/0C9qoAwkjIjunCJmZVKUzG5lZhfSBPCQlp/G52lMyINKMHzz8jgA3MTA4zlv0Uh4cnsDk9BtEto/w4eQcP3QPXgCKoosDmMwOYlqARmvlrLPqE1VmxMSqcffuV9hYD2N4yA/f6DgGvCO0HsNMcAG7e0f46eczdPZQy4wlsyUVekMyl42cJBIXr/23ZS1n+upVGUrKGzC5uIuuvik8p3jhDaJ7cBbewAqCaydY3P4dTzqHqUI5ycbi5PNjoGZaG4x2aHU2ng2CAzq1ETJPE9wdf6Gi9xMqXn/Grf7PKO/7E/kv/oC++TcYWv6GqXEaEpmWZGNxwEBgrFUmXhaXwma/sVk+/LoZq5FjzC9vY35lBwuru5R3+XpuaQeRvXO0vvRBItQWw52eC48nlzMtWl1ItqfD6cqB1ebmlcaTaKuqGxCN7iEQmMZEIIhQaAkzM4tYWQmTnPZwenqGrn4/yUYroiD/JoqKy5GbV0LVZCE9owB5+Tco5/O9jkDr6h5g7d0WevtG8LpvlDQYRD+x/XY5guj2MQ6Pz9DGWSYmbfY0JCUxllM5MZcsJ6pElJXXo7SsDt8/eYZwZA9zoWXMzi1haTmMtbUthEns4c0POCBxt70iUoT6Yngy8mCzeaAkiTDAWPJvTKyGZ5Xayi+EmjtNeLceJfsNUYUjmJldwvrGDpZJ7Ovvd3F8coZ2BijXW6jlUmqxlAubzY5dFiyYNm1JHnKPiHv3HxHAFrxeH7dcX/8ohQ8TkyFqO4yT03O09zCnKEyw8RfTuCsEk4O3y9pmsmF7ptU7JOzN6D4WyLvzFEEiJDS/ip3dE0SiBzg6/hVtL4fYDE2c1VSqLsVBVrNnEKDIXcKEfS1GjS+uJKCiso4q3OY+Hg/M0gWxiMDEHL8s/GNBLL7dQEfv6AUpzMtZ2UVcNszLrG235zqXDaua6bKq+h4iREo/b3maQGfgp7xB89sI7+GQLofnff4LLydTy6LVzefGACzkbaY/FuwiZWeYAh5/04wbpbdxs7wWZRX1KK9sQPXtRtTUNKG27hFySREc0OnKvriBaW6XfwOXfo6N03KWL33N9lIZeV5JZ1VJiJcZoZRbaC9Cn1GCfwC3AkIyaVCR3wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 2&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/f20afe910439f6f7b19ca45e9cc848c3/42603/DraggedImage-2.png&quot;
        srcset=&quot;/blogs/static/f20afe910439f6f7b19ca45e9cc848c3/f931c/DraggedImage-2.png 200w,
/blogs/static/f20afe910439f6f7b19ca45e9cc848c3/e8031/DraggedImage-2.png 400w,
/blogs/static/f20afe910439f6f7b19ca45e9cc848c3/42603/DraggedImage-2.png 800w,
/blogs/static/f20afe910439f6f7b19ca45e9cc848c3/2e17d/DraggedImage-2.png 818w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
如果真的想要好好运用 VSCode 的话，还是要自己多花费点时间在这些拓展上，找出几个真正适合你的。&lt;/p&gt;
&lt;h2&gt;美化一下&lt;/h2&gt;
&lt;p&gt;默认的 VSCode 还是蛮丑的，特别是底部蓝色的状态栏。显然需要美化一下, 从三个方面着手&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;字体&lt;/li&gt;
&lt;li&gt;主题&lt;/li&gt;
&lt;li&gt;文件图标&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;字体&lt;/h3&gt;
&lt;p&gt;选一个好看的字体还是挺重要的，如果每天面对 Window 的 cmd 那种字体的话，写程序一定会十分痛苦。目前广受好评的一个开源字体是，&lt;a href=&quot;https://github.com/tonsky/FiraCode&quot;&gt;Fira Code&lt;/a&gt;, 好看是一方面，还支持一个特别神奇的 &lt;em&gt;font ligatures&lt;/em&gt; 功能，它的效果就是能将你输入的一些特定的符号组合，换成另外一个更为&lt;strong&gt;写实风格&lt;/strong&gt;的符号。比如我们常用的 &lt;code class=&quot;language-text&quot;&gt;!=&lt;/code&gt; 最后就长得和 &lt;code class=&quot;language-text&quot;&gt;≠&lt;/code&gt; 一样。 &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 97.82135076252723%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACSElEQVQ4y3WUi5KqQAxE+f+PtNzHVVdFEJHH8MjtM0usAWupmppBM53uTkJmeuZ5ZrO+7y2E8NrLsjT/32OmabJxHOPiPAzDKiZLg4uisOPxaLvdzs7ns+33e/MnTfp4POx+v8czy/+LgH7om8Y6rbqu7fzzY/XCbhLTSWy27GDm7FYMCR7a1kLXWa3MyIQpZxI0Ah9hsQA6kC/AU5VZB6PLxQ6S+nw+o5SL3l1+qXdCOyVsSSzG7jOL31LZWaNLvUAfWlVVRcl37aUAGyUIeh8FRjiMHNCXM3x5OEvGRCZdbAXQ63KvrLUAW7EbdfZgB3QfOW99zAb5NAiskFeFKptLblynUyxMEGhw2QLHFmS2yxkrVgwB68UGlo3AP7++7CiwKJHKX6+x0v7ADCBiHShtqwgYW0OZRu30GAs52LFti7Rltv5FhjDo89w6si5gFCaCKgnMSep96FMEIOdpSfpiiNygqgJYybNcCWgXQGHQyc8g8Ai4FAK5yOb8BtjqwsiE6BIMqfRT77QQjW0uaWlqb5e04itAJAcxo4L0H+yQS/UCcqmkYrjgkmHIDugbw1g5vKIICoAZ0zLTa/SkLMHD1HzvwfQ3f34ZilGcUwUCVmnR6MwwgP3t9rpI3F9T8ts2mCsAnoaxE8CVpoYlPilZygCZ2OFr+72MkzLJP2Y3Pxzs9P1t/9TcH/om0pcUhRiKEgTmLYU17G9FoWUGqqtLV/XjDWDtFCgw25LLPLvc9GvtawUYAxcm7g1SRgVSmHRa/npSS/4D9uQcJRvtDb8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;fira code&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/34775835d427cb3f5ef2b4415bfc6afa/42603/fira-code.png&quot;
        srcset=&quot;/blogs/static/34775835d427cb3f5ef2b4415bfc6afa/f931c/fira-code.png 200w,
/blogs/static/34775835d427cb3f5ef2b4415bfc6afa/e8031/fira-code.png 400w,
/blogs/static/34775835d427cb3f5ef2b4415bfc6afa/42603/fira-code.png 800w,
/blogs/static/34775835d427cb3f5ef2b4415bfc6afa/5b8b9/fira-code.png 1200w,
/blogs/static/34775835d427cb3f5ef2b4415bfc6afa/c7ea5/fira-code.png 1600w,
/blogs/static/34775835d427cb3f5ef2b4415bfc6afa/00685/fira-code.png 1836w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;通过 GitHub 下载好字体文件后，安装到系统上。安装好后，进入 VSCode 的设置，设置 &lt;code class=&quot;language-text&quot;&gt;editor.fontLigatures&lt;/code&gt; 为 true，在 &lt;code class=&quot;language-text&quot;&gt;editor.fontFamily&lt;/code&gt; 的最前面加上 &lt;code class=&quot;language-text&quot;&gt;&amp;#39;Fira Code&amp;#39;&lt;/code&gt;，保存一下，去看看效果吧！&lt;/p&gt;
&lt;h3&gt;主题&lt;/h3&gt;
&lt;p&gt;2 和 3 就不需要这些步骤了，通过按住 &lt;code class=&quot;language-text&quot;&gt;Cmd/Ctrl&lt;/code&gt;，接着看 K 和 T 两个键，就可以选择其他主题。不过自带的主题如果不过瘾的话，还可以下载其他主题，推荐安装一个 &lt;em&gt;Dracula&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;而文件图标的效果就是让你的文件或者文件夹有一个小图标，提供辨识度。像这样 &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/d76beb34e8f3330dbe8bb2368c55950a/13b6e/file-icon.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 524px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 82.82442748091601%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACLklEQVQ4y5WU647SUBSF+w4mXoaBtgO00NspvbcDhV4YwIJDdGK8TkjU6CQmvoA/fPPlPhXHaCKUHyvtaU5XvrPX3keYZSvc7j7h88c77G4/wPUm8Py0fvpBSpqeJEHTfbjOJczLEsZ4DoPWbJRgRN90I8BQ88D3cPH3YxLaogZDYXhQvsSj119hay7mi2sU5RqmGeLxkz7O2wO0zlV0RB2idFiCJOtQFR9+wZA+C4gwRhhnsFgMZsf3JeDq9hgk2YB8Yf5Xe8MA8cJC9S6BzSbI8hXipEBCZeCkWf4UebGGOnCI4ohhhzAN1cTD4gvEm++I3AhZUYGHJUoazloKWm21PjJfHz1yX/VgGRGUcQVWvUEc5kjGCwRhQUUOicr/R95BCbabYxZfo/u2hHK3xHr+CrNiSwlPqH4lHPc0CYriYKAlKLMRNuuIwpgSXU6BjKEQ/akSJGmInhpjt1Xx41uKEVFdLTZkOtvXTQcPrqkE+cJAu6NjONBhairs0QTT2RLjyVWd9K9WMQ8m+1fKMvVVR7IQOgN4TIVhJmQ2R0JmnpfWfccp+eZjPbjvQxOiqGLAttCc97Asj3pvQ5QrhFFWk/KR+m3awJAISIbiwlZ9Csir62exCKYVUTgJen27Ed3+yDrOZIZlT8YL+QxOXKKqnmM+39B0VIjivDHdH0L6wWQBHNujGob1NTRJF9SHaU3YtH73hh2aT4cMR8ylS2Bajx2n4zPMCbs9q7HhTxj3DaHWmJQ3AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;file icon&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/d76beb34e8f3330dbe8bb2368c55950a/13b6e/file-icon.png&quot;
        srcset=&quot;/blogs/static/d76beb34e8f3330dbe8bb2368c55950a/549d5/file-icon.png 200w,
/blogs/static/d76beb34e8f3330dbe8bb2368c55950a/11c0c/file-icon.png 400w,
/blogs/static/d76beb34e8f3330dbe8bb2368c55950a/13b6e/file-icon.png 524w&quot;
        sizes=&quot;(max-width: 524px) 100vw, 524px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
这个功能隐藏的比较深，需要直接去设置。按 F1，输入 &lt;code class=&quot;language-text&quot;&gt;File Icon Theme&lt;/code&gt; 就能找到，官方也提供了几个主题，但是不怎么全，也不是那么好看。本人推荐 &lt;em&gt;Material Icon Theme&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;有了好看的编辑器，才有动力写出好看的代码。&lt;/p&gt;
&lt;h2&gt;安装插件&lt;/h2&gt;
&lt;p&gt;先看看，需要配置的插件&lt;/p&gt;
&lt;h3&gt;ESLint&lt;/h3&gt;
&lt;p&gt;现在没有 ESLint 已经没法写 JS 代码了，我们不需要花太多时间在找自己的拼写错误导致的 bug 上。下载 VSCode 的 ESLint 插件后，重载 VSCode，打开设置，搜索 &lt;em&gt;eslint&lt;/em&gt;。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/e9220b82be80fb3c7b82126a19a0f78d/bc0fd/DraggedImage-3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 26.344086021505376%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/klEQVQY02WQSUvEQBCF5884SSa9ZOskbRYTs4wJEQkyoIcRBBFv4v8/PKtbDANzKF71o/iqXu/2roJzyMCjBomeEecT/KCBSEbyOoi4x3r6wPn9G7qcwQPywnuwoIUvanq3OLACjpfCJc7O8RRunATlsOL18wfT8xuYHiHvFohqhqwXSKPFA5iskIQjVHQkiN4gpjagudAapHuHrvWybcg1vRm0Xm6TmPJ8DY/dbqB/mFELNE2UjajHE3TzBJ70EOkRPB0gMlI1QFLMIOwRRAN8Xtm4dskF7CKygm4fsZ6/0C0v8NMOnGKznP6xmMCyHoyXiGSHmKB/AHUV19Qvukmh/+Kzg0oAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 3&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/e9220b82be80fb3c7b82126a19a0f78d/42603/DraggedImage-3.png&quot;
        srcset=&quot;/blogs/static/e9220b82be80fb3c7b82126a19a0f78d/f931c/DraggedImage-3.png 200w,
/blogs/static/e9220b82be80fb3c7b82126a19a0f78d/e8031/DraggedImage-3.png 400w,
/blogs/static/e9220b82be80fb3c7b82126a19a0f78d/42603/DraggedImage-3.png 800w,
/blogs/static/e9220b82be80fb3c7b82126a19a0f78d/bc0fd/DraggedImage-3.png 1116w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
这里主要需要修改的几个配置。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;eslint.autoFixOnSave&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;eslint.packageManager&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其中第一个设置是可以在每次保存的时候，自动修复一些&lt;strong&gt;能自动修复&lt;/strong&gt;的错误，比如少了分号，缩进不对等等… 注意 VSCode 的设置不能直接修改，需要复制到右边的用户设置区，来修改。通过点击左侧的那个 edit 图标就能复制到右侧，接着修改后再保存就能生效。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/c145d6992b35b4c76d6b5de65dd7cac3/655e1/DraggedImage-4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 13.904761904761905%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAuElEQVQI103OSU7DQBBGYZ8GYvdAd2cwbjuecIiJIoSsIBbgLQskLsDlH4WzYfGpSvo3L7lZbVllBamKaNugTE2myuuvq0UmmzJ7tGtJTSVKlK0xvifTJbfpVuwWSR5HyvaFaf5m/vrhdPlk170Sx5n74Y3i+E4xfpDXE8XmzLCfaeKFzfpICI8EP+DdgxgWiQstft1Ttc+0h4k8PmGkxIYe67vrld24BiOV7q4XHcZKsdTrv/J/fgEJo2QNkocmwAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 4&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/c145d6992b35b4c76d6b5de65dd7cac3/42603/DraggedImage-4.png&quot;
        srcset=&quot;/blogs/static/c145d6992b35b4c76d6b5de65dd7cac3/f931c/DraggedImage-4.png 200w,
/blogs/static/c145d6992b35b4c76d6b5de65dd7cac3/e8031/DraggedImage-4.png 400w,
/blogs/static/c145d6992b35b4c76d6b5de65dd7cac3/42603/DraggedImage-4.png 800w,
/blogs/static/c145d6992b35b4c76d6b5de65dd7cac3/655e1/DraggedImage-4.png 1050w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
第二个设置是根据你使用 yarn 还是 npm 安装 eslint 来确定的。如果使用的是 yarn，就改成 yarn；npm 保存不变。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;eslint 通过一个&lt;strong&gt;规则文件&lt;/strong&gt;驱动，可以叫做 &lt;code class=&quot;language-text&quot;&gt;.eslintrc, .eslintrc.json, .eslintrc.js&lt;/code&gt; 等等，刚开始的时候，你可能不知道 eslint 有哪些规则，这该怎么办？我们可以使用 eslint 默认的设置，来入门。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;eslint --init&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接着会需要你回答一些和偏好有关的问题&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;How would you like to configure ESLint?
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Answer questions about your style
  Use a popular style guide
  Inspect your JavaScript file&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;类似于这样的问题。用方向键控制，回车来确定。最简单的方式是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Answer questions about your style&lt;/li&gt;
&lt;li&gt;y&lt;/li&gt;
&lt;li&gt;y&lt;/li&gt;
&lt;li&gt;这个问题是根据你是在浏览器还是在 node 上&lt;/li&gt;
&lt;li&gt;这个问题是问你是否使用 CommonJS，如果不写 node 的话，选择 N&lt;/li&gt;
&lt;li&gt;Do you use JSX? 写 React 的话，就选 y&lt;/li&gt;
&lt;li&gt;Spaces&lt;/li&gt;
&lt;li&gt;Single&lt;/li&gt;
&lt;li&gt;根据电脑系统选择换行的组成。LF/CRLF&lt;/li&gt;
&lt;li&gt;y&lt;/li&gt;
&lt;li&gt;JSON
根据我这个配置会生成如下配置代码&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;env&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;browser&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;es6&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;extends&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;eslint:recommended&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;parserOptions&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;sourceType&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;module&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;rules&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;indent&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;error&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;linebreak-style&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;error&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;unix&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;quotes&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;error&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;single&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;semi&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;error&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;always&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意 &lt;code class=&quot;language-text&quot;&gt;indent&lt;/code&gt; 这个 key，根据你的偏好来调整数字。4 表示的是 4 个空格。接着根据这个配置文件，eslint 就能发挥作用了。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/56a79be7625a59306c6ee766158c9e6f/27268/DraggedImage-5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 36.09022556390977%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABTUlEQVQozz1QW3KDMBDLZcLDDwyEYIwBA2k7aZsmvf9lVBmafGh2tDurXemQCoskb3EUHbJihCoXHLMWqXCQZkYue2jpUZoVirUoAlTBvpqQCY+M8yQ745g2SIiD0J5LDoO5wBUXlHWH3n/A+SuMaaH1gGq64TQ/cOpnmNrBhxnTusJPATV5rhzFW8LikKso2KEdb2jDHbV7h52/Ma5XTNMVgw9o6gm1GWAKLksLqS206fipJd+FUrqM2AVptyxoq+hR8VrFKrksdQ+h7G4pa15LkSdZuyHNd7Gn6MtyzCzXE2S5ckgxZiXIFXNU7MU8o0DkunrbZtHZ88hLUDIjZUac11808x2V/4QJPyiXBxdnWm0xhC+E9Y55uUHTybgEhAtnZ7qp7f7Qv+gmKFSPkvZK2hW8msWQt6DtFrZQHeGYmf/ndkOcx0yf38X6B2//3rl9Fy5DAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 5&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/56a79be7625a59306c6ee766158c9e6f/42603/DraggedImage-5.png&quot;
        srcset=&quot;/blogs/static/56a79be7625a59306c6ee766158c9e6f/f931c/DraggedImage-5.png 200w,
/blogs/static/56a79be7625a59306c6ee766158c9e6f/e8031/DraggedImage-5.png 400w,
/blogs/static/56a79be7625a59306c6ee766158c9e6f/42603/DraggedImage-5.png 800w,
/blogs/static/56a79be7625a59306c6ee766158c9e6f/27268/DraggedImage-5.png 1064w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
像我这个代码就有很多波浪线出现，就是因为 eslint 在抗议了。第一个错误和第三个错误是因为我们在设置的时候没有选择 &lt;code class=&quot;language-text&quot;&gt;commonJS&lt;/code&gt; 导致的。&lt;code class=&quot;language-text&quot;&gt;console.log&lt;/code&gt; 下面会有波浪线是因为 &lt;code class=&quot;language-text&quot;&gt;eslint:recommended&lt;/code&gt; 的默认配置里，包含了一个选项
&lt;code class=&quot;language-text&quot;&gt;no-console: error&lt;/code&gt;，意思就是语句中不能出现 &lt;code class=&quot;language-text&quot;&gt;console&lt;/code&gt;，否则就是 error（error 还是 warn 决定了能够成功编译文件，出现了 error 就不行）。调整的方法也很简单，在 &lt;code class=&quot;language-text&quot;&gt;rules&lt;/code&gt; 中添加一句 &lt;code class=&quot;language-text&quot;&gt;no-console: &amp;#39;off&amp;#39;&lt;/code&gt; 来覆盖这个设置就行。&lt;/p&gt;
&lt;h3&gt;Code Runner&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/6f4fbf287fa23b7fccd92a108843be15/2dc60/DraggedImage-6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABYUlEQVQoz12SSXLjMAxFdZVeRLJoWdFIUvNkOUl7iO2Vl6lK3/8KryGluyqVxSuQKAj4H5TjbXLUVuMrTdP9ph9O2HImSVtM3pBmHcGuRCmL7xtcqf8iw/Uynr6x5JwsjPg8/OLSBFT9la4/UrVvlOXEXFfU5YgpD2i7J047oqTlOW7W+J8lvxCEFU6wM8SRIQyNKHsl0xOen7PZWlxV4CkjZ4MvdxUUqJ0Q/Dv/YCO1TqZHCnuQSd06+TlqxZrF8zQbz3zh2pU158pdrC8ff8fztazO4kSyKz2fsfVBVFaoWNSkBpVJzGS3Ep+KFNemqESa6lxU67XBTxYXTmoGto8H5fDG1B2xx5HkUpPeaqJbSXZv8P8k+B8J+tyzexiCtJThNWHUEIuzhWWXq+VcLO+7E600a/sTXXtiGq4M3TuTPNI83tk3N+b2zti/M7ZX+RPODNNF6o8U1Qtl/bLGReFficTkTTU9spYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 6&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/6f4fbf287fa23b7fccd92a108843be15/42603/DraggedImage-6.png&quot;
        srcset=&quot;/blogs/static/6f4fbf287fa23b7fccd92a108843be15/f931c/DraggedImage-6.png 200w,
/blogs/static/6f4fbf287fa23b7fccd92a108843be15/e8031/DraggedImage-6.png 400w,
/blogs/static/6f4fbf287fa23b7fccd92a108843be15/42603/DraggedImage-6.png 800w,
/blogs/static/6f4fbf287fa23b7fccd92a108843be15/5b8b9/DraggedImage-6.png 1200w,
/blogs/static/6f4fbf287fa23b7fccd92a108843be15/c7ea5/DraggedImage-6.png 1600w,
/blogs/static/6f4fbf287fa23b7fccd92a108843be15/2dc60/DraggedImage-6.png 2280w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
这个插件的功能是通过调用的系统的二进制文件，来直接运行代码，类似于 IDE 中的编译运行。不过在真正使用之前还需要稍微配置一下，在用户设置中搜索，&lt;code class=&quot;language-text&quot;&gt;code-runner&lt;/code&gt;，可以看到搜索出来的结果。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/705799511d2df6c9957faea510f32273/0fd3b/DraggedImage-7.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 67.37481031866464%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+UlEQVQ4y3VT2XLaQBDkY1KgPSVk0IkkhDlsoJAdJ04MyUNSlZT//wc6M4sQGMcPrVmtpN6Z7lZvICKEyQpZ/Yi0ajBK76DDGcx4ATOaw7bVIZgiCBewwQzKlg7SFPBkDObh2ut7Y5SrL9h+/YXN82/U62fIUQ2TrqDjOWHRrY0tcDMkQr/qCE7oCN2GiCFkCs/jmkCqHEIkUFSlzOh5Qi+n6HsRPg1uwE14RDC4wInUdVhvX/BweEXz4xWLh58wyRJ+sUUwbeBXO5hhhSgtEWcFYYJwlLedRe875IUyOelSwvgFNEGoFIL2hJlA2gmEzmgvohofoVoS+XbsjjCrG8y3e9xuXlDMn2CiFWxYw6fOFOkmiXhwNaLrSMTvtOwNaOSouEe5/EzmPCGpNpBhBalT0pI/HLeIPjTiDSFfbFBhSLEIqKsgvKWxpy4SmuJh6V6Rq6wjy/E/kssDnCnT9Tc0+z/YHf5i3hyg0yV0wnFZwpZbZxJ3q0ziHH7b9Xl9jg1FRWgSX2UuHlLn9PFRO9bwtObnXDvwe23A2UjXIV80jRyMKbx+2b3s/gJ7JJStMVIzIblPREwm9PkATyWXOfyOR8pgwyPv9lD8V+T3sJP1cfT8DjIoEPoz+KRv3xtduH01Mi/YUW1zB2UyyteV4HQ6R+QjMy5N+Qe1ZaA93w9peAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 7&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/705799511d2df6c9957faea510f32273/42603/DraggedImage-7.png&quot;
        srcset=&quot;/blogs/static/705799511d2df6c9957faea510f32273/f931c/DraggedImage-7.png 200w,
/blogs/static/705799511d2df6c9957faea510f32273/e8031/DraggedImage-7.png 400w,
/blogs/static/705799511d2df6c9957faea510f32273/42603/DraggedImage-7.png 800w,
/blogs/static/705799511d2df6c9957faea510f32273/5b8b9/DraggedImage-7.png 1200w,
/blogs/static/705799511d2df6c9957faea510f32273/0fd3b/DraggedImage-7.png 1318w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
有很多的配置，可能很让人头大，但是先别慌，找几个我们要用的就行。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;clearPreviousOutPut&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;runInTerminal&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;saveFileBeforeRun&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;saveAllFilesBeforeRun&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;第一个的意思就是每次运行会清楚之前的输入，看个人喜好吧，我是觉得清楚一下会更好。第二个就是在自己系统的终端中运行这个，好处是可以直接打通我们&lt;strong&gt;心爱的终端&lt;/strong&gt;，而且如果不配置这个的话，Window 会出现一些奇怪的问题，强烈推荐。&lt;/p&gt;
&lt;p&gt;第三个的意思是，运行之前保存当前文件和运行之前保存所有文件，自己选择一个设置为 True 就行。为什么需要这个？因为我们经常会碰到写完代码就去运行，但是发现自己忘记保存的情况，结果还是之前的结果。JS 的通过 node 来运行的，在我们安装后这个插件并重启后，新建一个 js 文件。比如像我下面是一个生成 HTML 模板的代码,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`
  &amp;lt;section&gt;
	&amp;lt;h1&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;title&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/h1&gt;
	&amp;lt;article&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;content&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/article&gt;
  &amp;lt;/section&gt;
`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; config &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; title&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;I can run js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; article&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Very Cool!&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; title&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;I can run everything&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; article&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Really Cool!&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; theHtml &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; config
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; title&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;theHtml&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;之后点击右上角的的这个播放键
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/ce984e911a270f3bb175a39451ef4564/d6195/DraggedImage-8.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 274px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 30.656934306569344%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABCUlEQVQY021Py07CUBDtB/ji1dLHbW/bW9AE2EhofECqYeGWFbLQvbjgJ0iIid9AjD96nBlaguhicu+cmTkPS8c9HFac9HGMHc+TdEDv/3PL81McVtuN6TXlPylxA9fbzRtNhVrdL/fSP2XxgMtpa7TsEJHuotlSgqmwQ1gkuOslguX5BA+PT+TwSm4Ys51o/7d4kZkvai7W6w9st98wWR8npzZmszn1X+h0ByIS6UssFq9Yvq9wPbwjtwHt9lAUUxK6F9FfhG/LFTabTwQqQ73h4+a2wPz5hXojDlSYYZSPMZ5MRYSd+YERt5xMCKvI3DApE/Eii3DUs3NHyKrIjDNJdbOLrPeRfwAJpa1tzqQn8QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 8&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/ce984e911a270f3bb175a39451ef4564/d6195/DraggedImage-8.png&quot;
        srcset=&quot;/blogs/static/ce984e911a270f3bb175a39451ef4564/2649b/DraggedImage-8.png 200w,
/blogs/static/ce984e911a270f3bb175a39451ef4564/d6195/DraggedImage-8.png 274w&quot;
        sizes=&quot;(max-width: 274px) 100vw, 274px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
就能看到 &lt;code class=&quot;language-text&quot;&gt;console.log&lt;/code&gt; 的结果被打印出来。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/701358a41d5df7b22b23a24cc6fc90f2/3debb/DraggedImage-9.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 40.899795501022496%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6klEQVQoz42S/W6CQBDEeZmqiCJB8bgDVL5Bjaa1ff9Hme6uQkxr4v0xTC63O7v8wJnNFRZ+guUqITeYzCJ8TDeku/N56m5Hcf3gr+TwZWxq9KcflNUV27gkVYhUCZO2WG8OUuh66m3YGBiEOxQUdsjP2OcnpLseSdYh2x+hTUMDGxnqLY1d4DrKpUHpGn6Q/mtyvVhktSE/5gs9NjGzv2KeA0srhkpXKOurvKIfZLLlijwkfrw9e/hg+S7U4cnMsO1v8lGa7gttdyOWZ3THb2J7kbu6+RSWVgwjVcAkLTSJN3wueP5dbDj+AkhF/jZF4GUxAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 9&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/701358a41d5df7b22b23a24cc6fc90f2/42603/DraggedImage-9.png&quot;
        srcset=&quot;/blogs/static/701358a41d5df7b22b23a24cc6fc90f2/f931c/DraggedImage-9.png 200w,
/blogs/static/701358a41d5df7b22b23a24cc6fc90f2/e8031/DraggedImage-9.png 400w,
/blogs/static/701358a41d5df7b22b23a24cc6fc90f2/42603/DraggedImage-9.png 800w,
/blogs/static/701358a41d5df7b22b23a24cc6fc90f2/3debb/DraggedImage-9.png 978w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Code Runner 不仅仅支持 JS。我们需要这个功能可能是为了学习新语法，也可能是测试某个算法。显然使用 node REPL 或者在浏览器的 console 里写一大串代码是一个很愚蠢的行为。&lt;/p&gt;
&lt;h3&gt;Prettier&lt;/h3&gt;
&lt;p&gt;这个是最近一年最火的格式化工具，能够将你写成 💩 一样的 JS 也能格式成十分漂亮的代码（前提是没有语法没错）。同时也支持 HTML，CSS，JSON，Markdown 等等文件。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/634a2/DraggedImage-10.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 17.74622892635315%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAm0lEQVQY04WOyw6CMBRE+Q7XYosmItD20kRoKXRBeOjO//+SsZCoC6Mszl1MZk5uxFNCZQe4dkZV93DdjNbfYZsBmgy0diDtcb5ckZxKsESBH+knUVoamCAbpwesmwIjmvYGUjWMLFAKDUEdsrxepZvCXTiFdJDk3yHjEnu2QIi5QswEDiF7yf5Jo1xYLAjVIM2qdfgpfA+3PnwC6Ep/buwtrhMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 10&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/42603/DraggedImage-10.png&quot;
        srcset=&quot;/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/f931c/DraggedImage-10.png 200w,
/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/e8031/DraggedImage-10.png 400w,
/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/42603/DraggedImage-10.png 800w,
/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/5b8b9/DraggedImage-10.png 1200w,
/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/c7ea5/DraggedImage-10.png 1600w,
/blogs/static/ec5e2d1128d5525805b70ec49d5bd3f4/634a2/DraggedImage-10.png 2254w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
为了体现它的强大，我们需要去改一些配置。和之前一样，在设置中搜索 &lt;code class=&quot;language-text&quot;&gt;format&lt;/code&gt;，找到&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;editor.foramtOnPaste&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;editor.formatOnSave&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;editor.formatOnType&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;解释已经有中文了，全部设置为 true 就行。至于开启它们的效果，只能自己去好好体会了。&lt;strong&gt;写一点缩进比较烂的代码，接着保存，所有的代码就被格式化了。&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;不需要配置的插件&lt;/p&gt;
&lt;h3&gt;Bracket Pair Colorizer&lt;/h3&gt;
&lt;p&gt;如果仅仅看它的介绍的话，这个插件是一个会将你的 &lt;code class=&quot;language-text&quot;&gt;([{}])&lt;/code&gt; 这些使用不同的颜色区分出来，提升鉴别度。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/b9913877db7acc2c61cdb0f6bb6ddf86/23728/DraggedImage-11.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 374px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 24.598930481283425%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABGklEQVQY00WQ20oDMRiE+yKWIthD2u4hm+4p2123rLWtUK0iKKg3injtRb0QLH0CfePPZF31YpjM/2cmQ1q9QUi3P8FyX0Q11xBW23PU7Jq50faexVFvYqD+fJZbQyfDCwoGo5husxRDYzDGrsFg+B8qRNxoW0IhVYEKy7rQ7yMtqUpWm5QqXuHF5+SlJJcpaXiFOq4o0hFl7uEXa7R7RqUD4rLEcxZ8bHe8bt9odxyEKVQH+jJjfR2yijYExR2zE5+pm5El96SLJTMtWFYOcn6Ddi441Qq9nCO9Sz73X7zv9hy0xyYw+W1YUS1Siqliony0dk0rDx2FhHFArsfoxCWKFVMzK7RDkvgo3+Xl+ZbHpwc6h775ip+G3+n6pYV/nPSYAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 11&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/b9913877db7acc2c61cdb0f6bb6ddf86/23728/DraggedImage-11.png&quot;
        srcset=&quot;/blogs/static/b9913877db7acc2c61cdb0f6bb6ddf86/80b0e/DraggedImage-11.png 200w,
/blogs/static/b9913877db7acc2c61cdb0f6bb6ddf86/23728/DraggedImage-11.png 374w&quot;
        sizes=&quot;(max-width: 374px) 100vw, 374px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
可以看到这些括号都是彩色的。当然如果仅仅只是这么一个花哨的功能的话，对编码幸福感提升不大。其实我最看重的是它的&lt;strong&gt;范围高亮功能&lt;/strong&gt;，嗯这个名字是我乱取的。就像这样：
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/1ce670f817f4157b59c32b142b47fd99/50a2d/DraggedImage-12.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 448px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 54.46428571428571%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB/ElEQVQoz4WS2W7aYBCFeZU0gPd4+b0vgE0CxrEbSlOUplJVqe//DF/HJkRqL5qL0Wg84zPnnPln9l2J41YsrYQbLeBGD/ikK+ZGiGbE3C4UN7c+86V6qwOWWsTSiNDMGC8oMex06ulmwswwU3QrpVItBzXQh0d2qqf2WkwnZ9MMtN23t3imPTyjkgZlVVhmyelcsa7302LDGgEFTJPYRHuOyUAXd7TRgY3XCPOEZtvx2J+omwNFec/rj19U670AZriycPhSUK52E6BmCKAlkl2vJIx8NMcmDXL8ICTKUtI0I8+LKQfyzbFdfN9ney91GKBCRVml+Cqb5Lp+xmypx5hWKIOKWy0RqQO+W7Nrv/I4vHDozvRPr3x+/I5vrpjLfLOrcbyc+mHDz98d/XGLG2TCdstspGnZkTAQs8VYxy4YfbWcbAr7LscU05d6NLEYfXLcdMrXuB5kOsoV0PNGhhGN36P8mvv9kX17ouvPDE8vtLsTriHL7ITD0EyMqs2K84/dVN95GW3fXAANK6bIAxkO8ay1WJDhqRVxuhV/1oRy1Tje4pg5C1nqq1zYi3dhTrleEUSjigQVF8x0eUuakfPQKlb1RmRfJIwSF1r4nse4Sht9v8zEzBdj/1KP+R2weYhFprw9q/jLk3/jf703D2VAWDleMR3hox8+ij8JNmPJg7XnEQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 12&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/1ce670f817f4157b59c32b142b47fd99/50a2d/DraggedImage-12.png&quot;
        srcset=&quot;/blogs/static/1ce670f817f4157b59c32b142b47fd99/fd10f/DraggedImage-12.png 200w,
/blogs/static/1ce670f817f4157b59c32b142b47fd99/00869/DraggedImage-12.png 400w,
/blogs/static/1ce670f817f4157b59c32b142b47fd99/50a2d/DraggedImage-12.png 448w&quot;
        sizes=&quot;(max-width: 448px) 100vw, 448px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
注意到了吗，这对 &lt;code class=&quot;language-text&quot;&gt;[]&lt;/code&gt; 之间是一条折线，来表明这个括号所表示的范围。这个功能在较长代码和嵌套的时候，特别有用。&lt;/p&gt;
&lt;h3&gt;Auto Close Tag&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/f042e1918db50d4f0fe60e49be37b59f/1274e/DraggedImage-13.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 498px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 30.120481927710845%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFklEQVQY021RXW+CUAzlX2wRZQgIiApixCmgfAioLJvLsk2XbPFxe9r/fzujFROy7aHpaW972nMrdJURFNWGqtnQeg4McwLKqZoD3XAZ/2eK+jcnd4cQerqL55d3vB4+sCufcDyecHw7IcvvsX88MHYnIWa3CayBh5ZooCP1IbYNSDcW43bHhCQPmFTQqk2CMEe4LLDw11iuCsRJiSjeMtFmu+f3+SJFur6DH2RshEf2HN4s4j4axhuqNSEREUmSlhzHya4esGGCqbdCUHmK6Z0IaSDV5MUD9zIh/d/UizB2g6ow46KWqFeSzEqOxZ4knWWaddxn6ST56lqD7fj4/Ppm2cLlKE275Jr+9zGa+fNBx5CVIX4AxXa8vu9ewe0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 13&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/f042e1918db50d4f0fe60e49be37b59f/1274e/DraggedImage-13.png&quot;
        srcset=&quot;/blogs/static/f042e1918db50d4f0fe60e49be37b59f/8a03d/DraggedImage-13.png 200w,
/blogs/static/f042e1918db50d4f0fe60e49be37b59f/61462/DraggedImage-13.png 400w,
/blogs/static/f042e1918db50d4f0fe60e49be37b59f/1274e/DraggedImage-13.png 498w&quot;
        sizes=&quot;(max-width: 498px) 100vw, 498px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这个不解释了，就是自动帮你填充对应的 Tag。如果你对 emmet 用的很熟练的话，这个插件可能出场率不高。&lt;/p&gt;
&lt;h3&gt;Auto Rename Tag&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/d9451876d2a67a0beb4a8ad48cf93f0a/81941/DraggedImage-14.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 25.718608169440245%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABBElEQVQY012Qy26DMBBF+RkCxYHQAOZtysuhNBClTcmiVaWuK3Xfr78dW6WLLK5G8thnztiw7jhMK/xLhDjtUbczmu5EdUJVHylPSPIBftQhTCTCuEUQ1Qh5gyTr4e8FNjaH7cQweDWjnd4ghitMOhQPIy6vH+gPZwzjC47TgkY+Y5YdpjLA3OQQRYuaBpbVo4Z5fgElpoHZYcHl8xvvXz9wyWBHTWWppkdkkuaSLCTSuEISZnCdPRzG4e4KMDfVm60wVQ0WNFDhYoLtlcjLEXJYyO4K/17A2abYejkYxWYEsNXDmFaM/kErTBtaqkExN4G+xNxMA5SBuqT+RsW6AdyC1vwCGlCk0F5Y59kAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 14&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/d9451876d2a67a0beb4a8ad48cf93f0a/42603/DraggedImage-14.png&quot;
        srcset=&quot;/blogs/static/d9451876d2a67a0beb4a8ad48cf93f0a/f931c/DraggedImage-14.png 200w,
/blogs/static/d9451876d2a67a0beb4a8ad48cf93f0a/e8031/DraggedImage-14.png 400w,
/blogs/static/d9451876d2a67a0beb4a8ad48cf93f0a/42603/DraggedImage-14.png 800w,
/blogs/static/d9451876d2a67a0beb4a8ad48cf93f0a/5b8b9/DraggedImage-14.png 1200w,
/blogs/static/d9451876d2a67a0beb4a8ad48cf93f0a/81941/DraggedImage-14.png 1322w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;和上面一个算是兄弟插件吧。嗯，作者也是同一个人。作用很明显，自动帮你改对应的 tag！同样的，如果你的结构比较复杂的话，这个还是会有点小 bug 的话，不过在时间的节省上，这个插件显然是必装的。emmet 也提供了这个功能，搜索 &lt;code class=&quot;language-text&quot;&gt;emmet: update tag&lt;/code&gt;，这个功能的稳定性应该会高于这个插件，但是要主动去设置快捷键。&lt;/p&gt;
&lt;h3&gt;HTML CSS Support&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/bdab489283bc25b9e8067114fcb87cbe/df553/DraggedImage-15.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 494px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 28.74493927125506%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKElEQVQY022Q6W6CUBBGeYrGpoJ7KogspgiICgIiuC+ljUaTJn3/Z/h6Z2yTJu2Pk8sMM3PPXClOVjgcz5hMF/BHCTbbEtGsYIJxKpgjjHKYlg9Vc6D3XbTaJhrN/h9q9R6kLNvitbwiLw5wvRl2+3fMRW61PuF6+8T58oHj6cIDCXsw5saq3IWsqAzFzZZxHzgVZmTnDEMk6RpRVLDpZJLB92ORjzCLlyiWR65J5xuOiTzfI1vs4DghKo8dYalDGgUpCE80D92IMUwffcPjU9Ve0NOHsOyA16XTHgTfxiNoPQf0bDSDrCUyICMqpFtoBfqh1DSG1iBk5R7/rEkx5R8qLbYv326ivw2JdqcBz92BMHFRb+hs1+5Y/P3f4/+G+umCp2qX678A2f+/3yFT44EAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 15&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/bdab489283bc25b9e8067114fcb87cbe/df553/DraggedImage-15.png&quot;
        srcset=&quot;/blogs/static/bdab489283bc25b9e8067114fcb87cbe/80f1f/DraggedImage-15.png 200w,
/blogs/static/bdab489283bc25b9e8067114fcb87cbe/d00a4/DraggedImage-15.png 400w,
/blogs/static/bdab489283bc25b9e8067114fcb87cbe/df553/DraggedImage-15.png 494w&quot;
        sizes=&quot;(max-width: 494px) 100vw, 494px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;刚写前端的时候，或者为了方便，我们偶尔会把 CSS 写在 HTML 里，但是那样的话是没有直接创建 &lt;code class=&quot;language-text&quot;&gt;.css&lt;/code&gt; 文件强大的自动补全特性的，这个插件让一切都回来了。&lt;/p&gt;
&lt;h3&gt;Settings Sync&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/ecd09958faef608f6794cac3bc5e6d9f/df553/DraggedImage-16.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 494px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 27.530364372469634%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABIklEQVQY04VRXW+CQBDkZ7RJ/RYFUUDAD0TBShXUFKtpbfug2DTQh/7/5+ntNiRN06QPk53du53b2ZNa7T7aisWoN3Q0ZRNyq49G0xDR5FqBWr33L6Qs/8Tp9I7L2wdywR/2LzinGdJLhvXmAK07hDddoqePUa5oKJVVgY7gHeaVqsacwILuJIRuuHAGAfwggu3MBPcxHM0ZtuNz3u2N0GpbGAwDGOI+5X1rCnJo2VOY5oRFpXi9Z6HlKhExxu1ig1W046lWUcJT0p3j85kfXYRbJLsj9odX3CdPmPmREPa4V1EdSME8xsS740lIhDjt8aetwlq11kWJa99nNyWVbV5dy0jTHNvtIyTaEe1HUW0UnD6Emn8v/K8agcTHbghD2P4CPTnAPjJJMqEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 16&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/ecd09958faef608f6794cac3bc5e6d9f/df553/DraggedImage-16.png&quot;
        srcset=&quot;/blogs/static/ecd09958faef608f6794cac3bc5e6d9f/80f1f/DraggedImage-16.png 200w,
/blogs/static/ecd09958faef608f6794cac3bc5e6d9f/d00a4/DraggedImage-16.png 400w,
/blogs/static/ecd09958faef608f6794cac3bc5e6d9f/df553/DraggedImage-16.png 494w&quot;
        sizes=&quot;(max-width: 494px) 100vw, 494px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;同步你在 VSCode 中的所有设置和下载过的插件，Snippet，快捷键绑定。对于有多台电脑的朋友，这个插件是必备的。不过它是基于 &lt;strong&gt;gist&lt;/strong&gt; 来保存你的配置，而这个在国内需要翻墙… 同时这个插件第一次设置的也比较繁琐，需要一定的耐心。总的来说，当你必须换一台电脑的时候，一定要花点时间到这个插件上。可以节省你大量的时间！&lt;/p&gt;
&lt;h3&gt;Path Intellisense&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/b1189f788c88c0ba1841df121e97482b/12556/DraggedImage-17.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 492px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 23.17073170731707%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/ElEQVQY021Q226CUBA8P9KKXHpTrhZKQbwA1VoQYykkFXlo/f9vmJ7dxKQmPkxmdzY7Z86KQ/eDY3/CZrPH/vMb3B9PaNse1a5FI3kySeC4MVwvhqpZGCgjhjIcX2ComhDTZIU0KxAEC+YsLzGfvyN/22KZfmC13sF2IphWyKbGnQvdcHD/4DHTA7phS91hU0EmZ6MziqJGGC4RxTkbVlWLNC1QbhvUXx2S2ZrTF2XNu1STRuaCll6jjBG8LODLpFST/uzPoOk2J6A0lO5p5HMSVTPlzGKd+kP3y3vC9abw5I08yWRG36OezGn2/1YDZXz1dje3j2iannf+AH/UpmdHImN4AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 17&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/b1189f788c88c0ba1841df121e97482b/12556/DraggedImage-17.png&quot;
        srcset=&quot;/blogs/static/b1189f788c88c0ba1841df121e97482b/60e82/DraggedImage-17.png 200w,
/blogs/static/b1189f788c88c0ba1841df121e97482b/2f516/DraggedImage-17.png 400w,
/blogs/static/b1189f788c88c0ba1841df121e97482b/12556/DraggedImage-17.png 492w&quot;
        sizes=&quot;(max-width: 492px) 100vw, 492px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;提供 URL 的自动补全功能，这个必须装吧。支持任何语言，触发条件一般是在一对引号中，输入 &lt;code class=&quot;language-text&quot;&gt;./&lt;/code&gt; ，&lt;code class=&quot;language-text&quot;&gt;../&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt; 这些表示路径的前缀，就会跳出来了。像我们的 JS，HTML 中引用文件，CSS 中 &lt;code class=&quot;language-text&quot;&gt;url&lt;/code&gt; 就再也不用担心了。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/6c313d49f82f3cd880af2fb5d5804df8/e4e5b/DraggedImage-18.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 77.44186046511628%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACP0lEQVQ4y5WTS2/TQBSF/UNImpft2E6cOI4fk/iZd5MgnlLbVEIs2CCEWEARLApCSGz4A0iIBVsW/MXDvRMSkjaqyuLEo1Hm87lnjhWrGcFu9+B6EVrthNb/r4YdoW760A0fimGFqGldiP4Ui+UZhpNz5KNTZMMTWq8wGG90dlD8/yh98A9YNwNodR+dTowgyBElM8SkNJtD011Uqm1UVQcqrQ9Kc6HXPTBHNwIoOpFVvYuOGxEwgR9k6HoJRG+AUORy326FKFeaOCpZKJUt+dxdV2o2dOnQg2JaAoZJGboE82NE8QT9aIwgHBAsJphAoxlI4CGVyg3UaAKr0Ydl9aGEYoFmM4Xj8MiphG1cVmstFIomikfW9jDrKlAloG0nxEmgOG4GvhiGhGEqHQkxIIc5mna4BVwF7QL5xTyuxiNPjx9iOL6PNJ3BaQv0+iOqj7jm5kag2paXwlK6PmXl5dIVO+S8WtTLOwVDBl4oGnsj3wSUteEfVfckxPf5lnN4fganQ2U1XLjdBKbl3cqhBI4mNG6+/JthhsFwicn0Hoaj9R5nyWB2e8jlNeDs+BHidE6gBQJyKCjDLJ/LyjBM0x15kIMvlW/pMBvcpa9jQtVZXwqPyeIKcbFDytftxpSluVefjfhlW6Dj5mh3MpmdEJmEcAc9f93JmtqShypVW8Iq1X3xXm3X4ctXl7j8+BWvLz7h+Yu3ePrkDb6sfuPD+U+8O/2O9yc/cPH4Gz6vfmEZPUNZs+nLWh9ey5PPDfAPWPbe9FbFj7sAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 18&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/6c313d49f82f3cd880af2fb5d5804df8/42603/DraggedImage-18.png&quot;
        srcset=&quot;/blogs/static/6c313d49f82f3cd880af2fb5d5804df8/f931c/DraggedImage-18.png 200w,
/blogs/static/6c313d49f82f3cd880af2fb5d5804df8/e8031/DraggedImage-18.png 400w,
/blogs/static/6c313d49f82f3cd880af2fb5d5804df8/42603/DraggedImage-18.png 800w,
/blogs/static/6c313d49f82f3cd880af2fb5d5804df8/e4e5b/DraggedImage-18.png 860w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;CSS Peak&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/12c38/DraggedImage-19.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 16.063548102383056%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAr0lEQVQI10WP226DMBAF+ZcQAsQxmEuIbUxIHGiVqlL7/x8ztf3Sh9HsSnuOtJlsLcv6hWgsZv7Aup22c/TjE33z9MpwqsbAleNpoCjHRJwPR8Uhb8mDi7InLzqy1b9RSvHavvHbD9v+izY7ev7E6jtPY5j0i3HyyGZGto4mEN12C41yVOcbZT0lsuG64hbP/fEOoY1ueKSD80VTXwyVMNRCp11IE/yPkDY5FsUPIn/bVmCqfkKFTAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 19&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/42603/DraggedImage-19.png&quot;
        srcset=&quot;/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/f931c/DraggedImage-19.png 200w,
/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/e8031/DraggedImage-19.png 400w,
/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/42603/DraggedImage-19.png 800w,
/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/5b8b9/DraggedImage-19.png 1200w,
/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/c7ea5/DraggedImage-19.png 1600w,
/blogs/static/0b0cbd23a4236f22f6570d41b569f6cc/12c38/DraggedImage-19.png 2266w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这插件的功能就是在我们看到 HTML 或者 JSX 等代码中，如果出现了 &lt;code class=&quot;language-text&quot;&gt;class/className&lt;/code&gt; 的话，可以通过 &lt;code class=&quot;language-text&quot;&gt;Cmd/Ctrl&lt;/code&gt; ➕ 左键点击某个 class 直接跳转到对应 CSS 的定义。非常方便，但是&lt;strong&gt;并不是每个时候都有用&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;Live Server&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/6c73592240d9ad5c9ac39239dca439c8/12c38/DraggedImage-20.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 18.00529567519859%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtElEQVQY031PPQ+CMBTkzyhtwSZYKKVQkW+ixrg4uDm5+v+ns5SwYHS4XF7e3bt7HgsUWJBBFz3a7oZM94hlDZlWSEQORmNQqyEshU8lNn7s+Be8p//GQ71wqE8YL3dU7RWmPMMUDQaTo9SFDRuhdAepWkSiRMi1M08ha3iKDFC8dyIyNtgfBwQsg2+XW8s01K7hBBYqBLt5Xg5+NZS2CRcGIqkg0ho8MtiSZDb8eW05tm74AcLIf/WW4UtBAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 20&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/6c73592240d9ad5c9ac39239dca439c8/42603/DraggedImage-20.png&quot;
        srcset=&quot;/blogs/static/6c73592240d9ad5c9ac39239dca439c8/f931c/DraggedImage-20.png 200w,
/blogs/static/6c73592240d9ad5c9ac39239dca439c8/e8031/DraggedImage-20.png 400w,
/blogs/static/6c73592240d9ad5c9ac39239dca439c8/42603/DraggedImage-20.png 800w,
/blogs/static/6c73592240d9ad5c9ac39239dca439c8/5b8b9/DraggedImage-20.png 1200w,
/blogs/static/6c73592240d9ad5c9ac39239dca439c8/c7ea5/DraggedImage-20.png 1600w,
/blogs/static/6c73592240d9ad5c9ac39239dca439c8/12c38/DraggedImage-20.png 2266w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这是一个神器，如果你还不会使用 &lt;code class=&quot;language-text&quot;&gt;webpack 或者 parcel&lt;/code&gt; 的话。它提供了自动保存文件后自动刷新的功能。虽然这个功能看上去并不是很起眼，和 &lt;code class=&quot;language-text&quot;&gt;browser-sync&lt;/code&gt; 似乎也差不多，但它能内置到 VSCode 中就大大简化了操作。&lt;/p&gt;
&lt;p&gt;对于刚写前端的朋友有一个很重要的问题，他们往往喜欢直接通过浏览器打开某个 HTML 文件，在浏览器顶部会显示这个 URL 是 &lt;strong&gt;file&lt;/strong&gt; 开头的。file 也算是一个协议，和我们知道的 HTTP 协议一样。如果直接通过 file 来打开 HTML 的话，很多 JS 的功能是不能实现的。比如：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Web Worker&lt;/li&gt;
&lt;li&gt;Service Worker&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;script type=&amp;quot;module&amp;quot; src=&amp;quot;&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;cors&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;通过使用这个插件，就再也不用担心这个问题。使用方式也很简单，安装好后，点击需要的启动的 HTML 文件中底部 tab 的&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/c755ad342baefc7ad5f4e6d46b13e721/642f1/DraggedImage-21.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 200px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFUlEQVQY012PW0+DQBCF9zeovUGBgqXAghZMKNTWKrWKxtZb+qCJTWrik8aXxqTx1x/ZoZiWhy9nZnbP2R1m8xhlHFdotNG8L9dFb7u7Xqa1OMrIigXd8NDMVN30qubQmapxqqnX3ZwtL6vVWyioN3QcVBR0/R4eHueI4jNUqioc7kOSDaqFNpU2sbcv0/1qTcu8eQZrSAYEknxIqqgmXl4XWK1+sHz/oHChb4slLie3SMYpwt4Q0+kTrq7v8Pn1DdvxKUxkMJG+jXgx7p9jvf5F//QiW80iY3ozw2g0gR9ESJIUg+GYwmf3z9mq9v9PGXcD7MADWjEMB3C9E1h2F072A7PjUS0Q8451jLbpZfMjul/4/wBiW7a82rlvXwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 21&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/c755ad342baefc7ad5f4e6d46b13e721/642f1/DraggedImage-21.png&quot;
        srcset=&quot;/blogs/static/c755ad342baefc7ad5f4e6d46b13e721/642f1/DraggedImage-21.png 200w&quot;
        sizes=&quot;(max-width: 200px) 100vw, 200px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在短暂的等待后，就会自动打开你的默认浏览器跳入由该插件启动的服务器。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/540d5a716800cdbfda68f156e6800d98/b26d0/DraggedImage-22.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 434px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 12.903225806451612%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAjElEQVQI1z2PbQqGIBCEu/+JejuAv4IOkGHhAULyI02dl1ko4WF31mWYHZ7nwXVdcM4hxiiklJBzxn3fUkkp5aP3jtaa9LVW0IOabzjPE9P0wzzPUEphHEcsywJjjKC1xrqu2Pcd27aJPo4D1lqpr2YIMaQ7TZmMKQkTMx1nIQTBe//1/KemCTX33mv+zFPjHMAoO0QAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;DraggedImage 22&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/540d5a716800cdbfda68f156e6800d98/b26d0/DraggedImage-22.png&quot;
        srcset=&quot;/blogs/static/540d5a716800cdbfda68f156e6800d98/c8443/DraggedImage-22.png 200w,
/blogs/static/540d5a716800cdbfda68f156e6800d98/e096b/DraggedImage-22.png 400w,
/blogs/static/540d5a716800cdbfda68f156e6800d98/b26d0/DraggedImage-22.png 434w&quot;
        sizes=&quot;(max-width: 434px) 100vw, 434px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下次要进去的话，可以直接通过 &lt;code class=&quot;language-text&quot;&gt;localhost:5500&lt;/code&gt;进去。值得一提的是，这个插件仅仅只是一个很方便的功能，但不代表它很强大。需要更强大的开发流程还是需要考虑 parcel 或者 webpack。&lt;/p&gt;
&lt;h2&gt;更多&lt;/h2&gt;
&lt;p&gt;如果还想继续提升开发的幸福感，可以考虑学习&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://emmet.io&quot;&gt;Emmet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://code.visualstudio.com/docs/editor/codebasics&quot;&gt;VSCode 文档&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;谢谢阅读 🌚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[PureComponent Considered Harmful]]></title><description><![CDATA[这篇文章有点标题党, 其实主要要强调的是  到处使用 PureComponent 是不对的 . 和 Component…]]></description><link>https://github.com/thoamsy/blogs.git/PureComponent is harmful/PureComponent is harmful/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/PureComponent is harmful/PureComponent is harmful/</guid><pubDate>Mon, 21 May 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;这篇文章有点标题党, 其实主要要强调的是 &lt;strong&gt;到处使用 PureComponent 是不对的&lt;/strong&gt;.&lt;/p&gt;
&lt;h2&gt;和 Component 的区别&lt;/h2&gt;
&lt;p&gt;其实, &lt;code class=&quot;language-text&quot;&gt;PureComponent &amp;amp; Component&lt;/code&gt; 的区别不大, &lt;code class=&quot;language-text&quot;&gt;PureComponent&lt;/code&gt; 自己实现了 &lt;code class=&quot;language-text&quot;&gt;shouldComponentUpdate&lt;/code&gt; 方法, 大概的实现类似于&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;shouldComponentUpdate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nextProps&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nextState&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;shadowEquals&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nextProps&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;shadowEquals&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nextState&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;现在有一个能组件, 能在不需要更新的时候, 自动帮我们做出这个判断, 不是很好嘛?
先想象一个很常见的场景. 比如下面的界面&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/ea81edfa33b834ffe435293adf8025ba/761c9/88C8D2C2-A934-41FF-BAAE-830CB990718A.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 48.74696847210995%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABwklEQVQoz32STWsTURSG5wcJUopSsGvdKQjiwh+gQqxmIwguBEEoUjcKLhUUaiuIgkhiqmnSRa39CGRRpI4m00zVmDaZpjPJfD/eO5NJpoX6wjPn3Llz3nvPvaPU63VUVcU0TdrtDp7r4PR72H2L3VYTy+zSNTr0LZNY4RHEMwwxDCNCIfWZlOWBZrg0DIffVsgfCxGJ8l+mHMfIcbMXRmaESTUo8kWCtG3ZsKLts1bf43snoHYgFjBHqPsjvnUgGHglHkcM4wlPpBI3AKPnU/3ZYmVTR2tZOD6CEFvgDzaR9hi2nEwkeeAHUTa/pDN54x3npl5w6cEyrhccOqRUt3HLQ7twFKNdDgxfLu5w5vosFzOPOX//C7brp1pM16TOUMoXh+H6kiCiPyh89rHGycwCk7dLnL1bxrK94YKeP4qJj5Ksdpx2uy7Fyg7FdY0Ntc3/NLwUqfzWHtMljUdLDWbK20wL3lf/kv+qM/d5i+cfqrxd1ilUmuRWdWaLNebKDV6VtnktatoHzuGW7+R+MP5kDSW7EHOzwIWnFXEZ84xl8pzOLnLiWp4rD1e5fC/H2NU3nLpVZHyqwET2E5viV5P6B2gB3foVNxhCAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;88C8D2C2 A934 41FF BAAE 830CB990718A&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/ea81edfa33b834ffe435293adf8025ba/42603/88C8D2C2-A934-41FF-BAAE-830CB990718A.png&quot;
        srcset=&quot;/blogs/static/ea81edfa33b834ffe435293adf8025ba/f931c/88C8D2C2-A934-41FF-BAAE-830CB990718A.png 200w,
/blogs/static/ea81edfa33b834ffe435293adf8025ba/e8031/88C8D2C2-A934-41FF-BAAE-830CB990718A.png 400w,
/blogs/static/ea81edfa33b834ffe435293adf8025ba/42603/88C8D2C2-A934-41FF-BAAE-830CB990718A.png 800w,
/blogs/static/ea81edfa33b834ffe435293adf8025ba/5b8b9/88C8D2C2-A934-41FF-BAAE-830CB990718A.png 1200w,
/blogs/static/ea81edfa33b834ffe435293adf8025ba/c7ea5/88C8D2C2-A934-41FF-BAAE-830CB990718A.png 1600w,
/blogs/static/ea81edfa33b834ffe435293adf8025ba/bc63a/88C8D2C2-A934-41FF-BAAE-830CB990718A.png 2400w,
/blogs/static/ea81edfa33b834ffe435293adf8025ba/761c9/88C8D2C2-A934-41FF-BAAE-830CB990718A.png 2474w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;假设上面的搜索框和下面的内容是&lt;strong&gt;同胞组件&lt;/strong&gt;, 理想情况下, 每一次修改输入框的值都会调用 &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;, 也就会导致整个页面重新渲染. 对于下面庞大的组件来说, 显然是很浪费的.
如果让下面的组件继承 PureComponent 的话, 很大程度的解决了这个问题.&lt;/p&gt;
&lt;h2&gt;shadowEquals 不是免费的&lt;/h2&gt;
&lt;p&gt;这仅仅只是 PureComponent 美好的一面，我们在享受这种美好的时候，很容易被忽略的它的副作用：&lt;strong&gt;每一次 setState 所有的组件都会进行一次 shadowEquals。&lt;/strong&gt;
换句话说，在期望它更新的时候，这些计算都是不可避免的。我做了一个 &lt;a href=&quot;https://codesandbox.io/s/v6y1m1yjk7&quot;&gt;demo&lt;/a&gt;，仅仅一个组件，它的 props 是一个有 3000 个字段的对象, 并且保证真正需要更新的 prop 会在最后才被比较到，将 shadowEquals 的优化完全抵销。&lt;/p&gt;
&lt;p&gt;可以看到，通过 &lt;code class=&quot;language-text&quot;&gt;componentDidUpdate&lt;/code&gt; 每次更新花在 shadowEquals 的时间, 在我的 16 年 13 寸 MacBook Pro 上平均每次需要花费 1.5ms. 当我尝试降低速度四倍的时候, 你猜怎么着? 平均花费的时间达到了 7ms. 可能你会觉得 7ms 似乎也不是多恐怖, 而且我这里是故意捏造了一个 3000 字段的对象.
不过, 在现实情况中, 大量的组件在一次 &lt;em&gt;reconciliation&lt;/em&gt; 后, 发生 re-render, 它们的 props 和 state 的字段长度之和应该有 3000 的数量级.&lt;/p&gt;
&lt;p&gt;再考虑下动画, 要达到 60FPS. 至少要求每一帧能在 17ms 之内运行完毕, 那么仅仅一个 &lt;code class=&quot;language-text&quot;&gt;showComponentUpdate&lt;/code&gt; 方法就会占据 7ms 的时间, 剩下的解析代码, 生成 V-DOM, DOM 的一系列更新操作要在 10ms 之内完成的话, 实在太难. 所以很容易出现动画掉帧的情况.&lt;/p&gt;
&lt;p&gt;这里还有几个佐证: Reactjs 团队的成员建议不要大量使用 PureComponent 的警告 ⚠️.
这个 &lt;a href=&quot;https://news.ycombinator.com/item?id=14418576&quot;&gt;hacknew&lt;/a&gt; 的帖子的作者, 发表了大致的观点:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;不要到处使用 PureComponent, 如果我们建议这种行为的话, 为什么不让这是默认选项呢?
那么 15.3 推出 PureComponent 的原因到底是什么呢?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/dan_abramov&quot;&gt;Dan Abramov&lt;/a&gt; 在 Github 中解释了这个原因&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We added a base class because we wanted an official way of marking component as compatible with shadow equality checks, with using mixins.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;下面是这段话的完整截图. 这段话具体出自哪个 issue 我并不清楚, 这个截图其实是由 Dan 在 Twitter 中发出来的. 这个&lt;a href=&quot;https://twitter.com/dan_abramov/status/759383530120110080&quot;&gt;推&lt;/a&gt;发布于 2016 年 6 月底&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/faad0289183eae0293db5dd94a588c91/23a2a/ConfSkDXEAAleG5.jpg-large.jpeg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 750px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 177.86666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAkABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHtXOFKEZosGBAX/8QAGxAAAgIDAQAAAAAAAAAAAAAAAREAEBIgITH/2gAIAQEAAQUCDfJiIfXRtdWv/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwFf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwFf/8QAGRAAAQUAAAAAAAAAAAAAAAAAARARMDFh/9oACAEBAAY/Ai4GJUv/xAAcEAACAQUBAAAAAAAAAAAAAAAAAREQITFBYXH/2gAIAQEAAT8hwQU7UNujOB4QnKISW6LA2dFWRHWRT//aAAwDAQACAAMAAAAQkwMAD8//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EF//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EF//xAAfEAEAAgICAgMAAAAAAAAAAAABABEhQTFRYXGRobH/2gAIAQEAAT8QQAKBGaVvrMOQpTznmJWudpECwfbKeb1KhfqZN3cK6R1GJQorcYOAdy3ZBgmS/pPZ+YY3P//Z&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;ConfSkDXEAAleG5 jpg large&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/faad0289183eae0293db5dd94a588c91/23a2a/ConfSkDXEAAleG5.jpg-large.jpeg&quot;
        srcset=&quot;/blogs/static/faad0289183eae0293db5dd94a588c91/8b5d6/ConfSkDXEAAleG5.jpg-large.jpeg 200w,
/blogs/static/faad0289183eae0293db5dd94a588c91/d6357/ConfSkDXEAAleG5.jpg-large.jpeg 400w,
/blogs/static/faad0289183eae0293db5dd94a588c91/23a2a/ConfSkDXEAAleG5.jpg-large.jpeg 750w&quot;
        sizes=&quot;(max-width: 750px) 100vw, 750px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;接着在 2017 年 1 月, Dan 又发了&lt;a href=&quot;https://twitter.com/dan_abramov/status/820668074223353858&quot;&gt;一条&lt;/a&gt; 来强调这个观点. 所以, 可以确定的是, &lt;strong&gt;任何地方都是用 PureComponent 被认为是有害的.&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;降低可读性&lt;/h2&gt;
&lt;p&gt;接下来, 还有一个问题. 比如平时有一个组件 &lt;code class=&quot;language-text&quot;&gt;Button&lt;/code&gt;, 我们想给它加一个 &lt;code class=&quot;language-text&quot;&gt;style&lt;/code&gt; prop, 如果仅仅只是加一个 &lt;code class=&quot;language-text&quot;&gt;margin&lt;/code&gt; 的话, 我们可能会这样写&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; marginTop&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;This is a Component&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这没有问题, 对于一个小小的需求, 这里用这种写法其实在性能上问题不大, 虽然 style 在每次 render 的时候都是一个新的对象, 但是其实没我们想象的那么糟糕. 因为在普通的 Component, 如果没有特殊处理 &lt;code class=&quot;language-text&quot;&gt;shouldComponentUpdate&lt;/code&gt; 的话, 这个组件肯定是会重新被 render, 生成一个 VDOM 的, 在 VDOM 转化为 DOM 的过程中, 因为 style 的内容没有变化, 所以最后不会更新 DOM, 这个操作的损耗并不大.
但是如果 Button 是 PureComponent 的话, 那么这样写的话每次都会带来一次无用的 &lt;code class=&quot;language-text&quot;&gt;shadowEquals&lt;/code&gt;. 所以要写成&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; style &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; marginTop&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;style&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;This is a PureComponent&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样的话, 确实会有一些好处. 因为 style 作为 props 没有变化, &lt;code class=&quot;language-text&quot;&gt;shouldComponentUpdate&lt;/code&gt; 会返回 false, 连 render 都不会发生, 在性能上&lt;strong&gt;可能&lt;/strong&gt;会有点提升. 可是每一次这种小小的变化, 都需要想一个名字, 作为一个常量真的不痛苦吗?&lt;/p&gt;
&lt;p&gt;这个例子可能还不够突出, 思考一下现在正火的 &lt;code class=&quot;language-text&quot;&gt;render props&lt;/code&gt;, 本来一个普通的 Component, 可以写成&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Link
	render&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;props &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;AnotherComponent&lt;/span&gt; &lt;span class=&quot;token spread&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;props&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但是如果 Link 是 PureComponent 的话, 要改成&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; props &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;AnotherComponent&lt;/span&gt; &lt;span class=&quot;token spread&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;props&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;render&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果是这样真的更好吗? 我们为什么要把一个 render 放在离 Link 那么远的地方? 这对于理解代码显然是不够的, 这让一个本来应该直观的 render 变得不那么直观.
在 React 文档的 &lt;a href=&quot;https://reactjs.org/docs/render-props.html#caveats&quot;&gt;render props&lt;/a&gt; 一章有对应的介绍.&lt;/p&gt;
&lt;h2&gt;结论&lt;/h2&gt;
&lt;p&gt;所以该在什么时候使用 PureComponent 呢? 一个通用的建议是: 在一个 List 有关或者 Form 相关的组件外部包一个 PureComponent, 这样可以起到不错的效果. 如果使用了 &lt;code class=&quot;language-text&quot;&gt;recompose&lt;/code&gt; 的话, 可以很容易完成这个任务 &lt;code class=&quot;language-text&quot;&gt;pure(&amp;lt;MyListComponent /&amp;gt;)&lt;/code&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[使用 lodash/fp]]></title><description><![CDATA[这篇文章主要是介绍 lodash 的  fp  模块, 通过它的特点来让 React 的   少写很多代码. 同样的原理也能放在 redux 的   上, 但是因为 lodash/fp 的缺陷, 这篇文章不会深入. 删除数组的某个值 开门先来一个例子.
假设我们的 state…]]></description><link>https://github.com/thoamsy/blogs.git/lodash-fp/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/lodash-fp/</guid><pubDate>Mon, 02 Apr 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;这篇文章主要是介绍 lodash 的 &lt;a href=&quot;https://github.com/lodash/lodash/wiki/FP-Guide&quot;&gt;fp&lt;/a&gt; 模块, 通过它的特点来让 React 的 &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; 少写很多代码. 同样的原理也能放在 redux 的 &lt;code class=&quot;language-text&quot;&gt;reducer&lt;/code&gt; 上, 但是因为 lodash/fp 的缺陷, 这篇文章不会深入.&lt;/p&gt;
&lt;h2&gt;删除数组的某个值&lt;/h2&gt;
&lt;p&gt;开门先来一个例子.
假设我们的 state 的结构是这样&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  posts&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1234567&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;abc&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;4343434&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;def&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;我们想删除特定的 id 的 post 话, 最原生的写法会是&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; posts &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	posts&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; posts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;post &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; post&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; postId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;使用普通的 lodash 会是&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; posts &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  posts&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;posts&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; postId&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样看起来, 普通的 lodash 并没有做多少事情, 只不过在 &lt;code class=&quot;language-text&quot;&gt;filter&lt;/code&gt; 的时候, 通过内置的 &lt;code class=&quot;language-text&quot;&gt;reject&lt;/code&gt; 少写了一些代码.
那么, 我们再看下 lodash/fp 的写法&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;posts&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; postId&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// or&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; rejectWithPostId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;posts&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; reject&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;propEq&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;rejectWithPostId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;postId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;从表面上看, 我们已经少写了很多重复的代码. 比如之前两个代码中都会出现三次的 &lt;code class=&quot;language-text&quot;&gt;posts&lt;/code&gt;, 在这里只出现了一次, 而且也没有嵌套和大括号的出现, 这明显能增加代码的可读性.&lt;/p&gt;
&lt;p&gt;而下面那个使用 compose 的方式, 虽然看上去总代码多了, 但是进一步提高了代码的复用性.&lt;/p&gt;
&lt;h2&gt;具体的解释在下文说明&lt;/h2&gt;
&lt;h2&gt;lodash/fp 的变化&lt;/h2&gt;
&lt;p&gt;那么这个模块和普通的 lodash 区别在哪呢？分为以下几点&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;都是纯函数&lt;/li&gt;
&lt;li&gt;参数的顺序调整&lt;/li&gt;
&lt;li&gt;iteratee 参数受限&lt;/li&gt;
&lt;li&gt;完全柯里化&lt;/li&gt;
&lt;li&gt;没有可选参数下面一一解释这几点&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Pure&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;都是纯函数&lt;/em&gt;这句话, 如果你稍微了解过函数式编程, 就知道它的意义何在.
我们看这个例子.
如果我们使用 lodash 的 &lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt;, 执行&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prevState&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prevState&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;posts[0]&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样的操作会修改 prevState 的, 肯定会导致的 bug 的出现. 当然这种用 set 的方式确实有点怪, 有点像强行捏造的出来的代码 🌝
但是如果用 lodash/fp 下的 &lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prevState&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&apos;posts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prevState&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这里没有用到柯里化的写法, 仅仅是为了变现 set 的 Pure 和参数顺序的调整.
另外, 你可以用 Jest 运行下面代码, 可以确定它是纯的, 这样也就保证了 setState 的正确性&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;The set function should be pure&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; res &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;posts[0]&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;posts&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;not&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;posts&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;not&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;posts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Rearranged Arguments&lt;/h3&gt;
&lt;p&gt;最显著的一点就是, 由 /data-first/ 变成了 /data-last/.
除了上面的 set, 还有 &lt;code class=&quot;language-text&quot;&gt;map, reduce, filter&lt;/code&gt; 都是这样.
&lt;code class=&quot;language-text&quot;&gt;map([1,2,3], a =&amp;gt; a * 2)&lt;/code&gt; 调整成了 &lt;code class=&quot;language-text&quot;&gt;map(a =&amp;gt; a * 2, [1,2,3])&lt;/code&gt;
这个调整目前看上去没有什么用, 等描述完柯里化后我们会继续对比&lt;/p&gt;
&lt;h3&gt;Capped Iteratee Arguments&lt;/h3&gt;
&lt;p&gt;将迭代器函数做限制, 主要是为了规避一些常见 bug&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// The `lodash/map` iteratee receives three arguments:&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// (value, index|key, collection)&lt;/span&gt;
_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;6&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;8&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;10&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; parseInt&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// ➜ [6, NaN, 2]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// The `lodash/fp/map` iteratee is capped at one argument:&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// (value)&lt;/span&gt;
fp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;parseInt&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;6&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;8&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;10&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// ➜ [6, 8, 10]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但是这似乎出现了问题, 我们在 React 中需要&lt;em&gt;更新&lt;/em&gt;某个数组内特定 index 的用法就用不了.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; posts &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	posts&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;good&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; post&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; posts&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;当然函数本来提升了一个方法 &lt;code class=&quot;language-text&quot;&gt;convert&lt;/code&gt;, 可以用来去除这个限制.
&lt;code class=&quot;language-text&quot;&gt;const mapWithIndex = map.convert({ cap: false })&lt;/code&gt;
之后再将 &lt;code class=&quot;language-text&quot;&gt;map&lt;/code&gt; 替换成 &lt;code class=&quot;language-text&quot;&gt;mapWithIndex&lt;/code&gt; 就行了.&lt;/p&gt;
&lt;p&gt;可是真的有必要这样做吗? 我们想一下, 难道 cap 仅仅只是为了减少这种 bug 吗? 在我看来还有一个原因, 我们应该使用更加 &lt;em&gt;functional&lt;/em&gt; 的方式来完成这个任务&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`posts[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;]`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;content&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;wow&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样看上去就十分清晰了. 不过, 有一点需要注意. 如果我们将 &lt;code class=&quot;language-text&quot;&gt;set(&amp;#39;content&amp;#39;, &amp;#39;wow&amp;#39;)&lt;/code&gt; 替换成 &lt;code class=&quot;language-text&quot;&gt;assign({ content: &amp;#39;wow&amp;#39; })&lt;/code&gt; 或者 &lt;code class=&quot;language-text&quot;&gt;merge&lt;/code&gt; 行不行呢?
恩这里是不行的, 同样的, 原因在后面再解释.
不过, lodash/fp 其实还提供了很多同名函数, &lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt; 的同名函数有 &lt;code class=&quot;language-text&quot;&gt;assoc&lt;/code&gt; 和 &lt;code class=&quot;language-text&quot;&gt;assocPath&lt;/code&gt;. 用法都一样, 不过在其他库中, 后面两个函数更为普遍.
&lt;code class=&quot;language-text&quot;&gt;assoc&lt;/code&gt; 的用法其实就是不嵌套的 &lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt;, 就像上面例子那样.
&lt;code class=&quot;language-text&quot;&gt;assocPath&lt;/code&gt; 则是需要深入某个路径里, 像 &lt;code class=&quot;language-text&quot;&gt;set(&amp;#39;a.b.c.d[0]&amp;#39;)&lt;/code&gt; 这种情况就应该用 &lt;code class=&quot;language-text&quot;&gt;assocPath&lt;/code&gt;.
Lodash 偷了懒, 没有在实现上区别它们. 不过它提供了一个 &lt;code class=&quot;language-text&quot;&gt;eslint-plugin-lodash-fp&lt;/code&gt; 来提供 lint 的支持, 帮助使用者加以限制.&lt;/p&gt;
&lt;h3&gt;Currying&lt;/h3&gt;
&lt;p&gt;终于到了重点咯. 先来解释下柯里化吧.
英文 /Currying/, 之所以这么叫是因为有一个数学家叫, &lt;a href=&quot;https://en.wikipedia.org/wiki/Haskell_Curry&quot;&gt;Haskell Curry&lt;/a&gt; , 他提出了一种化简高阶函数的方法, 所有后人就给这种方法命名为 Currying 咯. 我初学的时候, 一直没搞懂这是什么意思, 因为它的直译就是&lt;em&gt;咖喱&lt;/em&gt;(那个时候, 库里还没那么火)&lt;/p&gt;
&lt;p&gt;假设我们有一个函数, &lt;code class=&quot;language-text&quot;&gt;add&lt;/code&gt;. 通常的写法应该是 &lt;code class=&quot;language-text&quot;&gt;add(a, 10)&lt;/code&gt;, 说明我们给变量 a 加 10.
下一次我们要给变量 b 加 10, 就 &lt;code class=&quot;language-text&quot;&gt;add(b, 10)&lt;/code&gt;, 如果还有变量 C……
如果一个被柯里化过得 add, 就可以这样写 &lt;code class=&quot;language-text&quot;&gt;add(a, 10) add(a)(10), add(__, 10)(a), add(__)(a)(10)&lt;/code&gt;
你可能会问这样有什么用 0.0, 而且那个 &lt;code class=&quot;language-text&quot;&gt;__&lt;/code&gt; 是什么意思?
最简单的方式就是, 我们可以写出一个新的函数&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; addTen &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样的话, 要计算 a, b, c 只需要调用 &lt;code class=&quot;language-text&quot;&gt;addTen(a)&lt;/code&gt; 这样就行咯.
那么 &lt;code class=&quot;language-text&quot;&gt;__&lt;/code&gt; 呢? 官方的解释是:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The placeholder argument, which defaults to &lt;code class=&quot;language-text&quot;&gt;__&lt;/code&gt;, may be used to fill in method arguments in a different order. Placeholders are filled by the first available arguments of the curried returned function.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;什么意思, 我们举过一个例子. 上面的加法改成减法, 但是目的还是一样, 将一个数减 10.
想一想, 我们还能用 &lt;code class=&quot;language-text&quot;&gt;sub(10)&lt;/code&gt; 吗? 显然不行, 因为减法不是加法, 是不能交换的. 如果这样的话就会变成 10 - a 而不是 a - 10 咯.
这个时候就可以用到 &lt;code class=&quot;language-text&quot;&gt;__&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;const subTen = sub(__, 10)&lt;/code&gt;, 这样的话就能满足要求咯.
同时, 使用占位符, 上面的代码&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`posts[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;]`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;content&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;wow&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其实可以改成&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`posts[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;]`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;assign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; content&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;wow&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;所以之前的 &lt;code class=&quot;language-text&quot;&gt;assign&lt;/code&gt; 不行的原因是因为, lodash/fp 并没有调整它的顺序. 本来是后面的参数覆盖前面的参数, 这种很符合人类思考方式的习惯, 但是如果硬要交换的话, 反而就会看上去很奇怪.&lt;/p&gt;
&lt;p&gt;现在我们大概了解了柯里化的作用, 但是看上去效果还不是那么明显. 但是如果结合参数顺序的对调呢?
再看一个例子. 这个代码可能有点抽象, 有点长 :）&lt;a href=&quot;http://fr.umio.us/favoring-curry/&quot;&gt;例子来自一个 ramda 的教程&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;getIncompleteTaskSummaries&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;membername&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetchData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;tasks&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tasks &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tasks&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tasks &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tasks&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;complete&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tasks &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tasks&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; task &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;pick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
				task&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;priority&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;abbreviatedTasks &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;abbreviatedTask&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;我们先不管它的应用场景, 光看代码的话, 可以意识到, 这里写了太多重复的 tasks 了, 而这也是我们日常编程中的常见写法. tasks 作为中间变量, 需要不断地的传递.
我们剥离这里的 Promise, 改成这个样子&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;tasks&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;complete&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; task &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;pick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;task&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;priority&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;我稍微做了一点格式的调整, 但是这些整个思路就很明显了, 这不就是函数嵌套吗? 只不过可读性不是那么好 :-(, 我们根本不可能一眼看出来它是对哪个变量进行操作, 最先运行的函数又是哪个&lt;/p&gt;
&lt;p&gt;大学数学的离散数学里应该提高一个概念, &lt;em&gt;函数组合&lt;/em&gt;. &lt;em&gt;f(g(x)) = f • g&lt;/em&gt; 所以上面的写法如果可以改为 &lt;em&gt;sortBy • map • reject • filter • get&lt;/em&gt; 这种形式的话, 看上去应该会简单很多啦, 那么我们可以做到吗? 尝试下 &lt;code class=&quot;language-text&quot;&gt;compose&lt;/code&gt; 函数.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;pick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;priority&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;complete&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;tasks&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// 不要运行这段函数&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其实这样看上去已经好多了不是吗? 至少我们一眼就能看出来, 我们的逻辑顺序了.
至于为什么这么多 &lt;code class=&quot;language-text&quot;&gt;__&lt;/code&gt;, 那是因为它们都是 data 被处理后的结果, 也就是上面提到的中间变量. 所以我们仅仅只需要调整函数参数的顺序, 就可以省去这些占位符.
变成&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;pick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;dueDate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;priority&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;complete&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;tasks&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这就是参数需要调整顺序的原因啦.&lt;/p&gt;
&lt;p&gt;再解释一下柯里化在这里的重要性. 如果函数没有柯里化的话, 从第一步 &lt;code class=&quot;language-text&quot;&gt;get(&amp;#39;tasks&amp;#39;)&lt;/code&gt; 开始, 这个函数只会被解释成 &lt;code class=&quot;language-text&quot;&gt;get(&amp;#39;tasks&amp;#39;, undefined)&lt;/code&gt;, 那么很显然, 后面的过程就没有进行下去的意义咯. 而通过柯里化, 这里返回的是一个函数, 一个需要收集它另外一个参数的函数.&lt;/p&gt;
&lt;p&gt;同样的 &lt;code class=&quot;language-text&quot;&gt;filter&lt;/code&gt; 也需要一个数组来填充进来, &lt;code class=&quot;language-text&quot;&gt;reject&lt;/code&gt; 和后面的函数都一样. 因为它们现在都是函数, 所以 compose 不会抱怨, 它将这些函数&lt;em&gt;组合在了一起&lt;/em&gt;, 变成了一个新的函数.
当我们将 data 传入这个新函数的时候, 先运行 &lt;code class=&quot;language-text&quot;&gt;get(&amp;#39;tasks&amp;#39;)(data)&lt;/code&gt;, 得到一个新的数组, 这个数组传给 &lt;code class=&quot;language-text&quot;&gt;filter(&amp;#39;usename&amp;#39;)&lt;/code&gt; 又得到一个新的数组. 就这样反复的执行最后得到我们的结果&lt;/p&gt;
&lt;p&gt;顺便一提, 这种 &lt;code class=&quot;language-text&quot;&gt;a(b(c(d(e, f)))))&lt;/code&gt; 的形式其实很像 &lt;code class=&quot;language-text&quot;&gt;reduce&lt;/code&gt; 的操作, 所以再看看 compose 的实现吧&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;compose&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;fns&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; fns&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;No Optional Arguments&lt;/h3&gt;
&lt;p&gt;最后再解释一下为什么需要固定参数? Lodash 的那些可选参数的函数全部都挂了, 为什么呢?
其实这是因为 &lt;code class=&quot;language-text&quot;&gt;curry&lt;/code&gt; 不支持可选参数的. JS 原生不支持柯里化, 那么我们无非就是使用一个函数来模拟这个过程.
一个简单的 curry 方法可以写成&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;curry&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fn&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; length &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fn&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt;
  args&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; length &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; curry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;bind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fn&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; length&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意看实现就可以发现, 我们必须了解到函数的长度, 才能决定是返回函数的运行结果还是一个新的函数.
看完这些再回过头看之前的例子的话, 应该就很容易理解了.&lt;/p&gt;
&lt;h2&gt;更多例子&lt;/h2&gt;
&lt;p&gt;上面已经举了使用 lodash/fp 配合 setState 更新和删除的例子, 再看看在末尾添加的例子吧.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 末尾添加&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;addPost&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;posts&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 更新数组特定下标的值, 这个类似于井字棋的游戏中很有用.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`posts[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;]`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;不足&lt;/h2&gt;
&lt;p&gt;lodash/fp 其实还有很多不足, 它不过是将 lodash 里的函数改成了 fp 的形式, 所以它相比 lodash 没有任何新函数.
比如, 它不能同时修改一个对象的多个值. 同样的也不能使用多个函数来修改一个对象的多个值.
简单的说就是, &lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt; 和 &lt;code class=&quot;language-text&quot;&gt;update&lt;/code&gt; 都仅仅只支持修改一个参数.
同时, 针对数组的方法也不是很多, 比如没有类似于 &lt;code class=&quot;language-text&quot;&gt;insert&lt;/code&gt; 的方法. 这可能是因为原生 js 有了 &lt;code class=&quot;language-text&quot;&gt;splice&lt;/code&gt;, lodash 也没有加强的必要.&lt;/p&gt;
&lt;h2&gt;Ramda&lt;/h2&gt;
&lt;p&gt;最后, 如果真的尝试使用这种风格的话, lodash/fp 仅仅是入门, 建议还是使用 &lt;a href=&quot;http://ramdajs.com&quot;&gt;Ramda&lt;/a&gt; 来获得更加纯粹的体验和享受.
关于 Ramda 的使用可以参考这些&lt;a href=&quot;http://fr.umio.us&quot;&gt;博客&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Object.assign 的一些问题]]></title><description><![CDATA[在  immutable struct  或者说  functional programming  的影响下,   和  Object Spread  是我们离不开的操作. 不过它的功能真的是  shadow copy…]]></description><link>https://github.com/thoamsy/blogs.git/object-assign/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/object-assign/</guid><pubDate>Wed, 31 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;在 &lt;em&gt;immutable struct&lt;/em&gt; 或者说 &lt;em&gt;functional programming&lt;/em&gt; 的影响下, &lt;code class=&quot;language-text&quot;&gt;Object.assign&lt;/code&gt; 和 &lt;a href=&quot;https://github.com/tc39/proposal-object-rest-spread&quot;&gt;Object Spread&lt;/a&gt; 是我们离不开的操作. 不过它的功能真的是 &lt;em&gt;shadow copy&lt;/em&gt; 吗? 这里我列出一个例子来记录这个问题, 以防以后碰到坑.&lt;/p&gt;
&lt;p&gt;下面是一个对象, 包括了几种典型的属性:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;普通属性&lt;/li&gt;
&lt;li&gt;get 属性&lt;/li&gt;
&lt;li&gt;set 属性&lt;/li&gt;
&lt;li&gt;Symbol&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  a&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hh&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;__GETTER__&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hh&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;val&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;__SETTER__&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; val &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Symbol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cool&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;good&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;先提出问题, 哪种类型的属性会被成功 copy? &lt;code class=&quot;language-text&quot;&gt;get 和 set&lt;/code&gt; 时候会被运行呢?&lt;/p&gt;
&lt;p&gt;首先可以确定的是, 连续两次打印 &lt;code class=&quot;language-text&quot;&gt;obj.hh&lt;/code&gt; 的话, 一定会得到 &lt;code class=&quot;language-text&quot;&gt;2, 3&lt;/code&gt;. 因为每次 &lt;code class=&quot;language-text&quot;&gt;hh&lt;/code&gt; 都会被运行对吧.&lt;/p&gt;
&lt;p&gt;OK, 现在开始对它 &lt;code class=&quot;language-text&quot;&gt;assign&lt;/code&gt;, 有下面代码&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; shadow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;obj &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shadow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hh&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shadow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hh&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个时候得到的值是多少呢(假设这串代码紧接上面的代码)
最后的结果是 &lt;code class=&quot;language-text&quot;&gt;4, 4&lt;/code&gt;
这说明 GET 只被运行了一次后, 就再也没有运行了.
那我们打印一下 shadow 的内部看看,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOwnPropertyDescriptors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/b0dd709a206bcde06de0b0ffc0157ef2/c2f93/06FE5C2C-8A1B-45EE-B45D-D3DB0774F9FA.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 27.54491017964072%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAApUlEQVQY06WQ0QqEIBBF/ZDILB8kSKJMyMiI/v+b7nIHjBb2Ydl9OIxzdcY7o0II6PsedV2jaRporf9CVVUFay2MMULXdXfetq1QtJI/NcbnWzXPM9Z1RUoJwzBgWRYcx4FpmuTMuO+7aDFGyVnDu5yzwDM1Tqu2bbsFFvA3jl5ioUzwSXvWKO+9OGRDMo6j7JP8tEPavK4L53lKY7qk5px7c/MtL5GKrmesUOWZAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;06FE5C2C 8A1B 45EE B45D D3DB0774F9FA&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/b0dd709a206bcde06de0b0ffc0157ef2/42603/06FE5C2C-8A1B-45EE-B45D-D3DB0774F9FA.png&quot;
        srcset=&quot;/blogs/static/b0dd709a206bcde06de0b0ffc0157ef2/f931c/06FE5C2C-8A1B-45EE-B45D-D3DB0774F9FA.png 200w,
/blogs/static/b0dd709a206bcde06de0b0ffc0157ef2/e8031/06FE5C2C-8A1B-45EE-B45D-D3DB0774F9FA.png 400w,
/blogs/static/b0dd709a206bcde06de0b0ffc0157ef2/42603/06FE5C2C-8A1B-45EE-B45D-D3DB0774F9FA.png 800w,
/blogs/static/b0dd709a206bcde06de0b0ffc0157ef2/5b8b9/06FE5C2C-8A1B-45EE-B45D-D3DB0774F9FA.png 1200w,
/blogs/static/b0dd709a206bcde06de0b0ffc0157ef2/c2f93/06FE5C2C-8A1B-45EE-B45D-D3DB0774F9FA.png 1336w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注意到, 这个时候 hh 只是一个普通的属性, 而不再属于 get set. 作为对比, 我们看下 obj 会输出什么.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/73ccd330d70754382a3ed1d85ee766e1/39e48/336C40D7-A962-48C0-B485-B81EDD28B4EA.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 26.794871794871796%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAhklEQVQY052QOw7DIBAFOQn/woICjG0kENz/WC/ZlWXFTX7FwBZoGBDee5RSsK4rjuPgmQghQEoJpdRHtNbXLowxqLVijIFt25BzZpnR5jr0jlepVk/hsixorWHfdy50zt1u/Ap1QoW0UOGck6VUaa0Flf8kPRH0hyTqvSOlxM+NMbL0H+EDuqyOShKiobkAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;336C40D7 A962 48C0 B485 B81EDD28B4EA&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/73ccd330d70754382a3ed1d85ee766e1/42603/336C40D7-A962-48C0-B485-B81EDD28B4EA.png&quot;
        srcset=&quot;/blogs/static/73ccd330d70754382a3ed1d85ee766e1/f931c/336C40D7-A962-48C0-B485-B81EDD28B4EA.png 200w,
/blogs/static/73ccd330d70754382a3ed1d85ee766e1/e8031/336C40D7-A962-48C0-B485-B81EDD28B4EA.png 400w,
/blogs/static/73ccd330d70754382a3ed1d85ee766e1/42603/336C40D7-A962-48C0-B485-B81EDD28B4EA.png 800w,
/blogs/static/73ccd330d70754382a3ed1d85ee766e1/5b8b9/336C40D7-A962-48C0-B485-B81EDD28B4EA.png 1200w,
/blogs/static/73ccd330d70754382a3ed1d85ee766e1/39e48/336C40D7-A962-48C0-B485-B81EDD28B4EA.png 1560w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;所以结论就是, 普通属性和 Symbol 会被 Copy. 至于 Symbol 时候还是原来那个, 自己测试一下可以发现肯定是的.&lt;/p&gt;
&lt;p&gt;那么, 另外一个问题. 这些 GET 和 SET 是在什么情况下被执行的呢? 我们可以看到, 上面只打印出了 &lt;strong&gt;&lt;em&gt;GETTER&lt;/em&gt;&lt;/strong&gt; 而没有 &lt;strong&gt;&lt;em&gt;SETTER&lt;/em&gt;&lt;/strong&gt;, 先引用 MDN 的文档&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The Object.assign() method only copies enumerable and own properties from a source object to a target object. It uses [[Get]] on the source and [[Set]] on the target, so it will invoke getters and setters.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;也就是说, 第二个参数的 GET 会被调用, 第一个参数的 SET 会被调用. 而因为 &lt;code class=&quot;language-text&quot;&gt;{ …obj }&lt;/code&gt; 就相当于 &lt;code class=&quot;language-text&quot;&gt;Object.assign({}, obj)&lt;/code&gt;, 所以只有 GET 会被调用。&lt;/p&gt;
&lt;p&gt;如何证明 SET 会被调用呢? 这个简单, 使用 &lt;code class=&quot;language-text&quot;&gt;Object.assign(obj, obj)&lt;/code&gt; 就行.
如果现在的代码是这样的&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; symbol &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Symbol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cool&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  a&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hh&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;__GETTER__&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hh&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;val&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;__SETTER__&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; val &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;symbol&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;good&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hh&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hh&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; aha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;assign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOwnPropertyDescriptors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Reflect&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ownKeys&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;aha&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;会出现下面的结果.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/306e2f20608f2abb12380067efc28b5f/536a7/7F67AD27-E0D9-42B7-AB4C-D67D9A4C7241.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 538px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 115.98513011152416%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsSAAALEgHS3X78AAACd0lEQVQ4y5XU61IiQQwF4HkMRQUvCKLiDWUEFUGlLN//gXrri5UpxnW39EeYbrpzcnKSdHV4eFguLy/L/f192NPTUxmNRmV3d7fs7++XXq8X359axfnl5aU8Pz+Xx8fH8v7+HsDD4fDXYAF4fn4eQACXy2X5+Pgos9msnJyctAB/Cl5Np9NST+tIs9PpRKpkYED29vZKt9ttOf0PvOJ4cXFRrq6uymAwCD2xPj09Dcfr6+tgC9g+wf4FWol+cHAQTpylvVqtytvbW4DO5/Nye3sbwfr9fjD/i2lvAzAXUr27u2sMqGLRE0hd16H1YrEIoK8yJGiVUaSECUYKBIgBprOqYwxUax0fHweJrzJUuQAoZZeBAH54eGg6AOh4PA6tnWGskKylIbDUhgMAheEkPax9AQLDdPOeNf1TggptzooBdGtrK9gyZ1qJ2e/s7MR/1tvb27EGlBYpW9BDJMXAJltI+qZGenX9+bWXEYaI5GBMJpNydHT0mTJmNi7Ti5YAU0v/K5A1Q8AZjQEi4ZxPq21ESW2InYVxmZa+MeeDYdNe7tHXuUDBUGNLPdtmvV43Ka2Wn21DeDabzYMdZ3rzo21TFD/559nZWQOUKWKUqdNWipiRxt7Ykqs1eoCyVYwcB8AJpDhS19gKkmOarGnXMNQCooho1KSbPQcEGFaYcsyx+9oyzaTYiMqJ5XSonGDYeyMFE4h23700+V+1OYc3NzfhpN8AArY2Hb7OaJtN/B1oq204SC3HLplqekw320pn5MOw+UBU+exID0Mp0zGbGaAAQJOpYpEHUxXOKrcYOhTZ5Xz7zHf2peJgqJEFfn19jT3mCggU4B92J7TKnD/0XQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;7F67AD27 E0D9 42B7 AB4C D67D9A4C7241&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/306e2f20608f2abb12380067efc28b5f/536a7/7F67AD27-E0D9-42B7-AB4C-D67D9A4C7241.png&quot;
        srcset=&quot;/blogs/static/306e2f20608f2abb12380067efc28b5f/a3759/7F67AD27-E0D9-42B7-AB4C-D67D9A4C7241.png 200w,
/blogs/static/306e2f20608f2abb12380067efc28b5f/4aca8/7F67AD27-E0D9-42B7-AB4C-D67D9A4C7241.png 400w,
/blogs/static/306e2f20608f2abb12380067efc28b5f/536a7/7F67AD27-E0D9-42B7-AB4C-D67D9A4C7241.png 538w&quot;
        sizes=&quot;(max-width: 538px) 100vw, 538px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在这里, GET 和 SET 都被调用了一次, 分别是 source 和 target 调用的. 而这个时候 a 变成 12 也不难解释.
因为 &lt;code class=&quot;language-text&quot;&gt;obj.a&lt;/code&gt; 原来是 3. 当 assign 被调用的时候, 内部会有一个 &lt;code class=&quot;language-text&quot;&gt;obj.a = obj.a&lt;/code&gt; 的过程. 先 GET, 就让 &lt;code class=&quot;language-text&quot;&gt;obj.a&lt;/code&gt; 变成了 4, 然后是 SET, 也就是 &lt;code class=&quot;language-text&quot;&gt;obj.a += obj.a * 4&lt;/code&gt; 就成了 12.&lt;/p&gt;
&lt;p&gt;不过, 值得注意的是, 这里 hh 还是 GET 和 SET, 并没有像上面的 assign 所做的一样，被替换成普通的属性.
不知道这是不是有意为之.&lt;/p&gt;
&lt;p&gt;那么我们该如何复制含有 get 和 set 的对象呢? 如果用到 ES8 的特性的话, 会很简单&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; realShadow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getPrototypeOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOwnPropertyDescriptors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/af279db6c89a2d5d7aa85a971678507a/102ef/1A25BA7A-053A-42D7-91AB-2184F28CFAA5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 26.848249027237355%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAlUlEQVQY041PWwrEIBDzIlZbC9qHqIjih+D9TzVLBgpbtsvuR8gYMpkoQgh0HAed50nWWmbvPW3bxsAMDbNzjr3Q9n1nDTtKKdJaM4QxhhCaUqLWGs8xRl6apomklMzfcIVdLOZ5plIKjTGYEYYW0K+rv3BriMpohrBaK63ryoZ30yPU81tgMedMvXdmfH1Zlo/L/+IFFTyPNmrN8eMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1A25BA7A 053A 42D7 91AB 2184F28CFAA5&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/af279db6c89a2d5d7aa85a971678507a/42603/1A25BA7A-053A-42D7-91AB-2184F28CFAA5.png&quot;
        srcset=&quot;/blogs/static/af279db6c89a2d5d7aa85a971678507a/f931c/1A25BA7A-053A-42D7-91AB-2184F28CFAA5.png 200w,
/blogs/static/af279db6c89a2d5d7aa85a971678507a/e8031/1A25BA7A-053A-42D7-91AB-2184F28CFAA5.png 400w,
/blogs/static/af279db6c89a2d5d7aa85a971678507a/42603/1A25BA7A-053A-42D7-91AB-2184F28CFAA5.png 800w,
/blogs/static/af279db6c89a2d5d7aa85a971678507a/5b8b9/1A25BA7A-053A-42D7-91AB-2184F28CFAA5.png 1200w,
/blogs/static/af279db6c89a2d5d7aa85a971678507a/102ef/1A25BA7A-053A-42D7-91AB-2184F28CFAA5.png 1542w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这里 a 的值还是 3, 说明这个 get 根本没有被执行, 完成没有副作用. 这才是真正的浅拷贝嘛!&lt;/p&gt;
&lt;p&gt;OK, 那么这里可以得出一个结论: 对于普通的纯对象, 比如 redux 里保存的那些, 使用 &lt;code class=&quot;language-text&quot;&gt;assign&lt;/code&gt; 没有任何问题. 但如果是自己定义的复杂对象, 带了很多 get 的话, 最好的方式还是采用下面这种最安全的方式吧.&lt;/p&gt;
&lt;p&gt;值得一提的是, 这也是 MDN 推荐的方式:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Whereas the Object.assign() method will only copy enumerable and own properties from a source object to a target object, you are able to use this method and Object.create() for a shallow copy between two unknown objects&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getPrototypeOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOwnPropertyDescriptors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Deep Learning Quick Guide（翻译）]]></title><description><![CDATA[原文 AI(Artificial Intelligence)  和 ML(Machine Learning) 是当下最热的话题. 我们每天都能看到 AI 的字眼, 那些有抱负的程序员都说自己想学点 AI. 你也听到高层说他们想在服务中集成 AI…]]></description><link>https://github.com/thoamsy/blogs.git/deep-learning/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/deep-learning/</guid><pubDate>Sun, 28 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/8281600941e9adcae8c522d9bd13a3a6/432b6/1*1mpE6fsq5LNxH31xeTWi5w.jpeg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 66.64999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB66dVBpIf/8QAGBABAQEBAQAAAAAAAAAAAAAAAQIAEQP/2gAIAQEAAQUCq0S3S9GBx5mDm//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABsQAAICAwEAAAAAAAAAAAAAAAABEUEhMVFh/9oACAEBAAE/IYgqZL34ZBjA6KQhIR//2gAMAwEAAgADAAAAEGDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAwADAQEAAAAAAAAAAAAAAAERIUFhUYH/2gAIAQEAAT8QcmYh8aFIvWfB3vNlk7bX3EFmqz4bpoBWz//Z&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1 1mpE6fsq5LNxH31xeTWi5w&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/8281600941e9adcae8c522d9bd13a3a6/893a4/1*1mpE6fsq5LNxH31xeTWi5w.jpeg&quot;
        srcset=&quot;/blogs/static/8281600941e9adcae8c522d9bd13a3a6/bbf57/1*1mpE6fsq5LNxH31xeTWi5w.jpeg 200w,
/blogs/static/8281600941e9adcae8c522d9bd13a3a6/260b8/1*1mpE6fsq5LNxH31xeTWi5w.jpeg 400w,
/blogs/static/8281600941e9adcae8c522d9bd13a3a6/893a4/1*1mpE6fsq5LNxH31xeTWi5w.jpeg 800w,
/blogs/static/8281600941e9adcae8c522d9bd13a3a6/25965/1*1mpE6fsq5LNxH31xeTWi5w.jpeg 1200w,
/blogs/static/8281600941e9adcae8c522d9bd13a3a6/e54c8/1*1mpE6fsq5LNxH31xeTWi5w.jpeg 1600w,
/blogs/static/8281600941e9adcae8c522d9bd13a3a6/432b6/1*1mpE6fsq5LNxH31xeTWi5w.jpeg 2000w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.freecodecamp.org/want-to-know-how-deep-learning-works-heres-a-quick-guide-for-everyone-1aedeca88076&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;AI(Artificial Intelligence)&lt;/strong&gt; 和 ML(Machine Learning) 是当下最热的话题.&lt;/p&gt;
&lt;p&gt;我们每天都能看到 AI 的字眼, 那些有抱负的程序员都说自己想学点 AI. 你也听到高层说他们想在服务中集成 AI. 但是, 大多数人其实不理解什么是 AI.&lt;/p&gt;
&lt;p&gt;一旦你读过了这篇文章, 你就会理解基础的 AI 和 ML 知识. 最重要的是, 你将会理解什么是 &lt;em&gt;[深度学习](&lt;a href=&quot;https://en.wikipedia.org/wiki/Deep&quot;&gt;https://en.wikipedia.org/wiki/Deep&lt;/a&gt;&lt;/em&gt;learning)_—最流行的 ML 方法, 是怎么工作的.&lt;/p&gt;
&lt;p&gt;这篇介绍面向所有人, 所以不需要任何数学基础.&lt;/p&gt;
&lt;h2&gt;背景&lt;/h2&gt;
&lt;p&gt;理解深度学习的第一步是分清两个重要术语的区别.&lt;/p&gt;
&lt;h3&gt;人工智能 VS 机器学习&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;人工智能&lt;/strong&gt; 是人类智能在计算机中的模拟&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;当 AI 研究首次开始的时候, 研究者会尝试去复制人类在特定行为下的思考方式—比如玩游戏&lt;/p&gt;
&lt;p&gt;他们会描述出计算机需要遵守的大量规则. 计算机有一个特定的动作集, 并且根据这些动作集作出决策.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;机器学习指的是机器具有一种在大规模数据集下学习的能力, 而不再需要提前规定各种规则&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ML 允许计算机自主学习. 这种学习方式充分利用了现代计算机的处理力, 能够轻松的处理&lt;strong&gt;大规模&lt;/strong&gt;数据集.&lt;/p&gt;
&lt;h3&gt;监督性学习 VS 非监督性学习&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;监督性学习需要使用标记过的数据&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;当你使用监督性学习训练 AI 的时候, 你需要给它一个输入和希望得到的结果(输出)&lt;/p&gt;
&lt;p&gt;如果 AI 得到的结果是错的.它会自动调整它的计算方式. 这个过程通过不断地遍历数据集, 指导 AI 得到的结果和期望输出值没有任何出入后, 才停止.&lt;/p&gt;
&lt;p&gt;一个监督性学习的例子是天气预测 AI. 它会使用历史数据来学习预测. 训练数据包括了输入(气压, 潮湿度, 风速)和输出(气温)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;非监督性学习是使用没有特定结构的数据的一种训练方式&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;当你打算使用非监督性学习来训练 AI 的时候, 你需要让 AI 自己决定如何对数据分类.&lt;/p&gt;
&lt;p&gt;一个监督性学习的例子是电商网站的行为预测 AI. 它不能用标记过的数据来训练.&lt;/p&gt;
&lt;p&gt;取而代之的是, 它会对输入数据创建自己的分类, 它会告诉你哪种用于最可能买的东西.&lt;/p&gt;
&lt;h2&gt;那么, 深度学习呢&lt;/h2&gt;
&lt;p&gt;你要开始准备理解深度学习, 和它工作的方式咯.&lt;/p&gt;
&lt;p&gt;深度学习是一种&lt;strong&gt;机器学习的方法&lt;/strong&gt;, 它让你训练 AI 来针对输入给出对应的输出. 无论监督性学习还是非监督性学习都可以用来训练.&lt;/p&gt;
&lt;p&gt;我们通过假象一个&lt;strong&gt;飞机票预测服务&lt;/strong&gt;来学习深度学习的公粥方式. 我们使用监督性学习来训练它.&lt;/p&gt;
&lt;p&gt;我们希望我们的机票预测器能够使用下面的输入(去掉了剩余票来保证简单)来预测价格:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;出发地&lt;/li&gt;
&lt;li&gt;目的地&lt;/li&gt;
&lt;li&gt;出发时间&lt;/li&gt;
&lt;li&gt;航空公司&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;神经网络&lt;/h3&gt;
&lt;p&gt;让我们来深入我们 AI 的大脑.&lt;/p&gt;
&lt;p&gt;就像动物一样,我们的预测 AI 的大脑拥有神经元. 用圆来表示它们. 这些神经元是互相连接的.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/35eee33de47a56b9757fd77ba4b2c6f1/8f9cf/1*LaEgAU-vdsR_pClMcgbikQ.jpeg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 791px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 49.05183312262958%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdiWWrBjL//EABkQAAIDAQAAAAAAAAAAAAAAAAARAQIQIf/aAAgBAQABBQLpDbLb/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAAAEg/9oACAEBAAY/AhT/AP/EABoQAQACAwEAAAAAAAAAAAAAAAEAESFBURD/2gAIAQEAAT8hWjy4sqC3MArstszrz//aAAwDAQACAAMAAAAQqO//xAAWEQADAAAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8QNX//xAAWEQEBAQAAAAAAAAAAAAAAAAABECH/2gAIAQIBAT8QDJ//xAAcEAACAgIDAAAAAAAAAAAAAAABEQAxIUEQUWH/2gAIAQEAAT8QOASeyEZFBRKoPjghAnktw3am+P/Z&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1 LaEgAU vdsR pClMcgbikQ&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/35eee33de47a56b9757fd77ba4b2c6f1/8f9cf/1*LaEgAU-vdsR_pClMcgbikQ.jpeg&quot;
        srcset=&quot;/blogs/static/35eee33de47a56b9757fd77ba4b2c6f1/2ab27/1*LaEgAU-vdsR_pClMcgbikQ.jpeg 200w,
/blogs/static/35eee33de47a56b9757fd77ba4b2c6f1/87dd3/1*LaEgAU-vdsR_pClMcgbikQ.jpeg 400w,
/blogs/static/35eee33de47a56b9757fd77ba4b2c6f1/8f9cf/1*LaEgAU-vdsR_pClMcgbikQ.jpeg 791w&quot;
        sizes=&quot;(max-width: 791px) 100vw, 791px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这些神经元被分成三种不同的层:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;输入层&lt;/li&gt;
&lt;li&gt;隐藏层&lt;/li&gt;
&lt;li&gt;输出层&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;译者注: 就是因为隐藏层的行为是黑盒的, 连创造这个 AI 的人都不知道为什么会这样. 这也就是为什么有些大佬针对 AI 会有一些担心. 虽然目前的 AI 还处于比较弱智的阶段, 但是就像互联网的发展一样, 没人能预测到 20 年后的 AI 会到怎样的程度.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;输入层&lt;/strong&gt;接受输入数据. 在我们的场景下, 我们的输入层有四个神经元: 出发地, 目的地, 出发时间, 航空公司. 输入层将这些输入传给第一个隐藏层.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;隐藏层&lt;/strong&gt;会对输入的数据执行数学运算. 一大挑战是: 决定使用多少层隐藏层以及每一层有多少个神经元(越多越慢, 但是效果也越好)&lt;/p&gt;
&lt;p&gt;深度学习中的 &lt;strong&gt;Deep&lt;/strong&gt; 指的就是多于一层的隐藏层.&lt;/p&gt;
&lt;p&gt;输出层就会返回输出的数据. 在我们的案例下, 它会告诉我们价格预测.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/5cc5d0c872bf7934abe030f7acfa5fec/49d2c/1*6PjhO0kPciY_f5XbghnZsQ.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 630px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 47.61904761904761%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACNklEQVQoz2NgwAEy7v1nDJy+SwLE9mlbku3bsSwAJqcIxH7dqxkDJm0G8/37NzAYGhrC9XLWlUQw3N8bq/Z/CwOza/cWiYD+9ZJWPmFi/n3rqozNzNVc8pqNnFLLtS1cvYUCp+5QRbYYZBgIIBsoCSIe7Y/LbI6SVnCqX+zh0zgnTEtKSNq3c7m7joK0gVfdzHj3sj5vCzdfI//+9dlSDAwcARM3GfpP3gbWu7u+kBlEm0gJgw2UY2Fm5nl2OMEx1l1Vzb54kql7UYejkbGJHlBzooGerqt7eb+zS06juamNg6V/33pXFQ4GMWAwhAZ2rdDFFlzC1iYqrM8PJwREu6kZOxRPdPEo6/U30NEyAHonQF9bw8OjanKAa36Ls6mto1vApC3BWhICcr5Nc70MerbL7Yt3UHlaG+cJNIfFREqIBWSgmKKsKMeLIwm+ka5qxvZF/U7upd2+Bro6hkAD/Q20NT08Kif5ueQ2OZnaOrkDDQyCG9i5WX5XrL0qzEBtUX5WkIH8BjpKjI8OxLnEu6uoOZRMtnAv6XIxMjLWBXo5CWiwi0fFRDdgxFiZ2thbAsXcVWFe7l6pg83LPIv7I5mABqY0hksqOCNHSsdyVx0FKUiklPaCIsUY6Oo8eKRMgUTKLmikaInygw1kTY5yBsWyzv/tDCzOXVvFA/rXSVn5hIKSTYWxKSLZmDm4CgZO2a6IkmwmbATTRkZGDHhB0pn/TIHTdspgS9jy8IS9BW6ogYEBmA0AytjEybLjdkAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1 6PjhO0kPciY f5XbghnZsQ&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/5cc5d0c872bf7934abe030f7acfa5fec/49d2c/1*6PjhO0kPciY_f5XbghnZsQ.png&quot;
        srcset=&quot;/blogs/static/5cc5d0c872bf7934abe030f7acfa5fec/2de4e/1*6PjhO0kPciY_f5XbghnZsQ.png 200w,
/blogs/static/5cc5d0c872bf7934abe030f7acfa5fec/905ee/1*6PjhO0kPciY_f5XbghnZsQ.png 400w,
/blogs/static/5cc5d0c872bf7934abe030f7acfa5fec/49d2c/1*6PjhO0kPciY_f5XbghnZsQ.png 630w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;所以, 这个价格预测是怎么算出来的呢?
这就是深度学习的&lt;strong&gt;黑魔法&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;每一个神经元都是以&lt;strong&gt;权重&lt;/strong&gt;来连接的. 权重指的就是某一个输入值的重要性. 初始权重是随机的.&lt;/p&gt;
&lt;p&gt;当我们预测飞机票的价格的时候, 出发时间是一个重要的影响因素, 所以和出发时间相连接的神经元, 都会获得一个很高的权重.
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/b2fe0db64884470d524228d265952875/19b6f/1*_kudSKDXEScysTpYYowqFg.jpeg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 532px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 62.96992481203007%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3QVR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxABAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAQABPyHUaqc//9oADAMBAAIAAwAAABDTz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQACAwEAAAAAAAAAAAAAAAEAERAhMXH/2gAIAQEAAT8QVdN+EVbtlYNX0Xka6x//2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1  kudSKDXEScysTpYYowqFg&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/b2fe0db64884470d524228d265952875/19b6f/1*_kudSKDXEScysTpYYowqFg.jpeg&quot;
        srcset=&quot;/blogs/static/b2fe0db64884470d524228d265952875/b5a59/1*_kudSKDXEScysTpYYowqFg.jpeg 200w,
/blogs/static/b2fe0db64884470d524228d265952875/6da76/1*_kudSKDXEScysTpYYowqFg.jpeg 400w,
/blogs/static/b2fe0db64884470d524228d265952875/19b6f/1*_kudSKDXEScysTpYYowqFg.jpeg 532w&quot;
        sizes=&quot;(max-width: 532px) 100vw, 532px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;每一个神经元都有一个&lt;a href=&quot;https://en.wikipedia.org/wiki/Activation_function&quot;&gt;激励函数&lt;/a&gt;, 这些函数没有数学基础的话很难解释.
简单地说, 它的一个用处就是标准化这些神经元的输出值.&lt;/p&gt;
&lt;p&gt;一旦这些输入数据通过了所有的神经网络后, 它们就会通过输出层被返回出来.
一点都不难, 对吧?&lt;/p&gt;
&lt;h3&gt;训练神经网络&lt;/h3&gt;
&lt;p&gt;训练 AI 是深度学习最难的部分. 为什么?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;你需要有大量的数据&lt;/li&gt;
&lt;li&gt;你需要有庞大的算力&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;对于我们的机票价格预测系统, 我们需要寻找历史机票价格的数据. 因为机场和出发时间又有大量的组合, 我们就需要非常庞大的数据集.&lt;/p&gt;
&lt;p&gt;为了训练 AI, 我们需要给他输入值, 然后将它的输出值和数据集中的输出值进行比较. 因为 AI 还没有训练完成, 这个输出肯定是错的.&lt;/p&gt;
&lt;p&gt;一旦我们遍历过一次所有的数据集后, 我们创造一个用来暂时 AI 的输出和预期输出之间的差别. 这个函数被称为&lt;strong&gt;开销函数&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;理想情况下, 我希望我们的开销函数是 0. 也就是 AI 的输出和数据集的输出完全一致.&lt;/p&gt;
&lt;h3&gt;怎么降低开销&lt;/h3&gt;
&lt;p&gt;我们需要修改神经元之间的权重. 我们可以随机的改变他们直到开销很低. 但是这个方法显然不怎么高效.
相反, 我们会使用一个叫做 &lt;a href=&quot;https://en.wikipedia.org/wiki/Gradient_descent&quot;&gt;梯度下降&lt;/a&gt; 的方法.&lt;/p&gt;
&lt;p&gt;深度下降是一种让我们能找到函数最小值的方法. 在我们的场景下, 我们需要寻找开销函数的最小值.&lt;/p&gt;
&lt;p&gt;它的工作方式是&lt;strong&gt;在每次遍历数据后&lt;/strong&gt;, 一点一点的&lt;strong&gt;修改权重&lt;/strong&gt;. 通过计算在某一特定数据集下, 开销和对应权重的函数的斜率, 我们可以知道哪个方向可以得到最小值.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/3fc5856380fb326d45c3303623ce7207/c7ea5/1*HrFZV7pKPcc5dzLaWvngtQ.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 54.1875%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABXUlEQVQoz5VRTU+DQBDtjzUm/jFvHvWmMfFSSxNTrGkFKfK1tKHLdr9g+XZgSw/oxZfshJ15b2d4M+u6jlIqhOj+j5mUMggC0Pe3toVQ1zVCiDF2ITVNMxRb+BADyrLsxWEYfru7I+ERVppaFIVhGKZpMsabupJFa356hcpAoJSybduyrDRNezGcE0njhHhJrntDB845zAJswSlK6Ns20J2nY8MhKU7w6SweC5rKKL26vnF9dMm0I87iI8Z5JtyDlKrupuLT7d1D07STvNb3YoxxJgXL6i/EB3u6ccD25XW1eN8NLjZ/uK3FdPB2FzM/kbpQlWq+XD0utmASXGEj6/XaG+E4DmTO4sueg6O0Ue/8/fPyaf6RZUpKkec5IQTEwIRtgZGwEYiDYYTAS7DbKIoO+9j1/I3lbiwHRWEYBL4PPSD6etvTsQH6MQAMCaT9PuacVVU9NOgBzX//8w94snTlDIXmTgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1 HrFZV7pKPcc5dzLaWvngtQ&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/3fc5856380fb326d45c3303623ce7207/42603/1*HrFZV7pKPcc5dzLaWvngtQ.png&quot;
        srcset=&quot;/blogs/static/3fc5856380fb326d45c3303623ce7207/f931c/1*HrFZV7pKPcc5dzLaWvngtQ.png 200w,
/blogs/static/3fc5856380fb326d45c3303623ce7207/e8031/1*HrFZV7pKPcc5dzLaWvngtQ.png 400w,
/blogs/static/3fc5856380fb326d45c3303623ce7207/42603/1*HrFZV7pKPcc5dzLaWvngtQ.png 800w,
/blogs/static/3fc5856380fb326d45c3303623ce7207/5b8b9/1*HrFZV7pKPcc5dzLaWvngtQ.png 1200w,
/blogs/static/3fc5856380fb326d45c3303623ce7207/c7ea5/1*HrFZV7pKPcc5dzLaWvngtQ.png 1600w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;为了最小我们的开销, 需要遍历数据集很多次. 这也是为什么你需要非常庞大的计算力.
使用梯度下降的方法来更新权重是&lt;strong&gt;全自动&lt;/strong&gt;的, 这也是深度学习的黑魔法.&lt;/p&gt;
&lt;p&gt;一旦我们训练好我们的 AI, 就能用来预测未来的机票价格了.&lt;/p&gt;
&lt;h2&gt;在哪可以学到更多&lt;/h2&gt;
&lt;p&gt;还有很多其他类型的神经网络: 计算机视觉使用&lt;a href=&quot;https://en.wikipedia.org/wiki/Convolutional_neural_network&quot;&gt;卷积神经网络&lt;/a&gt;, 自然语言处理使用&lt;a href=&quot;https://en.wikipedia.org/wiki/Recurrent_neural_network&quot;&gt;递归神经网络&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;如果你想学习深度学习, 我建议还是去找在线课程.
当前最好的课程之一就是吴恩达的&lt;a href=&quot;https://www.coursera.org/specializations/deep-learning&quot;&gt;深度学习标准&lt;/a&gt;. 如果你对证书没兴趣的话, 可以不需要为这门课程付费. 你可以免费旁听.&lt;/p&gt;
&lt;h2&gt;总结&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;深度学习使用神经网络来模仿动物的智能&lt;/li&gt;
&lt;li&gt;神经网络有三种层: 输入层(Input Layer), 隐藏层(Hidden Layer) 和 输出层(Output Layer)&lt;/li&gt;
&lt;li&gt;神经元之间通过权重连接, 展现了输入数据的重要程度.&lt;/li&gt;
&lt;li&gt;神经元使用对数据使用激励函数来标准化输出&lt;/li&gt;
&lt;li&gt;为了训练神经网络, 你需要大量的数据&lt;/li&gt;
&lt;li&gt;遍历数据并且比较, 会有一个开销函数. 它表明了当前 AI 离可以用还差多远&lt;/li&gt;
&lt;li&gt;每次遍历数据后, 通过梯度下降来降低开销, 以调整神经元之间的权重&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[我进入编程世界的第一步（翻译）]]></title><description><![CDATA[原文, 需要翻墙 作为一个刚毕业的计算机科学学生，在课堂上学到的东西和你在真实世界看到的东西会存在 断层 。各种循环操作：  不在话下。你可以不费吹灰之力写一个基于命令行的井字棋(Tic-Tac-Toe)游戏. 你还可以在 X8…]]></description><link>https://github.com/thoamsy/blogs.git/first-step-software-world/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/first-step-software-world/</guid><pubDate>Tue, 16 Jan 2018 07:28:39 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://medium.freecodecamp.org/my-first-steps-into-the-world-of-software-development-and-what-they-taught-me-6ee748cffb8f&quot;&gt;原文, 需要翻墙&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/3725ce2ac53789957ff83556bc0368b6/9a9c3/1*xNwbQ2Ec0xoq_DMPbxR5yw.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAACqklEQVQozwGfAmD9AK6ludrDvoOShF1YTlQ8LFlENlVDNnpwWsWcm9/XzPT88/b+9vr++/v/++Tk2OXUuPvglM2kRoZlJmtUIgB3coa3pKGTlolyaF1BMy1CNDNFNDFiXlaohId8Z1zu8uft6d7Mwbbq8evFuKTDsJv///+7poOBYS2ZbykAX0xVV1FVbG5nYWBZMTAyJCMdMDE0QEA9VU1NLSAbloh1n3NgWDQhVUg/fnRicG1dx8vAiIh7ZFQrhVgHAGlKTFw+RIWBesfGrDoxKxMREDM3N3ZqYU1JQUA9N3tgRbiHJJdmCVw4B2JVQmZiU2FhUVxcRzo7MDomCQBPP0J+VFJ5cGidtJpCPzo1LzBGPz1wY1xrXlJKPzVqWUDntjiwcwuNWQ53ZVFjW0RSTTxJSTpJRDlHQC8ASzw9e15YVUxIOEpGSURDU01IVElFRD09V0lBJB0XW0E213oqilMeeVQ4ZlZHICAVJiYUMDAkQj4zVVFFAEk6O2VOSkdAPjE8PUU9O1NGQU5BPUA6O0EyKzAtL93IaMeQLz82PGVNOEQ6NgsiMSUgD0pAMkY+M0A8MgAcJTYmNEQnND8pOUAlMj4vO0YzNj85N0A0Mzg6RUjIliWZVwZ5KgOJTBxWOigVMEgcKS0rOz0fNjwWLjUABRw1BR43CiU6FDFBCiM5IjZKP0ZTNDlJIi09Fi9Ag1c3hVQ0aEAmbksvbkoquIIXRksuBCtDByc1ABsrAAQZMAQaMQYfMwwlNQgfNB8xQyg6SiQzQhQnNQ0wRXxMK5EvC1csID0cE2QyDq5+EDI6KRk5SRc5RgAVJQAEFiwBFCsEFykJHywDFioFGCoFGy0LJTgTMEAAK0KMUybONwCPKABCKyM0KCUMJC8MJjgUNz4ON0QFHCoFo9R2UycF7wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Nervous laugh&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/3725ce2ac53789957ff83556bc0368b6/42603/1*xNwbQ2Ec0xoq_DMPbxR5yw.png&quot;
        srcset=&quot;/blogs/static/3725ce2ac53789957ff83556bc0368b6/f931c/1*xNwbQ2Ec0xoq_DMPbxR5yw.png 200w,
/blogs/static/3725ce2ac53789957ff83556bc0368b6/e8031/1*xNwbQ2Ec0xoq_DMPbxR5yw.png 400w,
/blogs/static/3725ce2ac53789957ff83556bc0368b6/42603/1*xNwbQ2Ec0xoq_DMPbxR5yw.png 800w,
/blogs/static/3725ce2ac53789957ff83556bc0368b6/5b8b9/1*xNwbQ2Ec0xoq_DMPbxR5yw.png 1200w,
/blogs/static/3725ce2ac53789957ff83556bc0368b6/9a9c3/1*xNwbQ2Ec0xoq_DMPbxR5yw.png 1280w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;作为一个刚毕业的计算机科学学生，在课堂上学到的东西和你在真实世界看到的东西会存在&lt;strong&gt;断层&lt;/strong&gt;。各种循环操作：&lt;code class=&quot;language-text&quot;&gt;for, while, do while&lt;/code&gt; 不在话下。你可以不费吹灰之力写一个基于命令行的井字棋(Tic-Tac-Toe)游戏. 你还可以在 X86 上直接写汇编代码!&lt;/p&gt;
&lt;p&gt;但是, 你对于 Facebook, YouTube 或者 Reddit(美国最知名的论坛) 是怎么工作的完全没有头绪. 你甚至连怎么开始都不知道. 因为你只知道一门 Python 语言, 当你 Google &lt;em&gt;哪些公司用 Python&lt;/em&gt; 的时候, 你发现一些人说的: &lt;em&gt;“Reddit…use python for their backend.”&lt;/em&gt; Backend(后端)? 这他妈是什么?&lt;/p&gt;
&lt;p&gt;这就是在用命令行写井字棋游戏和构建一个真实的应用程序中, 存在的巨大的空缺, 而且没人会告诉你该怎么填补这个空缺. 即使你已经学会了如何像计算机一样思考, 你还是不知道如何将你学会的东西, 用来构建一个你想构建的东西。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;只有主动才能让你成为你想成为的人. 不会总是有老师或者教授, 将他的模板和样例给你, 而你只需要填补这些空白. 也不总是有一个课程会教你 “下一步你该学什么”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Takeaway #1:&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;没有人比你更能影响你自己&lt;/strong&gt;.
你想学什么取决于你, 而不是有人拿着勺子一点一点的喂着你下一步该学什么, 应该自主学习, &lt;a href=&quot;https://danluu.com/learning-to-program/&quot;&gt;Dan Luu 称这个为 meta-skill&lt;/a&gt;, 这也是你在决定成为一个软件工程师之后最重要的技能之一.&lt;/p&gt;
&lt;p&gt;幸运的是, Google 可以帮助我们! 当你搜索 &lt;em&gt;How to build a website using python&lt;/em&gt;, 你找到了这个—&lt;a href=&quot;http://flask.pocoo.org/docs/0.12/&quot;&gt;一个精巧的小型 Web 框架&lt;/a&gt;, 于是你打算一探究竟. 即使你还不知道什么是框架(framework). 你尝试去阅读初学者文档, 但是不知道什么是 &lt;strong&gt;database abstraction layer(数据库抽象层)&lt;/strong&gt;, 于是你跳过这个直接找到了&lt;a href=&quot;http://flask.pocoo.org/docs/0.12/installation/&quot;&gt;安装那一步&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;最后, 你发现了那些可以自己操作的步骤 🎉! 你复制这些命令到你的终端中(terminal). 这里出现了叫做 &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;virtualenv&lt;/code&gt; 的东东, 管它呢, 先复制. 你花了几分钟观察到了输入这些后会发生什么, 你也终于对你的机器是怎么工作的有了一个大概的认识.&lt;/p&gt;
&lt;h2&gt;takeaway #2&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;我们通过理解学习, 而不是无脑的跟着教程.&lt;/strong&gt; 当碰到你完全不理解的东西的时候, 尝试去学习而不是放弃, 这样你将会发现这些看上去不可能完成任务是一个能让你快速成长的绝佳机会—只不过你可能要花很长时间解决它罢了 🌚&lt;/p&gt;
&lt;p&gt;Okay, 现在看上去 &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt; 好像是一个用来安装 &lt;code class=&quot;language-text&quot;&gt;packages(包)&lt;/code&gt; 的工具, 这样你就可以 &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt;(Python 通过这条语句导入外部函数) 它们. &lt;code class=&quot;language-text&quot;&gt;virtualenv&lt;/code&gt; 看上去好像是一个关联你安装好的包和指定项目的方式. 你现在除了 &lt;code class=&quot;language-text&quot;&gt;cd&lt;/code&gt; 和 &lt;code class=&quot;language-text&quot;&gt;mkdir&lt;/code&gt; 外, 其他的命令行你一个都看不懂, 但是至少不再是&lt;strong&gt;一无所知&lt;/strong&gt;. 到了去往&lt;a href=&quot;http://flask.pocoo.org/docs/0.12/quickstart/&quot;&gt;快速指导&lt;/a&gt;的时间了.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/0a68018bffc8ae99d678c36d6c218803/d2c20/41FC0083-5066-4AAE-8BFE-EC3432EF6AC8.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 65.30014641288433%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAADJElEQVQozwEZA+b8AD4wJUM0J0IzJz8xJjcrIS8mHiYeGzEcH0IuMTs0L19UUVxEQnhfUX1sXLKcn8KqmKaRdJ6Ib56JcqyZgQA8LiNJOSxKOixMOy1IOiw7LiQvJRwaFRA+MS5iVFCmkoeRd2F5ZlVxXk/DrbLDqpKvlneii3GbhWyeinIAQDInSjotUD4vTj0uQjIlT0Q7YFdRR0NATEI/XEc/j3t0moZ2gXFigXBikYB6tZ6Ao41zgmxYaVdIc2JSAC4lHjgtJDguJUY5LEMuHo6LitHa5bnCzq27zJqTltDKx7a8wMHFy+Hm7+Hl6d7f35+TiFdFNXZkUoNrVgA+Mig8MScgIBpSTkFoSzOQiofL1+DEzNTCztnI0tvc4ePCydDFztXh6e9+iJOnrriZj4Z8ZUqPdFpnU0MAQjUrPjMpOy8mTz8xW0g4W1hZpa24193l0dff1tvi5efsxcvTydLZ4ujqXmdsS1FajIF0g2dKcFpGbVtHADQrIzUsJEQ8NlpbX2pnaFZWWW9uceLm7eHl6+Hj6+Ll7cvR283S2ens7s3X3LjBzIB0a1hCMHZfSZJ3WQA6LiU0LShrZmOOiIpqYWhDPTteXmDZ2+Di5u3l5+3n7PTV2+jQ1uDc3uLNycvl6vCCc2hlSzV+aFZ+ZU8ATT4xOysfVE5KZGFjTkxPT1FTOTo7q6yw7vH509fhsrC0wb7C1+Dp19zjxsbM2+DnfGxiYkg0dmdadGFOAD0yKnRoYGhaT19gYkRFR1pZW56fodHS1OPk7dHY42pkaZmGfODh6czV2crT18vT2VNPSy4jG3ZfS45uTwBcV1Pc3eGsop16dnS7vb7m5+jc2tqooJh+b2VpX1pXSEZ+YlDr4tu7sq5+bF1gV08cGRgOEhRsaVydgFwALSUel5aWsamkdWtkwb24gnZsWEQ0WT8pTDclKBUIs5SCoYhyv6mU/P3+yb22YUUuVT8qbVc/ln5bpYtmADAhH1FAN1dENEY1JkY1JUw2I1I9KlxGMkEzJlJCNsm9sq6mnIxqUP/+/Me6tG9PNHxfQY1vTZl+WaCHYW/ieyt1ZyESAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Just follow along and try to keep up.&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/0a68018bffc8ae99d678c36d6c218803/42603/41FC0083-5066-4AAE-8BFE-EC3432EF6AC8.png&quot;
        srcset=&quot;/blogs/static/0a68018bffc8ae99d678c36d6c218803/f931c/41FC0083-5066-4AAE-8BFE-EC3432EF6AC8.png 200w,
/blogs/static/0a68018bffc8ae99d678c36d6c218803/e8031/41FC0083-5066-4AAE-8BFE-EC3432EF6AC8.png 400w,
/blogs/static/0a68018bffc8ae99d678c36d6c218803/42603/41FC0083-5066-4AAE-8BFE-EC3432EF6AC8.png 800w,
/blogs/static/0a68018bffc8ae99d678c36d6c218803/5b8b9/41FC0083-5066-4AAE-8BFE-EC3432EF6AC8.png 1200w,
/blogs/static/0a68018bffc8ae99d678c36d6c218803/d2c20/41FC0083-5066-4AAE-8BFE-EC3432EF6AC8.png 1366w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;你跟着教程, 运行你的程序, 感觉当你的浏览器第一次出现了 &lt;strong&gt;Hello, World&lt;/strong&gt; 的时候, 你的心中会涌入一种爽到吸大麻的. 你对自己说, 这就我想要的哈哈! 滚吧, 傻逼命令行! 这确实是一小步, 但那是你第一次让浏览器听你的话, 这才是历史性的一刻.&lt;/p&gt;
&lt;p&gt;你继续, 又出现了一大堆你不理解的概念. Routes(路由)? HTTP? GET? POST? 什么是 rendering template(渲染模板)? 这些概念听上去好像有那么一点点印象, 但是你不确定到底是什么意思, 所以你停止你手头的工作去搜一下它们是什么. 就像你刚学会 &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt; 和 &lt;code class=&quot;language-text&quot;&gt;virtualenv&lt;/code&gt; 一样, 渐渐的你开始对你的程序怎么运行有了一个模糊的概念.&lt;/p&gt;
&lt;h2&gt;Takeaway #3&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;学习不断地练习.&lt;/strong&gt; 就像任何其他的技能, 它们是需要打磨的, 熟能生巧. 抓住每一个学习的机会. 记住: success begets success.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;让学习成为一种习惯, 你的求知欲望应该和你的年龄身体一起成长&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;你可以用模板来显示内容, 和其他的 HTML 和 CSS 页面一样, 只不过它们是动态的. 你可以通过定义不同的路由来控制在不同的 URL 下该显示什么. 你甚至可以用你自己的程序来抓取其他网站上的内容!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;译者注: 当然现在是通过前端来渲染模板了, 后端仅在要求性能的时候服务器渲染&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;随着你渐渐地变得更加轻松, 你开始对独立学习有一种控制感和自豪感. 这可能是你在完成课堂任务的时候从未体验过的(不敢想象国外的教育 🙂). 你开始飘起来, 谁还需要学校, ╭(╯^╰)╮?&lt;/p&gt;
&lt;p&gt;随着你获得自信, 这个指导开始看上去有点…基础了. 确实, 毕竟, 这只是一个 quick start… “我可以做更酷 😎 的事情”, 你想着.&lt;/p&gt;
&lt;p&gt;于是你开始自己搞定这些. 你想之前做的一样, 用 &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt; 和 &lt;code class=&quot;language-text&quot;&gt;virtualenv&lt;/code&gt; 设置你的项目, 因为那是你仅仅知道的方式. 你知道如何设置模板; 你知道如何设置路由, HTTP 请求, 什么是 GET 什么是 POST. 你可能开始尝试使用第三方 API, 并且开始阅读更多的文档. 你并不是什么都懂, 但是你正在学习. 一点一点的.&lt;/p&gt;
&lt;p&gt;最后, 你终于构建了你自己的第一个独立的项目 🎉. 不是那个已经有很多年轻的开发者跟着教程走的项目, 也不是很多学生在课堂上做的项目. 而是一个, 真实的, 可以感知到的, &lt;em&gt;honest-to-goodness&lt;/em&gt; 的程序, 在你构建之前, 它从未存在过. &lt;strong&gt;这是一中超凡的感觉!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/f5028/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAB80lEQVQY0wHoARf+AEdWbydIcBZIgE9tm2Jld0RRZSpqsGR9n9K0n+/Iq+3EpvzeuP3ft/PWu+/Ns+7Dp920pMqsrMKkqMqgjwBfZYFbao1KWXlQZYpTa5VZb5tYdKJKfbiNocXuxqW/jIDZspL45sHe3OPi2Nbu0LzSytTGucXcpY7eoIYAODlJMT1UMkZkJ1R/BDd6CESWN1iMRF+GUHm616qf3aSQ1JqF9+jO8uzp6+rr2+v0yur/wtbx4LKv5qabAEA+VkNGXyxUiyJvugQ9hgtOohxou056uG+Fva2GnvypiP/st//10f/y3ef29ur4++ns8OHIxeekj++dgQBGODhNPTodQW8CTZcOO20RQ30pVYhbVGRLbZ2BmMjfemjzm2fmw7r0y73XvrOizuS/3eSdoKJ6WlmRZ18AQjk2QDc0KzlQDzpwDzptGTZbPEFLaF1uY2iGao+5ynVcwGI/hYWjhXSK2WAjo11MdIGbS2R+RjAxRTY9AEQ2NDs0NjQyNiw2QzZASjM1NiouMUpGSkg/RVVNW4o/L3BKU41dV7NMJ86GW5BTTlguMEs4OzUoKTAoKwAwLzEpLDIjLzkeKzQZKDMcKDEyMSxQOyZOOCpVMi9QMjZeP0OdSDiaTTjoul2fd0Q6IytCMS40KywoJCf5o+ed4MwFGwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;You are a master builder.&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/42603/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png&quot;
        srcset=&quot;/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/f931c/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png 200w,
/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/e8031/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png 400w,
/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/42603/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png 800w,
/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/5b8b9/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png 1200w,
/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/c7ea5/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png 1600w,
/blogs/static/c16ff7fb3d74162cf7ee97cd9ce8ca0f/f5028/5498D1B1-A326-4044-9362-F2B1BA3A7BAE.png 1920w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;所以接下来呢? 现在你做好了一个应用, 怎样才能让每个人都能用到它? 到底什么是 &lt;code class=&quot;language-text&quot;&gt;back-end&lt;/code&gt;, 什么是 &lt;code class=&quot;language-text&quot;&gt;front-end&lt;/code&gt;?&lt;/p&gt;
&lt;p&gt;这是一个很好的机会，用来培养学习的渴望: 总是有更多的东西.
有点像一个十分棒的电视节目, 你从来都觉得看都不够爽, 更重要的是: &lt;strong&gt;它从来不会结束!&lt;/strong&gt; 显然, 除了不断地学习就没有其他东西能像这样了. 软件开放的每一个分支, 都是一个需要深入的全新的世界, 而且你学的更多, 就会有更多的世界为你开放.&lt;/p&gt;
&lt;p&gt;你应该意识到, 没有一个所谓的权威的方式来让你成为一个 “real” 开发者. 也没有足够的时间去精通每一个方面. 每个人成功的道路和方式都是不同的. &lt;strong&gt;你如何修出一条到达你想到达的地方, 那完全取决于你自己.&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;这就是我第一次踏入软件开发世界的故事. 如果你还想看我第一次到底做了什么, &lt;a href=&quot;https://github.com/thetimothyp/Where2Eat&quot;&gt;你可以查看这个.&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Element 和 Component 的区别]]></title><description><![CDATA[本文的出现离不开 Dan 的一篇卓越的 blog。
 原文章 一句话概括就是，  是   的返回值.
Element 其实就是一个纯对象，这个对象定义了一些对于 React 来说很重要的属性.
比如   这些的。举个实际的例子 上面的 type 就是这个 Element…]]></description><link>https://github.com/thoamsy/blogs.git/react-component-and-element/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/react-component-and-element/</guid><pubDate>Sun, 14 Jan 2018 12:12:00 GMT</pubDate><content:encoded>&lt;p&gt;本文的出现离不开 Dan 的一篇卓越的 blog。
&lt;a href=&quot;https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html&quot;&gt;原文章&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;一句话概括就是，&lt;code class=&quot;language-text&quot;&gt;Element&lt;/code&gt; 是 &lt;code class=&quot;language-text&quot;&gt;Component&lt;/code&gt; 的返回值.
Element 其实就是一个纯对象，这个对象定义了一些对于 React 来说很重要的属性.
比如 &lt;code class=&quot;language-text&quot;&gt;type，children，props，key，type&lt;/code&gt; 这些的。举个实际的例子&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	$$&lt;span class=&quot;token keyword&quot;&gt;typeof&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Symbol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;react&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;button&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	key&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		className&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;button button-blue&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		children&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        children&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;OK!&apos;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;上面的 type 就是这个 Element 的核心之一。React 通过判断 type 是字符串还是函数来决定如何构造并 &lt;code class=&quot;language-text&quot;&gt;mount&lt;/code&gt; 这个 Element。如果是字符串就说明是普通 DOM，称为 &lt;code class=&quot;language-text&quot;&gt;DOM Component&lt;/code&gt;，如果是 &lt;code class=&quot;language-text&quot;&gt;function&lt;/code&gt; 就是自己定义的，称为 &lt;code class=&quot;language-text&quot;&gt;CompositeComponent&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;创建组件的常用方法有两种，一种是纯函数组件，或者说 &lt;code class=&quot;language-text&quot;&gt;stateless Component&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;Button&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; color&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; text &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; background&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; color &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;通过这种方式创建, 它的返回值就是定义了一个 Element。直接使用 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Button {...props} /&amp;gt;&lt;/code&gt; 就能得到我们定义的 Element。不过这仅仅是因为 JSX 给了我们一种语法糖，如果没有 JSX 的话，应该类似于&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;React&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;button&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; style&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; background&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; color &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;而这个函数的作用也仅仅只是生成一个&lt;strong&gt;对象而已&lt;/strong&gt;，就像最上面那个对象一样：&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;button&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		style&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; background&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; color &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		children&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
			…
		&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这就是 Element 的真面目了。所以可以看到，JSX 也好，&lt;code class=&quot;language-text&quot;&gt;createElement&lt;/code&gt; 也好，不过是提供一种抽象帮我们不要写这个无聊的对象定义，要知道，如果再多几个 children 的话，整个对象定义应该就有几十行(当然，这个对象还会有其他作用，这里不展开)&lt;/p&gt;
&lt;p&gt;同样的，如果换成 &lt;code class=&quot;language-text&quot;&gt;Stateful Component&lt;/code&gt; 的话，其实模式差不多。只不过，它们需要一个 &lt;code class=&quot;language-text&quot;&gt;render&lt;/code&gt; 方法，并且拥有一个被称为 &lt;code class=&quot;language-text&quot;&gt;instance&lt;/code&gt; 的变量。render 的目的就是定义一个 Element，而 instance 就是 在 render 中使用的 &lt;code class=&quot;language-text&quot;&gt;this&lt;/code&gt; 了。&lt;/p&gt;
&lt;p&gt;所以，一个 Element 出现的步骤此时是，&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// type 就是该组件的 type&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; Element &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// render 不就是 React.Component.prototype 的方法吗&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;综上所述，我们最常写的是 Component，Component 分为三种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;host（常见 DOM 节点）&lt;/li&gt;
&lt;li&gt;function&lt;/li&gt;
&lt;li&gt;class&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;host 类型，React 会根据对应 type，生成真正的 DOM node，并将它所带的 props 写入 node 的 &lt;code class=&quot;language-text&quot;&gt;attribute&lt;/code&gt; 中，而对 &lt;code class=&quot;language-text&quot;&gt;children&lt;/code&gt; 继续递归，直到碰到没有 children 的 host Element 为止。&lt;/p&gt;
&lt;p&gt;Function 的返回值是 Element, class 的 render 函数的返回值是 Element&lt;/p&gt;
&lt;p&gt;不过这里还有一个问题，function 和 class 的 &lt;code class=&quot;language-text&quot;&gt;typeof&lt;/code&gt; 都是 &lt;code class=&quot;language-text&quot;&gt;function&lt;/code&gt;，这两个是怎么判断的呢？因为 class 定义的组件，继承于 &lt;code class=&quot;language-text&quot;&gt;React.Component&lt;/code&gt;，它拥有一个特定属性，只需要检测是否拥有这个属性就能确定是 class 还是 function。&lt;/p&gt;
&lt;h2&gt;一个常见问题&lt;/h2&gt;
&lt;p&gt;假设有下面的两个变量&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Wow&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;E&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这两个的区别是什么呢？刚开始很容易写出这样的代码&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
	  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;E&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
	);
}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但是如果真这样写的话，铁定是会报错的。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/9515e6ae68bc85573af4f70969701083/ca311/96FFC213-7B8B-46A4-817B-2F13D2342247.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 11.829268292682926%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAQ0lEQVQI162MUQrAMAhDe/97Dut0+1+kptNdYYHw4BEywi9CJqHGMGf43XwOIU5rD9FuedSmOJW51tv8mMnK4I+p0w0En5yUqWbybQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;96FFC213 7B8B 46A4 817B 2F13D2342247&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/9515e6ae68bc85573af4f70969701083/42603/96FFC213-7B8B-46A4-817B-2F13D2342247.png&quot;
        srcset=&quot;/blogs/static/9515e6ae68bc85573af4f70969701083/f931c/96FFC213-7B8B-46A4-817B-2F13D2342247.png 200w,
/blogs/static/9515e6ae68bc85573af4f70969701083/e8031/96FFC213-7B8B-46A4-817B-2F13D2342247.png 400w,
/blogs/static/9515e6ae68bc85573af4f70969701083/42603/96FFC213-7B8B-46A4-817B-2F13D2342247.png 800w,
/blogs/static/9515e6ae68bc85573af4f70969701083/5b8b9/96FFC213-7B8B-46A4-817B-2F13D2342247.png 1200w,
/blogs/static/9515e6ae68bc85573af4f70969701083/c7ea5/96FFC213-7B8B-46A4-817B-2F13D2342247.png 1600w,
/blogs/static/9515e6ae68bc85573af4f70969701083/ca311/96FFC213-7B8B-46A4-817B-2F13D2342247.png 1640w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
于是我又发现可以这样写&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
	  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;那么为什么上面一种可以下面不可呢？&lt;/p&gt;
&lt;p&gt;首先，分析一下上面报错的原因，根据上面说的，我们知道，&lt;code class=&quot;language-text&quot;&gt;&amp;lt;E /&amp;gt;&lt;/code&gt; 就是一个语法糖，也就是 &lt;code class=&quot;language-text&quot;&gt;React.createElement(type, props, children)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其中 type 就是 E。那么，根据我们的定义 E 也是一个 &lt;code class=&quot;language-text&quot;&gt;React.createElement(&amp;#39;p&amp;#39;, {}, &amp;#39;123&amp;#39;)&lt;/code&gt; 这样的表达式，其实就是一个对象。显然这个时候 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;E/&amp;gt;&lt;/code&gt; 得到的值，其实是一个对象！！ 而 React 内部是通过 type 属于 string 来确定这是 host Element，type 属于 function/class 来判断这是一个组件。因为此时 type 是一个对象，自然就会报错。&lt;/p&gt;
&lt;p&gt;而，&lt;code class=&quot;language-text&quot;&gt;{E}&lt;/code&gt; 为什么可以呢？还记得我们最常在 &lt;code class=&quot;language-text&quot;&gt;{}&lt;/code&gt; 中写什么吗？&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;names&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这里表达式最后就是一个 &lt;code class=&quot;language-text&quot;&gt;Array of Element&lt;/code&gt;，显然这样是合法。所以，总结过来可以发现一个规律，&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;A /&amp;gt;&lt;/code&gt; 整个表达式是一个 Element，而 A 是一个 Component， Component 要么是 function（class 也是 function），要么是纯 DOM&lt;/p&gt;
&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[反转字符串]]></title><description><![CDATA[这个问题可能非常老，写过代码的都知道使用 但是，需要注意的是，因为 JS 默认使用的是 UCS-2 来编码的，对于中文支持也貌似没问题。可是到了 Unicode 环境下，大量的 emoji，就会出问题咯。
 
就像上面显示的这样。那改怎么解决呢？在 ES…]]></description><link>https://github.com/thoamsy/blogs.git/反转字符串/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/反转字符串/</guid><pubDate>Fri, 12 Jan 2018 23:33:00 GMT</pubDate><content:encoded>&lt;p&gt;这个问题可能非常老，写过代码的都知道使用&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;str
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reverse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但是，需要注意的是，因为 JS 默认使用的是 UCS-2 来编码的，对于中文支持也貌似没问题。可是到了 Unicode 环境下，大量的 emoji，就会出问题咯。
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/51b4d8cf4e13a6267e5cf72a02662488/97428/A20289F2-4515-4E5E-9C91-1BF74DF84328.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 10.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAd0lEQVQI1z2MywrCMBAA0zYbom03G1NBEB+ghwpV8Or//9eIET0MA3MYZzZx2h+x0dikzDLP9KvE7XLm9ZgYNJOSEmPEzCilVKsqOefa27bFOfelnxR3d8hTCFthnAe6q6CHNWUX8J0gInjvqz+EECq/3jTNf/gG3U8t3dxDYrkAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;A20289F2 4515 4E5E 9C91 1BF74DF84328&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/51b4d8cf4e13a6267e5cf72a02662488/42603/A20289F2-4515-4E5E-9C91-1BF74DF84328.png&quot;
        srcset=&quot;/blogs/static/51b4d8cf4e13a6267e5cf72a02662488/f931c/A20289F2-4515-4E5E-9C91-1BF74DF84328.png 200w,
/blogs/static/51b4d8cf4e13a6267e5cf72a02662488/e8031/A20289F2-4515-4E5E-9C91-1BF74DF84328.png 400w,
/blogs/static/51b4d8cf4e13a6267e5cf72a02662488/42603/A20289F2-4515-4E5E-9C91-1BF74DF84328.png 800w,
/blogs/static/51b4d8cf4e13a6267e5cf72a02662488/97428/A20289F2-4515-4E5E-9C91-1BF74DF84328.png 850w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
就像上面显示的这样。那改怎么解决呢？在 ES6 之前，可能需要通过对 Unicode 内部编码的了解来特别规定某个范围改做什么。但是 ES6 支持了 &lt;code class=&quot;language-text&quot;&gt;codePoint&lt;/code&gt;，我们就不要这种复杂的方式了！
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/d6f147eaaf32b6c07bc00e9b8b362ce8/22f09/3C5A8FC8-2D99-4F4E-907C-89276B8A33BF.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 12.520064205457466%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQI15WMywrCMBBFo2byaJKmtaK4KBZKBQtu3Pr/33VsAv0AFwdm5ty5Kl4ibvAMY89rHQmp5/28c05HlFL/szxnrtONdV34fh6ctKPLkRQ8MUZyzjjnaJqmEkKgbVtSStXtt7IbY1DSOeZlQgbDwQqi9VaqN2mx1taHEiyISC3f8d7XTHFlLv4H44hDSNats2QAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;3C5A8FC8 2D99 4F4E 907C 89276B8A33BF&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/d6f147eaaf32b6c07bc00e9b8b362ce8/42603/3C5A8FC8-2D99-4F4E-907C-89276B8A33BF.png&quot;
        srcset=&quot;/blogs/static/d6f147eaaf32b6c07bc00e9b8b362ce8/f931c/3C5A8FC8-2D99-4F4E-907C-89276B8A33BF.png 200w,
/blogs/static/d6f147eaaf32b6c07bc00e9b8b362ce8/e8031/3C5A8FC8-2D99-4F4E-907C-89276B8A33BF.png 400w,
/blogs/static/d6f147eaaf32b6c07bc00e9b8b362ce8/42603/3C5A8FC8-2D99-4F4E-907C-89276B8A33BF.png 800w,
/blogs/static/d6f147eaaf32b6c07bc00e9b8b362ce8/5b8b9/3C5A8FC8-2D99-4F4E-907C-89276B8A33BF.png 1200w,
/blogs/static/d6f147eaaf32b6c07bc00e9b8b362ce8/22f09/3C5A8FC8-2D99-4F4E-907C-89276B8A33BF.png 1246w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;简单粗暴。&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Parcel 📦 和 React ⚛️ 的使用]]></title><description><![CDATA[Parcel 这种工具虽然号称零配置, 但是在 React 相关开关的时候还需要一些必要的配置才能让整个代码真的跑起来. 特别是如果需要  Hot Reloader  的时候. 如果使用  create-react-app…]]></description><link>https://github.com/thoamsy/blogs.git/parcel/Parcel 📦 和 React ⚛️ 的使用/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/parcel/Parcel 📦 和 React ⚛️ 的使用/</guid><pubDate>Sun, 07 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Parcel 这种工具虽然号称零配置, 但是在 React 相关开关的时候还需要一些必要的配置才能让整个代码真的跑起来. 特别是如果需要 &lt;strong&gt;Hot Reloader&lt;/strong&gt; 的时候. 如果使用 &lt;a href=&quot;https://github.com/facebookincubator/create-react-app&quot;&gt;create-react-app&lt;/a&gt; 确实很方便, 这也是入门和新项目首选. 但是呢, 想上面提到的 &lt;code class=&quot;language-text&quot;&gt;hot reloader&lt;/code&gt; 默认是不支持的, 除非自己先 &lt;code class=&quot;language-text&quot;&gt;yarn eject&lt;/code&gt; &lt;strong&gt;弹射&lt;/strong&gt; 出去, 再手动配置 webpack 文件才行! 这个虽然文档上也有详细的记载, 但是感觉就没有那份纯粹性了.
所以使用 parcel 自己手动来配置的话, 更有一种成就感.&lt;/p&gt;
&lt;p&gt;Parcel 基本教程在之前的文章 [[Parcel 的使用]] 中有简单的介绍, 下面直接进入使用环节.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Babel 的基本配置&lt;/h2&gt;
&lt;h3&gt;一些背景介绍&lt;/h3&gt;
&lt;p&gt;我们知道, React 和 Babel 是互相离不开的, 首先 &lt;code class=&quot;language-text&quot;&gt;JSX&lt;/code&gt; 需要 Babel 来转译, 比如&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;App &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; React&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;creataElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;App&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;除了这个, React 对新语法的依赖也蛮大的, 比如 &lt;code class=&quot;language-text&quot;&gt;Object Spread&lt;/code&gt; 语法, 这个在最新的浏览器和 Node 环境已经支持了, 但是还没有完全成为标准, 应该会在今年的 ES9 成为标准, 所以我们还是要依赖 Babel.
还有 React 组件中大量的 &lt;code class=&quot;language-text&quot;&gt;this.setState&lt;/code&gt;, 在 JS 中 &lt;code class=&quot;language-text&quot;&gt;this&lt;/code&gt; 很容易丢失, 所以我们需要依赖箭头函数, 但是在 &lt;code class=&quot;language-text&quot;&gt;render&lt;/code&gt; 大量使用箭头函数又不是一个好习惯, 一是每次 render 都会生成新的函数, 这又导致依赖这个函数作为 &lt;code class=&quot;language-text&quot;&gt;props&lt;/code&gt; 的组件又一次被渲染.
一个妥协的方法是在 &lt;code class=&quot;language-text&quot;&gt;constructor&lt;/code&gt; 中&lt;strong&gt;不厌其烦&lt;/strong&gt;的写 &lt;code class=&quot;language-text&quot;&gt;this.foo = this.foo.bind(this)&lt;/code&gt;
先解释一下这样可行的原因, 在 &lt;code class=&quot;language-text&quot;&gt;class&lt;/code&gt; 中, 我们定义一个函数比如&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个 foo 其实是属于 &lt;code class=&quot;language-text&quot;&gt;A.prototype&lt;/code&gt; 的, 如果转译成 ES5 语法, 大概类似于&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;defineProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;foo&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; …&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	writeable&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	configurable&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	enumerable&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;所以说, 等号右边的 &lt;code class=&quot;language-text&quot;&gt;this.foo&lt;/code&gt; 其实引用的是原型的 foo, 这个时候再赋值给 &lt;code class=&quot;language-text&quot;&gt;this.foo&lt;/code&gt; 其实是没毛病的, 因为这个时候才是赋给 &lt;code class=&quot;language-text&quot;&gt;this&lt;/code&gt; 自己.&lt;/p&gt;
&lt;p&gt;但是, 如果要我们写这个无聊的代码几百次的话, 就再也不想写了. 于是乎有一种新的语法, 英文似乎叫做 &lt;code class=&quot;language-text&quot;&gt;Class Properties&lt;/code&gt;, 支持直接使用 class 语法定义属性, 而不在属于 prototype. 这样就可以写出&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token function-variable function&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;的语法. 于是我们不仅干掉了, 无聊的 &lt;code class=&quot;language-text&quot;&gt;bind&lt;/code&gt;, 还干掉了整个 &lt;code class=&quot;language-text&quot;&gt;constructor&lt;/code&gt;, 多酷!!!
还有一种语法, &lt;code class=&quot;language-text&quot;&gt;::&lt;/code&gt;, 这里不介绍.&lt;/p&gt;
&lt;h3&gt;babelrc&lt;/h3&gt;
&lt;p&gt;配置 babel 依赖于一个叫做 &lt;code class=&quot;language-text&quot;&gt;.babelrc&lt;/code&gt;文件, 在 VS Code 中, 如果安装了&lt;strong&gt;文件图标主题&lt;/strong&gt;的话, 一旦创建, 会有一个特定的 logo 图标来告诉我们, 没有拼错.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/6e66289750658579d27318a94e357528/49be0/F82820D6-9363-4A17-B637-C84FE7E037CE.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 350px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 34.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAA5ElEQVQoz3WRTQ6CMBCFOQZRBAr+wZQYlagokaigEqIxrl14Bu+fPGvFBhEXL32dmX6dTjW7x2F1qRSH3aO3uq+V45P/+HqsntOqwHeQYDhcwptA/8ANQF9CTJcjnA7g9Knc++g4npLBhirW1KUC2gLYYgGuOcPtYkG3CAM+wSLeIZhEWCUZwihBtE4xW20wnsUiP/3foekSmOjqcW/hvHegmwQahUh2OTZZgfR4kv5QXDCPt1gKcDBeyG6rY/uaoSU8BV5ZwPH9YVRe7Eup59ZmqskCMQ8p4dvMV4dM16v4Jv3mn8p6zgd6NQLAAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;F82820D6 9363 4A17 B637 C84FE7E037CE&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/6e66289750658579d27318a94e357528/49be0/F82820D6-9363-4A17-B637-C84FE7E037CE.png&quot;
        srcset=&quot;/blogs/static/6e66289750658579d27318a94e357528/62e23/F82820D6-9363-4A17-B637-C84FE7E037CE.png 200w,
/blogs/static/6e66289750658579d27318a94e357528/49be0/F82820D6-9363-4A17-B637-C84FE7E037CE.png 350w&quot;
        sizes=&quot;(max-width: 350px) 100vw, 350px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
配置 react 的方式, 其实十分简单. 首先需要转译 JSX, 但是 JSX 的转移又依赖于 es2015, 所以我们两个都需要转译. 我并没有多长 babel 使用经验, 反正现在有了 &lt;code class=&quot;language-text&quot;&gt;presets&lt;/code&gt;, 而且淘汰了 ES2015, ES2016 这些 presets, 统一使用 &lt;code class=&quot;language-text&quot;&gt;env&lt;/code&gt; preset, 所以 babel 的配置变成了下面这样&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;presets&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;env&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;react&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果有影响的话, 其实还有一个 &lt;code class=&quot;language-text&quot;&gt;babel-preset-react-app&lt;/code&gt;, 它和上面的 react 的区别就是: react-app 是使用在 &lt;code class=&quot;language-text&quot;&gt;create-react-app&lt;/code&gt;中的配置, 相比 react 会有一些加成, 下面会讲到.&lt;/p&gt;
&lt;p&gt;OK, 其实有了这两个就能写 react 了. 自己写好必要的组件, 和之前一样使用 parcel 就能启动. 但是, 我们还不能使用刚刚提到的那些新语法. 甚至连 React 大量依赖的 &lt;code class=&quot;language-text&quot;&gt;{...obj}&lt;/code&gt; 也不行. 这个时候就还需要安装新的 preset: &lt;code class=&quot;language-text&quot;&gt;stage-2 stage-3&lt;/code&gt;
于是乎, 为了安装这些, 我们需要运行&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;yarn add -D babel-preset-env babel-preset-react babel-preset-stage-2 babel-preset-stage-3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;那这样就能开心的写 React 代码了吗 🧐 还不行, 我目前也搞不清楚为什么, 写 &lt;code class=&quot;language-text&quot;&gt;async await&lt;/code&gt;话, 还是会报错, 尽管这个主流浏览器已经都支持了. 所以, 我在 Google 了一番后, 发现还需要安装一个 babel plugin.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;yarn add -D babel-plugin-transform-runtime&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;而且这个 runtime 的配置蛮复杂的, 这里不详细介绍了, 大概是这样.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token property&quot;&gt;&quot;plugins&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;transform-runtime&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;polyfill&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;helpers&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意, 这段代码紧跟 babelrc 中的 presets 之后另起一行.&lt;/p&gt;
&lt;p&gt;当完全了这些之后我们就可以没有任何问题的写 React ⚛️ 了 😎😎&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;热加载&lt;/h2&gt;
&lt;p&gt;当我确定我要使用热加载的时候, 是因为我看了 Dan 的视频, 以及他说的一段话&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I want to encourage you to actually spend time working on developer tools because before you can optimize your app, you should optimize your workflow so you have more time to spend working on your app. Because once enough frustration is gone, your programming actually feels fun again just like it used to do when the tools were simple.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;最重要的意思就是, 花点时间研究 🔧 能为我们省下更多的时间提高自己. 于是乎, 我就花了一点时间, 嗯, 也不是一点, 三个小时吧. 终于搞明白, 怎么在 parcel 中使用了. 因为和官方文档有点区别, parcel 的文档介绍的又十分简陋, 再加上 parcel 缓存的问题, 所以被坑了很久. 不过终于还是搞定了. 下面总结一下热加载的配置.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/gaearon/react-hot-loader&quot;&gt;react-hot-loader&lt;/a&gt; 由 &lt;em&gt;Dan gaearon&lt;/em&gt; 开发并开源, 对, 就是 redux 的作者, 是一个特别帅的英国佬. 当然这不是我们讨论的重点, 目前使用的是 V3 版本, V4 在配置上有非常大的提升, 但是因为 parcel 不兼容这个. 所以我们还是使用主流的配置.&lt;/p&gt;
&lt;p&gt;文档该说的都说了, 下面只针对在 parcel 上该怎么用来解释.
还是安装它&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;yarn add -D react-hot-loader&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;之后在 &lt;code class=&quot;language-text&quot;&gt;babelrc&lt;/code&gt; 中的 plugins 中配置. 最终的版本为:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;presets&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;env&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;react&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;stage-2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;stage-3&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;plugins&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&quot;transform-runtime&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;polyfill&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;helpers&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;react-hot-loader/babel&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;还没完, 接下来只要在 &lt;code class=&quot;language-text&quot;&gt;index.js&lt;/code&gt; 做一些小操作, 就可以开始了.
&lt;code class=&quot;language-text&quot;&gt;index.js&lt;/code&gt; 一般作为入口点, 换句话话, 这里应该是你整个项目配置的地方, 也是 &lt;code class=&quot;language-text&quot;&gt;ReactDOM.render&lt;/code&gt;调用的地方, 同时也是你的 html 文件, 应该引用的 JS 文件.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; App &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./App&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; AppContainer &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react-hot-loader&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react-hot-loader/patch&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Component &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;AppContainer&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
      &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Component &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;AppContainer&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;#root&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;App&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hot&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;App&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这是代码的必备成分, &lt;code class=&quot;language-text&quot;&gt;App&lt;/code&gt; 就是你所有代码的合成的组件, render 函数无非就是一个小小的包装. 而 &lt;code class=&quot;language-text&quot;&gt;AppContainer&lt;/code&gt; 就是整个热加载的&lt;strong&gt;能量源泉&lt;/strong&gt;. 而 &lt;code class=&quot;language-text&quot;&gt;module.hot.accept&lt;/code&gt; 里的回调, 就是整个源泉的能量使用者.
和文档中不一样的是, 文档中 &lt;code class=&quot;language-text&quot;&gt;accept&lt;/code&gt; 接受两个参数, 第二个才是回调. 也是我一直被坑的地方, 可能是因为 parcel 针对这个做了某些小小的优化吧.&lt;/p&gt;
&lt;p&gt;这些都写好了, 就可以开始&lt;strong&gt;热加载&lt;/strong&gt;之旅了!
那怎么知道自己的热加载是否成功了呢? 之前提到过, 热加载的前提是不用刷新界面, 因为刷新的话就会丢失所有的状态咯. 所以成功的关键就是&lt;strong&gt;状态没有丢失&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;不过这句话不是那么的明显 🙂, 其实比较的明显的检测方法就是:
有一个 input 和任意的 label. 如果我们 input 中填写了某些信息, 再去 label 中修改, input 中的数据没有丢失的话, 就说明热加载成功了. 这真的很重要, 在写表单类似的程序的时候, 我们需要不断的输入然后刷新, 光光这个时间就不知道被浪费了多少.&lt;/p&gt;
&lt;p&gt;补充：这个热加载似乎会引入一个 bug&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;无法在 &lt;code class=&quot;language-text&quot;&gt;async&lt;/code&gt; 函数中找到 &lt;code class=&quot;language-text&quot;&gt;this&lt;/code&gt;&lt;br&gt;
我不太清楚这是什么原因，在不需要重度依赖 async 的情况下，还是可以接受的。另外，估计 v4 版本已经解决了这个问题吧。感谢开源让生活更美好, 也让我们知道牛逼的程序员到处都是.&lt;/p&gt;
&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[UUID]]></title><description><![CDATA[花了一个晚上看了一下 UUID 的实现源码. 发现 UUID 有 5 个版本, 其中的特点分别为:
V1: 以 机子的网卡和时间戳 以及一些其他的东西作为因子来生成一个唯一的标识符
V2: 没有提及
V3: 为了方便同样的标识符生成同样的 uuid, 用 MD5 来 hash…]]></description><link>https://github.com/thoamsy/blogs.git/uuid/UUID/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/uuid/UUID/</guid><pubDate>Fri, 05 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;花了一个晚上看了一下 UUID 的实现源码. 发现 UUID 有 5 个版本, 其中的特点分别为:
V1: 以&lt;strong&gt;机子的网卡和时间戳&lt;/strong&gt;以及一些其他的东西作为因子来生成一个唯一的标识符
V2: 没有提及
V3: 为了方便同样的标识符生成同样的 uuid, 用 MD5 来 hash 标识符和命名空间
V4: 生成一个 128 位的随机数来作为唯一标识符
V5: 和 V3 相似, 不过使用 sha-1 算法, 让标识符更难被预测.&lt;/p&gt;
&lt;p&gt;如果我们仅仅只是为了生成一个唯一的标识符, 就用 V1 和 V4. 但是 V1 其实容易被预测, 所以现在已经不怎么用了, 更多的用 V4 的. 关于到底使用哪个, 可以看 &lt;a href=&quot;https://stackoverflow.com/questions/20342058/which-uuid-version-to-use&quot;&gt;stackoverflow&lt;/a&gt; 的一个帖子.
那么, UUID 的特点主要是分成:
&lt;code class=&quot;language-text&quot;&gt;8-4-4-4-12&lt;/code&gt; 的 16 进制表示来展现的, 对应的字节应该是 16(8+4+4+4+12 &gt;&gt; 1) 个. 当然最后会转化成字符串的话, 就变成 16 * 2 + 4(四个短横) 个了.
其中, 第三部分的第一个字符用来表示算法的版本号, 所以 v4 的版本是 4. 而第四部分的第一位用来表示变种, 我没太搞懂这是什么鬼, 但是可能的取值只能为 &lt;code class=&quot;language-text&quot;&gt;9 0 a b&lt;/code&gt;, 这可以通过 &lt;code class=&quot;language-text&quot;&gt;bit &amp;amp; 0x3f | 0x80&lt;/code&gt; 来做到的.&lt;/p&gt;
&lt;p&gt;我只看了 4 和 5 两个版本的实现, 除去 &lt;code class=&quot;language-text&quot;&gt;sha-1&lt;/code&gt; 和 随机数生成器算法的话, 还是蛮简单的.😎&lt;/p&gt;
&lt;h2&gt;V4&lt;/h2&gt;
&lt;p&gt;V4 就是要求生成一个 128 位的伪随机数. 但是因为有 6 个 位会被强制使用(版本 4 位, 变种 2 位), 就剩下 122 位. 不过光是 122 位, 也就是 &lt;code class=&quot;language-text&quot;&gt;2 ^ 122&lt;/code&gt; 次方, 再根据&lt;strong&gt;生日悖论&lt;/strong&gt;, 我们大概知道, 这个世界上有 50% 的几率发生碰撞的概率大概是多少. 反正就是很小. 但是, 这就要求随机数代码的高质量了, 显然这个是交给数学家去实现的咯, 而 nodejs 也内置了相应的代码.
所以说, V4 版本的实现就是, 使用 nodejs 生成一个 128 位的随机数. 再给固定的位置设置那 6 个 bit, 最后转成我们需要的字符串形式就可以咯!
那么在 nodejs 这个平台上又会出现哪些问题呢?
首先, 它的随机数发生器生成的是一个 Buffer 对象, 但是它还是能和数组一样取下标, 并不妨碍我们的正常使用.
接下来就是 &lt;em&gt;特定位设置&lt;/em&gt;, 代码如下&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 6 就是第 7 个字节&lt;/span&gt;
rnds&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rnds&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x0f&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x40&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// 同理第九个字节&lt;/span&gt;
rnds&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rnds&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x3f&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x80&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来就是将整个 Buffer 转成我们需要的字符串咯! 不过, 就和今天写颜色的代码碰到的问题一样, 对于小于 16 的数, 如果我们直接用 &lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt; 的话, 是不会自动补 0 的! 所以我们只能自己手动撸代码来保证 0 的出现. 显然, 只能使用字符串来填充这个 0 呢.
这个库的实现很暴力, 但是也很巧妙&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; byteToHex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  byteToHex&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;通过强制让数变成 3 位的十六进制, 这样就保证 0 时存在的, 然后不取高位, 真的棒!
最后一步, 就是根据随机数里的值, 对应到这个 byteToHex 中来, 并在合适的位置插入 -, 整个 UUID 就生成咯!
另外值得一提的是, 其实浏览器也支持一个 &lt;code class=&quot;language-text&quot;&gt;crypto&lt;/code&gt; 的包了, 虽然只有一个函数, 叫做 &lt;code class=&quot;language-text&quot;&gt;getRandomValues&lt;/code&gt;, 这个函数接受一个 &lt;code class=&quot;language-text&quot;&gt;TypedArray&lt;/code&gt; 数组, 并且没有返回值, 属于&lt;strong&gt;mutable&lt;/strong&gt;. 我们需要多大的尺寸, 多大的范围, 就传递相应的进去就行咯.&lt;/p&gt;
&lt;p&gt;这样的话, 似乎我也能自己写一个浏览器能用的 V4 版本的 UUID 咯 😎&lt;/p&gt;
&lt;h2&gt;V5&lt;/h2&gt;
&lt;p&gt;V5 要求必须有两个参数提供, &lt;code class=&quot;language-text&quot;&gt;name, namespace&lt;/code&gt;. name 就是你想生成 uuid 的值, 而 namespace 则是一个 16 进制表示的, 16 个字节字符串.
比如，我们相对我的名字进行解码，就可以 &lt;code class=&quot;language-text&quot;&gt;v5(&amp;#39;YangKui&amp;#39;, &amp;#39;thisisanamespace&amp;#39;)&lt;/code&gt;;
不过为了方便, 我们干脆用 V4 版本来生成. 但是，单纯的 UUID 是 36 个字节，所以需要先转成 bytes 形式。 可以使用正则表达式来替换.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
uuid&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/[a-zA-Z0-9]{2}/g&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hex &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; bytes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hex&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;同样的，我们还需要对 name 进行编码, 我们可以这样实现:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;stringToBytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;str&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  str &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;unescape&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;encodeURLComponent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;str&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// UTF8 escapse&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; Uint8Array&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;str&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;charCodeAt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;第一行的目的是生成一个都小于 255 的 UTF-8 编码, 像下面这样。&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/cb0e531a417dd01a2c6a222ff45b732a/c510c/A38A178D-6DAC-4F8E-9EEC-001450B372AC.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 344px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 12.790697674418606%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAqklEQVQI1z2MSw6CMBRF3Ynxj9IPpaUFBBWIA+e6AgfG/S/gWCBxcPJy3809C50X5IXH+YpQtyjjMC7EX0lmPWN/FJpUGawvMdahMhM7x/fz5vV6sj0kfxY+jGVGqHLqJnI2tBfLrSu43uyUi6A4N5qqzklSGRETUilOQs6y/WEW3u8aX6ZxKOh7TdPKiWFQdN0oklyuisfDEErBcrNjE8cjq92edWTOyXR/kytfVLd1sfsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;A38A178D 6DAC 4F8E 9EEC 001450B372AC&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/cb0e531a417dd01a2c6a222ff45b732a/c510c/A38A178D-6DAC-4F8E-9EEC-001450B372AC.png&quot;
        srcset=&quot;/blogs/static/cb0e531a417dd01a2c6a222ff45b732a/2c82d/A38A178D-6DAC-4F8E-9EEC-001450B372AC.png 200w,
/blogs/static/cb0e531a417dd01a2c6a222ff45b732a/c510c/A38A178D-6DAC-4F8E-9EEC-001450B372AC.png 344w&quot;
        sizes=&quot;(max-width: 344px) 100vw, 344px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;最后, 获得了 name 和 namespace 的编码值后, 只需要对 &lt;code class=&quot;language-text&quot;&gt;namespace.concat(name)&lt;/code&gt; 调用 sha1, 就成了我们需要的 uuid 值， 然后和 v4 一样设置版本号和变种信息.
至于 sha1 实现原理, 我不太明白, 不过 nodejs 提供了代码. 在它的 &lt;code class=&quot;language-text&quot;&gt;crypto&lt;/code&gt; 模块中, 可以这样使用:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;crypto
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createHash&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sha1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bytes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;digest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;hex&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其中 bytes 就是我们要 hash 的部分. 所以为什么能提供一样的 UUID? 因为 name 和 namespace 都一样, 所以生成的就是一样的啦!
不过, 我在看了 SHA-1 的源码后, 发现它本身就会对传进来的数据做同样的操作来保证都是 Uint8 类型, 所以说上面的 &lt;code class=&quot;language-text&quot;&gt;stringToBytes&lt;/code&gt; 其实是可以去掉的.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Base64 编码的简单尝试]]></title><description><![CDATA[这几天不务正业, 在看 HTTP 以及 express 的服务端应用. 关于认证就有很多技巧. 什么基本认证, 记号认证, Passport 认证. 虽然其它认证都是通过 md5 或者 UUID…]]></description><link>https://github.com/thoamsy/blogs.git/base64/Base64 编码的简单尝试/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/base64/Base64 编码的简单尝试/</guid><pubDate>Wed, 03 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;这几天不务正业, 在看 HTTP 以及 express 的服务端应用. 关于认证就有很多技巧. 什么基本认证, 记号认证, Passport 认证. 虽然其它认证都是通过 md5 或者 UUID 来实现一种不可逆且唯一的识别码. 换句话说, 我也不会实现这些东西.
不过, Base64 虽然作为最基本的操作, 安全性基本没有(因为是对称的),所以可以作为一个很好的练练手的代码.&lt;/p&gt;
&lt;h2&gt;Base64&lt;/h2&gt;
&lt;p&gt;Base64 的基本思路就是, &lt;em&gt;3/4&lt;/em&gt;. 每三个字节为一组, 将 24 bits 分为 4 份, 每份 6bits. 然后在一个大小为 64 的索引表中找到对应的字符.
针对不能整除 3 的情况, 就将补 0. 之后这些 0 使用 = 来填充. 但是在实现中, 索引表中的第 0 个是 A, 所以如果我们要提前填充的话, 就要去掉多余的字符. 但是在 JS 中, 如果数组不存在某个下标, 会返回 &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;, 而对 &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; 进行操作会得到 0. 所以, 我们就不需要提前填充.&lt;/p&gt;
&lt;h2&gt;实现&lt;/h2&gt;
&lt;p&gt;作为一个合格的程序员, 当然不能傻逼到自己去一个个写索引表, &lt;em&gt;其实复制粘贴很快!&lt;/em&gt; 所以我就用 map 函数来生成这些. 代码很简单&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; temp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;fromCharCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;temp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; idx&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;=&lt;/span&gt; idx &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; idx &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x41&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; idx
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;idx &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; idx &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x61&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; idx &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;idx &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; idx &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;62&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x30&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; idx &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; idx &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;62&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;43&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;47&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来就是关于 3 / 4 的具体操作咯. 其实很好理解, 每 6 个一份, 通过位操作就能将每个部分分离出来.
当然, 因为 JS 中的数字都是 4 个字节起步的, 所以有点浪费内存, 应该使用 &lt;code class=&quot;language-text&quot;&gt;Uint8Array&lt;/code&gt; 来减少内存的消耗.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; first &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; two &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; three &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0xf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; four &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x3f&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;first&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;two&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;three&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;four&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;代码很简单, 就像上面一样. 不过需要注意的就是优先级问题. 位移动操作在大多数语言中, 优先级都是高于其它的位操作, 低于 + - 运算. 除了 Swift. 所以这里的 () 主要还是避免歧义.&lt;/p&gt;
&lt;p&gt;好了, 轮子都找好了, 剩下的就是修车咯!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// 将 data 转化成 Uint8Array 转成能接受的值&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; transfer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;charCodeAt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; base64 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; startPoint

  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;startPoint &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; startPoint &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; startPoint &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;threeToFour&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;transfer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;startPoint&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; startPoint &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// 因为 threeFour 会假设传入的就是 3 个字节, 但是如果不是 3 个的话, 就会出现问题.&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// 比如 data[2] 就会是 undefined. 对 undefined 进行位操作会被当成 0, 所以多出来的字母肯定会有一个 0.&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// 再根据 Base64 的规则, 加上相应的等号&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;startPoint &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// 说明 % 3 余 2, 简单的算一下就知道咯.&lt;/span&gt;
    base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;=&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;startPoint &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;==&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;需要注意的是那个循环. 所以我们知道要分辨能不能整除 3. 但是, 仔细想一下, 我用 3, 4, 5 作为 🌰 的话, 就能看出来.
3 的时候, 从 0 开始, 最后跳出循环的 startPoint 就等于 3. 所以没有任何需要另外处理的情况.
4 的时候, 就会在 6 结束, 这个时候 6 - 4 等于 2, 所以需要补两个字节. 但是因为我的 &lt;code class=&quot;language-text&quot;&gt;threeToFour&lt;/code&gt; 函数没有专门处理这种情况, 最后总会返回 4 个字符, 所以我们需要将多出来的字节替换成 =. 当然, 你也可以使用 splice 做到一次完成这种操作.
5 的时候和上面相似.&lt;/p&gt;
&lt;p&gt;最后这就是整个代码的实现咯. 不得不说, 对于那种需要频繁增加减少的操作, 我还是喜欢用数组, 然后 &lt;code class=&quot;language-text&quot;&gt;join&lt;/code&gt; 起来. 不过, 浏览器对于 += 运算符应该是做了大量的优化的, 所以到底哪个性能高, 我还真的不确定……&lt;/p&gt;
&lt;p&gt;**Update: ** 现代浏览器针对 &lt;code class=&quot;language-text&quot;&gt;+=&lt;/code&gt; 有客观的优化，虽然还有一些细节上的区分，不过基本上不超过几百万字节的话，+= 是更快的。但是因为这里还需要修改最后的字符串，需要再复制一下，这个可能会带来不必要的性能损耗。&lt;/p&gt;
&lt;h3&gt;总结&lt;/h3&gt;
&lt;p&gt;这种题目整个做出来, 对于自己的思维还是很有锻炼的. 虽然, 不可能一次就能编对, 特别是那个位操作的一段很容易出现问题, 这个时候一定要保持冷静才行.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Hello World]]></title><description><![CDATA[作为个人博客的第一篇文章, 没有太多的意义, 就当为自己终于开通了博客做一个喝彩 🎉🎈
在一年左右的前端学习时间中, 能构建出一个属于自己的博客, 也算是十分满足了.
感谢   和   成为我的前端老师, 另外一个前端老师就是 MDN.
 好了, 一段代码开始我的博客之旅.]]></description><link>https://github.com/thoamsy/blogs.git/hello-world/</link><guid isPermaLink="false">https://github.com/thoamsy/blogs.git/hello-world/</guid><pubDate>Sun, 31 Dec 2017 13:13:18 GMT</pubDate><content:encoded>&lt;p&gt;作为个人博客的第一篇文章, 没有太多的意义, 就当为自己终于开通了博客做一个喝彩 🎉🎈
在一年左右的前端学习时间中, 能构建出一个属于自己的博客, 也算是十分满足了.
感谢 &lt;code class=&quot;language-text&quot;&gt;GitHub&lt;/code&gt; 和 &lt;code class=&quot;language-text&quot;&gt;Google&lt;/code&gt; 成为我的前端老师, 另外一个前端老师就是 MDN.
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blogs/static/022920d1f164284d9cbe54f3e630674d/203c3/good.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 140.0076716532413%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAcABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBQT/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdBlaKScaWmFc8iof//EABoQAAIDAQEAAAAAAAAAAAAAAAABAgMRISL/2gAIAQEAAQUCjw6YUX2ErXjkyPmCUk3u7gxs/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ASP/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQIBAT8BVV1//8QAHxAAAgECBwAAAAAAAAAAAAAAAAERAhIQICIxMkGR/9oACAEBAAY/AsNiIvRpXqOY6aeybpy//8QAHRAAAwACAgMAAAAAAAAAAAAAAAERITFhoUFRcf/aAAgBAQABPyGuZIa8M+AlKdqJN1dvUNvPYRyC9qYc8BW2RaYNEMp//9oADAMBAAIAAwAAABCI737/xAAXEQEBAQEAAAAAAAAAAAAAAAAAEQFx/9oACAEDAQE/EI7TEx//xAAXEQADAQAAAAAAAAAAAAAAAAAAEBFx/9oACAECAQE/EKZKR//EAB8QAQACAQUAAwAAAAAAAAAAAAEAESExQVFhcaGx0f/aAAgBAQABPxAAlUdkiwGtQCFSrq6i6mbBYe/su6dFA8RysPBX6jwOUulPiDmIvJQYsXLwx0RLLK47mUW1zmf/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;good&quot;
        title=&quot;&quot;
        src=&quot;/blogs/static/022920d1f164284d9cbe54f3e630674d/893a4/good.jpg&quot;
        srcset=&quot;/blogs/static/022920d1f164284d9cbe54f3e630674d/bbf57/good.jpg 200w,
/blogs/static/022920d1f164284d9cbe54f3e630674d/260b8/good.jpg 400w,
/blogs/static/022920d1f164284d9cbe54f3e630674d/893a4/good.jpg 800w,
/blogs/static/022920d1f164284d9cbe54f3e630674d/25965/good.jpg 1200w,
/blogs/static/022920d1f164284d9cbe54f3e630674d/e54c8/good.jpg 1600w,
/blogs/static/022920d1f164284d9cbe54f3e630674d/7c0ed/good.jpg 2400w,
/blogs/static/022920d1f164284d9cbe54f3e630674d/203c3/good.jpg 5214w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;好了, 一段代码开始我的博客之旅.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;🐶🐱🐭🐹🐰🐻🐼🐨🐯🦁🐮🐷🐸🐵&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workAndLearning&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item></channel></rss>